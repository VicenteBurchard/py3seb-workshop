{"version":2,"kind":"Notebook","sha256":"131a3bc70c96f49efb6c1f84da4b0d3e6c1a1f34373f437243fd31510e02667b","slug":"seb-introduction","location":"/104-3SEB_introduction.ipynb","dependencies":[],"frontmatter":{"title":"How 3SEB works?","short_title":"3SEB","subtitle":"Quick overview of 3SEB and and its py3SEB code implementation","keywords":["TSEB","radiation","Beer-Lambert law","albedo"],"authors":[{"nameParsed":{"literal":"Vicente Burchard-Levine","given":"Vicente","family":"Burchard-Levine"},"name":"Vicente Burchard-Levine","orcid":"0000-0003-0222-8706","email":"vburchard@ica.csic.es","affiliations":["Insituto de Ciencias Agrarias","CSIC"],"id":"contributors-Users\\06325897T\\Nextcloud\\1_Projects\\ILINK24\\Workshop_3SEB_UCDavis\\py3SEB-workshop\\104-3SEB_introduction-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Héctor Nieto","given":"Héctor","family":"Nieto"},"name":"Héctor Nieto","orcid":"0000-0003-4250-6424","email":"hector.nieto@ica.csic.es","affiliations":["Instituto de Ciencias Agrarias, ICA","CSIC"],"id":"contributors-Users\\06325897T\\Nextcloud\\1_Projects\\ILINK24\\Workshop_3SEB_UCDavis\\py3SEB-workshop\\104-3SEB_introduction-generated-uid-1"},{"nameParsed":{"literal":"Benjamin Mary","given":"Benjamin","family":"Mary"},"name":"Benjamin Mary","orcid":"0000-0001-7199-2885","affiliations":["Insituto de Ciencias Agrarias","CSIC"],"id":"contributors-Users\\06325897T\\Nextcloud\\1_Projects\\ILINK24\\Workshop_3SEB_UCDavis\\py3SEB-workshop\\104-3SEB_introduction-generated-uid-2"}],"affiliations":[{"id":"Insituto de Ciencias Agrarias","name":"Insituto de Ciencias Agrarias"},{"id":"CSIC","name":"CSIC"},{"id":"Instituto de Ciencias Agrarias, ICA","name":"Instituto de Ciencias Agrarias, ICA"}],"license":{"content":{"id":"CC-BY-SA-4.0","url":"https://creativecommons.org/licenses/by-sa/4.0/","name":"Creative Commons Attribution Share Alike 4.0 International","free":true,"CC":true}},"subject":"Tutorial","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"open_access":false,"github":"https://github.com/VicenteBurchard/py3SEB-workshop","numbering":{"title":{"offset":1}},"thumbnail":"/ThreeSource_scheme_v-4e6d8817c6ac3ebe262a78bfa9fd0abd.png","thumbnailOptimized":"/ThreeSource_scheme_v-4e6d8817c6ac3ebe262a78bfa9fd0abd.webp","exports":[{"format":"ipynb","filename":"104-3SEB_introduction.ipynb","url":"/104-3SEB_introductio-ec3db6d1675c24a0ba7c0b0cd742b3e7.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xVYD9cihHw"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"lgBwlxecok"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This interactive Jupyter Notebook has the objective of showing the implemenation of 3SEB-PT model in the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"JvIMM1cSe3"},{"type":"link","url":"https://github.com/VicenteBurchard/py3SEB","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"py3SEB package","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"IxEXyUxJ6J"}],"key":"m4AEcVUCFL"}],"urlSource":"https://github.com/VicenteBurchard/py3SEB","error":true,"key":"FbKMyAJFxu"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VX7JCX9SiZ"}],"key":"u0lgdrxojw"}],"key":"jcPoGEb4YL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Instructions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AnBaEBMw3B"}],"identifier":"instructions","label":"Instructions","html_id":"instructions","implicit":true,"key":"XtOSFtMh8N"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Read carefully all the text and follow the instructions.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fmA9XWI45u"}],"key":"HL43xfZ3bw"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Once each section is read, run the jupyter code cell underneath (marked as ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jvYmw4juaU"},{"type":"inlineCode","value":"In []","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"syzFfjK430"},{"type":"text","value":") by clicking the icon ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"i7T6pmMgVT"},{"type":"inlineCode","value":"Run","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"YmVnGHnQuM"},{"type":"text","value":", or pressing the keys SHIFT+ENTER of your keyboard. A graphical interface will then display, which allows you to interact with and perform the assigned tasks.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"tEPWD4tj1X"}],"key":"Zgx7tyJAof"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"To start, please run the following cell to import all the packages required for this notebook. Once you run the cell below, an acknowledgement message, stating all libraries were correctly imported, should be printed on screen.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"pVN8lJ8vhi"}],"key":"p2eAqRYiYi"}],"key":"Uxl4E9I1FA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from pathlib import Path\nfrom ipywidgets import interact, interactive, fixed, widgets\nfrom IPython.display import display\nimport numpy as np\nfrom pyTSEB import TSEB\nfrom py3seb import py3seb\n\nprint('libraries imported correctly')","key":"WgrSnYxSwa"},{"type":"output","id":"DMtzGONg2cKY0PnBoXDNL","data":[],"key":"RAslE84g13"}],"key":"fm03BHvW6n"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The 3SEB model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x80WhoWE1S"}],"identifier":"the-3seb-model","label":"The 3SEB model","html_id":"the-3seb-model","implicit":true,"key":"hJXtIhmEp6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The 3SEB model (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vx6E9CqJQU"},{"type":"cite","url":"https://doi.org/10.1111/gcb.16002","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Burchard-Levine et al. 2022","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zeKjSwEhw3"}],"key":"qXCPGI0u2I"}],"kind":"narrative","label":"Burchard_Levine_2021","identifier":"https://doi.org/10.1111/gcb.16002","enumerator":"1","key":"Bia3rsvpA3"},{"type":"text","value":") is an adapted version of the TSEB model ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IfWP5mQ0B1"},{"type":"cite","url":"https://doi.org/10.1016/0168-1923(95)02265-Y","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Norman et al. (1995)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TUQUKgeJgV"}],"key":"AvVNkT0noZ"}],"kind":"narrative","label":"Norman_1995","identifier":"https://doi.org/10.1016/0168-1923(95)02265-Y","enumerator":"2","key":"PinduVb3u1"},{"type":"text","value":", where an additional vegetation source is incorporated into TSEB to better characterize agro-ecosystems with multiple vegetation layers that have distinct structural and physiological features. This adaptation was initially envisioned for savanna-like ecosystems which are characterized by the co-existence of trees and herbaceous species with very different structural and phenological dynamics.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eHkYYIWadM"}],"key":"pUOcbjhF52"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"However, the 3SEB model structure is also well adapted for perennial tree crops that have cover crops in the interrow, such as vineyards, olive orchards, almonds etc. In principle, the 3SEB model is more suited to represent the complex interactions between a clumped vegetation source planted in rows with an additional herbaceous vegetation source located in the interrows.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"UHiEivSTyN"}],"key":"pHzOUPcEZK"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/ThreeSource_scheme_v-4e6d8817c6ac3ebe262a78bfa9fd0abd.png","alt":"3SEB resistances scheme","key":"Zs3s7IbUiQ","urlSource":"./input/figures/ThreeSource_scheme_v3_highres.png","urlOptimized":"/ThreeSource_scheme_v-4e6d8817c6ac3ebe262a78bfa9fd0abd.webp"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"3seb-scheme","identifier":"3seb-scheme","html_id":"id-3seb-scheme","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"sDUWYX7lHS"},{"type":"text","value":"1","key":"GzZOjgASPm"},{"type":"text","value":":","key":"DfvT3HBTAd"}],"template":"Figure %s:","key":"BEEkhDRvgp"},{"type":"text","value":"Three-Source energy balance scheme for transport sensible heat (H). From ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"p87nHk4rXU"},{"type":"cite","url":"https://doi.org/10.1111/gcb.16002","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Burchard-Levine et al. 2022","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"tCqGCtLlSh"}],"key":"HdAr2eZnk0"}],"kind":"narrative","label":"Burchard_Levine_2021","identifier":"https://doi.org/10.1111/gcb.16002","enumerator":"1","key":"FDqKTIIJlt"}],"key":"aQwdrelM8i"}],"key":"ANpXdji5MJ"}],"label":"3seb-scheme","identifier":"3seb-scheme","enumerator":"1","html_id":"id-3seb-scheme","key":"aRzjjsvNep"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"In 3SEB, the resistance framework is first treated as a parallel (i.e., uncoupled) tree-substrate system to obtain tree canopy sensible heat flux (","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"fTY6C6swIR"},{"type":"inlineMath","value":"H_C","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">H_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XK1EEobljF"},{"type":"text","value":") and substrate (understory vegetation+soil) (","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"dTSd7OTTMl"},{"type":"inlineMath","value":"H_{sub}","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mrow><mi>s</mi><mi>u</mi><mi>b</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">H_{sub}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mord mathnormal mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"BUC2HiHOw2"},{"type":"text","value":") using the heat transport equations:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"bXJwpDfsf9"}],"key":"dFYzAbQvJy"},{"type":"math","value":"H_C &= \\rho C_p \\frac{T_C - T_{a}} {R_A}\\\\\nH_{sub} &= \\rho C_p \\frac{T_{sub} - T_{a}} {R_A+R_{sub}}","label":"ec-hc-hsub","identifier":"ec-hc-hsub","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>H</mi><mi>C</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub><mfrac><mrow><msub><mi>T</mi><mi>C</mi></msub><mo>−</mo><msub><mi>T</mi><mi>a</mi></msub></mrow><msub><mi>R</mi><mi>A</mi></msub></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>H</mi><mrow><mi>s</mi><mi>u</mi><mi>b</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub><mfrac><mrow><msub><mi>T</mi><mrow><mi>s</mi><mi>u</mi><mi>b</mi></mrow></msub><mo>−</mo><msub><mi>T</mi><mi>a</mi></msub></mrow><mrow><msub><mi>R</mi><mi>A</mi></msub><mo>+</mo><msub><mi>R</mi><mrow><mi>s</mi><mi>u</mi><mi>b</mi></mrow></msub></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align*}\nH_C &amp;= \\rho C_p \\frac{T_C - T_{a}} {R_A}\\\\\nH_{sub} &amp;= \\rho C_p \\frac{T_{sub} - T_{a}} {R_A+R_{sub}}\n\\end{align*}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.9927em;vertical-align:-2.2463em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.7463em;\"><span style=\"top:-4.7463em;\"><span class=\"pstrut\" style=\"height:3.3603em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3603em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mord mathnormal mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.2463em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.7463em;\"><span style=\"top:-4.7463em;\"><span class=\"pstrut\" style=\"height:3.3603em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3603em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mord mathnormal mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mord mathnormal mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.2463em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","html_id":"ec-hc-hsub","key":"QApK1IOWfb"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Subsequently, the substrate fluxes and temperatures are further separated incorporating a series (i.e. coupled) approach:","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"XE6fsWbhUF"}],"key":"IBlzZ8YWUw"},{"type":"math","value":"H_{C,sub} &= \\rho C_p \\frac{T_{C,sub} - T_{ac}} {R_X}\\\\\nH_s &= \\rho C_p \\frac{T_S - T_{ac}} {R_S}","label":"ec-hcsub-hs","identifier":"ec-hcsub-hs","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>H</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>s</mi><mi>u</mi><mi>b</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub><mfrac><mrow><msub><mi>T</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>s</mi><mi>u</mi><mi>b</mi></mrow></msub><mo>−</mo><msub><mi>T</mi><mrow><mi>a</mi><mi>c</mi></mrow></msub></mrow><msub><mi>R</mi><mi>X</mi></msub></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>H</mi><mi>s</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub><mfrac><mrow><msub><mi>T</mi><mi>S</mi></msub><mo>−</mo><msub><mi>T</mi><mrow><mi>a</mi><mi>c</mi></mrow></msub></mrow><msub><mi>R</mi><mi>S</mi></msub></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align*}\nH_{C,sub} &amp;= \\rho C_p \\frac{T_{C,sub} - T_{ac}} {R_X}\\\\\nH_s &amp;= \\rho C_p \\frac{T_S - T_{ac}} {R_S}\n\\end{align*}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.9927em;vertical-align:-2.2463em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.7463em;\"><span style=\"top:-4.7463em;\"><span class=\"pstrut\" style=\"height:3.3603em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mord mathnormal mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3603em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.2463em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.7463em;\"><span style=\"top:-4.7463em;\"><span class=\"pstrut\" style=\"height:3.3603em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">X</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mord mathnormal mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3603em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.2463em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"2","html_id":"ec-hcsub-hs","key":"WCTjJSfasx"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Since ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"iRFW5o80iO"},{"type":"inlineMath","value":"T_C","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"aMI1Ynlo4m"},{"type":"text","value":", ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"QjdE9VSfwc"},{"type":"inlineMath","value":"T_{C,sub}","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>s</mi><mi>u</mi><mi>b</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">T_{C,sub}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mord mathnormal mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Z3QjE4akga"},{"type":"text","value":" and ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"hLAhW8WFsP"},{"type":"inlineMath","value":"T_S","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"wJ4HvmphhR"},{"type":"text","value":" are unknown apriori, the original 3SEB formulation (3SEB-PT) implements a Priestley-Taylor (PT) formulation, as in ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"T6yNEDKm9N"},{"type":"cite","url":"https://doi.org/10.1016/0168-1923(95)02265-Y","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Norman et al. (1995)","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"Dur3Pe6tQM"}],"kind":"narrative","label":"Norman_1995","identifier":"https://doi.org/10.1016/0168-1923(95)02265-Y","enumerator":"2","key":"B3EqzNpvSq"},{"type":"text","value":", to compute a first estimate of the canopy LE and H for both overstory and understory.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"dPPogOy1Qf"}],"key":"c4A8MI6eNT"}],"key":"EzbOgz4kLZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lk8ZTlYSR9"}],"identifier":"summary","label":"Summary","html_id":"summary-1","implicit":true,"key":"SeBKo8dxnA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook will introduce users on how to run the three-source energy balance (3SEB) model in a vineyard site with the presence of cover crops in the interrow. The 3SEB model is more suited to represent the complex interactions between a clumped vegetation source planted in rows with an additional herbaceous vegetation source located in the interrows.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e7DRWDJdhH"}],"key":"pLu3SRmLo1"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/vineyard-6067535081fb30a8f4acee4e5f804c1c.png","alt":"vineyard","key":"ACUWDGeOp2","urlSource":"./input/figures/vineyard.png","urlOptimized":"/vineyard-6067535081fb30a8f4acee4e5f804c1c.webp"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"vineyard","identifier":"vineyard","html_id":"vineyard","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"H7fro31QGj"},{"type":"text","value":"2","key":"WobcRhNo8f"},{"type":"text","value":":","key":"JT88n368mn"}],"template":"Figure %s:","key":"xNcD7Vx9yA"},{"type":"text","value":"Source elements in a vineyard with cover crop. Similar structure can be found in other perennial crops such as olive orchards, almonods, pistachio, as well as agroforestry systems and savannas.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"PWUOHUHKku"}],"key":"EzQTHJS18B"}],"key":"tXDHdBxiap"}],"label":"vineyard","identifier":"vineyard","enumerator":"2","html_id":"vineyard","key":"iEA564GMl9"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"This exercise will use the 3SEB Python implementation (","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"cnwXd6qpgh"},{"type":"link","url":"https://github.com/VicenteBurchard/py3SEB","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"py3SEB","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"KFiUMKPVvW"}],"urlSource":"https://github.com/VicenteBurchard/py3SEB","error":true,"key":"HnM43xhlSH"},{"type":"text","value":"), which essentially adds an aditional vegetation source to the well-known TSEB model. The code is largely based on ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"VCKXSiPf8Q"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"pyTSEB","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"fw0usT68nT"}],"urlSource":"https://github.com/hectornieto/pyTSEB","error":true,"key":"mE1MbBv1GU"},{"type":"text","value":".","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"j6DegikZFl"}],"key":"v08hm1zILT"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"This exercise will make use of data acquired in the context of the GRAPEX project and will replicate some of the results of the analysis performed in ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"OoGrpm7F2W"},{"type":"cite","url":"https://doi.org/10.1007/s00271-022-00787-x","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Burchard-Levine ","key":"NWrstd0eQY"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"eAaJApNfWU"}],"key":"HhuDhf3vxd"},{"type":"text","value":" (2022)","key":"IcWpjhY0di"}],"kind":"narrative","label":"Burchard_Levine_2022","identifier":"https://doi.org/10.1007/s00271-022-00787-x","enumerator":"3","key":"hpAEEZugKs"},{"type":"text","value":" published in Irrigation Science.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"lg2uO7DDgp"}],"key":"xZ6tkXojNu"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"For additional information on the 3SEB model, please refer to ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"suf7MoHOiZ"},{"type":"cite","url":"https://doi.org/10.1111/gcb.16002","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Burchard‐Levine ","key":"WqmQQUXX4x"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"VPIgKytBG5"}],"key":"pOx9EGmnCm"},{"type":"text","value":" (2021)","key":"etlr6sUTHU"}],"kind":"narrative","label":"Burchard_Levine_2021","identifier":"https://doi.org/10.1111/gcb.16002","enumerator":"1","key":"aJFFrbEap5"},{"type":"text","value":", published in Global Change Biology, which introduced this model.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"gDw2PSOkvU"}],"key":"kU4zQfqdn7"}],"key":"gjyk02zmqh"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Running ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JkWOioWIiG"},{"type":"link","url":"https://github.com/hectornieto/3SEB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"py3SEB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wyWz6zmwjT"}],"urlSource":"https://github.com/hectornieto/3SEB","error":true,"key":"ZvnSWARiow"}],"identifier":"running-py3seb","label":"Running py3SEB","html_id":"running-py3seb","implicit":true,"key":"Q8MZHBt7na"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The first step is to open all relevant files with the necesary data and information to run 3SEB. Basically 3SEB requires the same input forcing as TSEB, and can found in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xCjo2QzhXQ"},{"type":"link","url":"./input/meteo/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"./input/meteo/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SMW8vwQ4sW"}],"urlSource":"./input/meteo/","key":"K8Twn43k6q"},{"type":"text","value":" folder. In addition we will also use the same time series of the daily LAI product, stored in  ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sky1Loa8It"},{"type":"link","url":"./input/canopy/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"./input/canopy/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pVX1cMQLmz"}],"urlSource":"./input/canopy/","key":"CyIt5PBNYd"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dRdsnEdfF7"}],"key":"hFmyrXwSdt"},{"type":"container","kind":"table","children":[{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"table","label":"tab-site-description","identifier":"tab-site-description","html_id":"tab-site-description","enumerator":"1","children":[{"type":"text","value":"Table ","key":"FTWmFtpAuL"},{"type":"text","value":"1","key":"F120YMzCbh"},{"type":"text","value":":","key":"iC5CTr4D45"}],"template":"Table %s:","key":"CmYkUuGMVd"},{"type":"text","value":"Description of GRAPEX sites","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"T3T3W9UhH7"}],"key":"Lv0g3D9pJh"}],"key":"idfxDQ5nhZ"},{"type":"table","position":{"start":{"line":9,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Site","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sM4zUSkS2C"}],"key":"gPvjfvViPJ"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Latitude","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"DGiT0ssfDt"}],"key":"I4oqi3bFkl"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Longitude","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"IORNKLCgon"}],"key":"DxItOQfxzd"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Elevation (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"kq0kbTdsoB"}],"key":"XGY59LmIjI"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Row direction (deg.)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Ubl0G3h96q"}],"key":"eKhWitfkpc"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Row spacing (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"UJowuy5Gz6"}],"key":"zHgqn8hn89"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Min. height (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"gOpuVXEifP"}],"key":"Ca9UvJHGKG"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Max. height (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Y548opBxVe"}],"key":"iTJxFHH1RH"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Min. width (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TWXmGBmttw"}],"key":"OodiOtRVEN"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Max. width (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Myrfw52UVH"}],"key":"tjDagPyMNY"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"TA height (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"CehX1e3c2Q"}],"key":"hTdG19lZok"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"WS height (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"CHJgESd4Bq"}],"key":"KXf7cuhsm7"}],"key":"R1jx34QQPz"},{"type":"tableRow","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Ripperdan 720-1","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Sf8o1OnHjQ"}],"key":"PBdG3bz2ZG"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"36.849","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"YNYZ16sUUB"}],"key":"F3C9xkgVkH"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"-120.176","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"fj0Jz4j3RP"}],"key":"Hy27SjB9Nz"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"61","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QzZZzeOuxU"}],"key":"nX2hxCSrj0"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"pxJBWFhSS2"}],"key":"LG9ZsWrtgm"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"PKYV9rausn"}],"key":"nL2rEX8fvr"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"KQEx6DOLql"}],"key":"rnLfWZgNbc"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"2.2","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"RSgd3yCG3d"}],"key":"kRV2rFcT8y"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"RiDXov9i6M"}],"key":"kfH7gJzL3p"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"S36DE29lDe"}],"key":"Ydm1sqQr8O"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"OQzspHSjeN"}],"key":"onF3QmMZBO"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"p3GG6eOXer"}],"key":"qtN2C0JH6A"}],"key":"mUeNhoFo3j"},{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Ripperdan 720-2","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"LodhcxEFcr"}],"key":"n3PApQ9Viu"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"36.849","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"g83mVnLezG"}],"key":"tW1UjfJ3g6"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"-120.174","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"JFuSU9TPbq"}],"key":"PjLP6d1eKG"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"61","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"p9zcjSBDpS"}],"key":"Ft3B6ypEAB"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"rQZikT8o6z"}],"key":"j6rbFRaB1U"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"qlDB2ZMX2W"}],"key":"taWcPibEiv"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ukSyQgksPa"}],"key":"h1jhDpBWVQ"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"2.2","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"vo4vHJNWrV"}],"key":"HuRJjHpoUt"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"acaqg20NY2"}],"key":"xNMSjSl5Xs"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"QMnklI0pns"}],"key":"kBwfB52Gq7"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"HtbMN36vvp"}],"key":"HCQqYiBmns"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"DgHAEclb5D"}],"key":"TNsqvhZCVL"}],"key":"qfYVo0wpq9"},{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Ripperdan 720-3","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KzAqMqCqEj"}],"key":"Cs4Z6Pu4ss"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"36.848","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"iXU12qoM5X"}],"key":"LaopA4evIs"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"-120.176","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"rBqLrX5mN1"}],"key":"JXDXEOhOOW"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"61","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Qkn8xDO7K7"}],"key":"lQZzoslE7B"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"VHux5brIC9"}],"key":"KYT48n4yuh"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"HbzSDwtQJI"}],"key":"Q7O2byv3qe"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"tms6cN8u0o"}],"key":"a6v7HTbHcG"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"2.2","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"iHhQRTDEZp"}],"key":"bLnXEcaBt8"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"a7nF7mTP8K"}],"key":"O6Tptrh57d"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"gF1gWrHb7t"}],"key":"Ah1TbfF7W2"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"wyRAexStLl"}],"key":"NYNeMrpiaC"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Xeo4TvUsEG"}],"key":"mYXqmW7dAo"}],"key":"V36oSHocWG"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Ripperdan 720-4","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"LjNm2dSF64"}],"key":"xJiBZoT6AH"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"36.848","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"VDospqUKqU"}],"key":"PtuQHEmGH9"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"-120.174","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"GZbNO8MC7V"}],"key":"EBKkhrrg4M"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"61","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"qe47htLASz"}],"key":"dkP1wWSaNo"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ADwwR3hg5o"}],"key":"q9RW0HA4fQ"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Pd1meng85P"}],"key":"JlLVm4nEBw"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"qKanCFvzHy"}],"key":"itU5eS93We"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"2.2","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"vWc1fDlkXA"}],"key":"j5OHJTCDZN"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"OckdwnDSTG"}],"key":"a56LLUCgfY"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"TsS6HdUvyT"}],"key":"QwXmgi0zdx"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"MQgXe26e1W"}],"key":"hppeuJgYfr"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"FYtJNhOZJu"}],"key":"Sib7o8bs75"}],"key":"P3MlsBPZM8"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Barrelli_007","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"kP2ja2xyD0"}],"key":"zlg4dyKHS5"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"38.753","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"iYHcet1tHw"}],"key":"kpHPpESw3m"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"-122.98","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"mrqFVVHL3i"}],"key":"zlWaTsUhVR"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"113","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"z0erST4Oqi"}],"key":"l724IvN0Eh"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"135","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"gKsZalOTGh"}],"key":"xpdctL75iX"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"h5aFsWcLPc"}],"key":"Ev6Dk00jRP"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"1.25","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"D7zmdz0NHz"}],"key":"kkgmblluwD"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"2.3","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"FPswxeCDpd"}],"key":"u0Hm1d5byK"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"eJd0m7CucF"}],"key":"Sa3fGbhKEY"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"1.8","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"XkCxjBFeWZ"}],"key":"mJIN6zKd7H"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"x3YRjSNkYh"}],"key":"ZFjc7GyNXX"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"MPRSO4FHUv"}],"key":"VSUubYWlJT"}],"key":"QJ08wEIsOp"},{"type":"tableRow","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Barrelli_012","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"zedBnbi4gY"}],"key":"decszdnIla"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"38.751369","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"TgqVhPLkyf"}],"key":"fr25bDqMtT"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"-122.974658","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"RGaRMrc427"}],"key":"DTdjXiZkhW"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"112","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"wSPrW8saiT"}],"key":"Yls88J4NiJ"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"45","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"gSTXu2Crb7"}],"key":"DKAyKTwbrU"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"LV1hChxvVW"}],"key":"jZ2bqDvVBT"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"1.25","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"mKbSjPgsak"}],"key":"fkVWOq6mWa"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"2.3","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"AoDfe8bSU0"}],"key":"lQ5QfMKfkT"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"o0ClMP9UVq"}],"key":"olZ8bUaYCH"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"1.8","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"pdrmHDOkJ7"}],"key":"aBXEJaCHJc"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"4.4","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"RZD4iWRZkT"}],"key":"KCyOXmL7UV"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"4.4","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"klWZEST4jj"}],"key":"IjxSx3dYZX"}],"key":"RItZsVNuG3"},{"type":"tableRow","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Sierra Loma-north","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"UTwqaFEs6s"}],"key":"iphtryq0Nz"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"38.289338","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"oJfV0raMDM"}],"key":"GPmm1MzsHw"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"-121.117764","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"NeKQkkbPUu"}],"key":"dLZkC2l5rM"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"38","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"U6wdbQ43qZ"}],"key":"a1pNIFqoVF"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"zxwDoiTrmF"}],"key":"dWbpUGoqE5"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"IdzRHSDutJ"}],"key":"XUX932FtOd"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"1.42","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"yZtsBBt8cc"}],"key":"wPk0BI1VDY"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"xw8xTfkOfp"}],"key":"c132XlEl4Y"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"IfdxvtIAVM"}],"key":"F0JSwfylF5"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"2.6","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"n146enk4u5"}],"key":"goxgbJD8Iv"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"zuzMJRJN7f"}],"key":"fzqavtCPnI"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"OsLJZXUQ24"}],"key":"XALeO7BRao"}],"key":"J6568iEJhS"},{"type":"tableRow","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Sierra Loma-south","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"kJ1FXH8GC7"}],"key":"pZ6pr1gGCO"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"38.280488","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"A5QeeyNp01"}],"key":"oPtYeHl6Fs"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"-121.117597","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"nuN5dC5w1f"}],"key":"OF7vsdKNsH"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"37","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"mnbu2HzZaO"}],"key":"j5PF0aEPGs"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ynyI4RsFZJ"}],"key":"d1NRW5nh7G"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"rfy0BFKwHA"}],"key":"cvmm5It0An"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"1-42","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"irWC4UwNvA"}],"key":"TsrmvVVC3s"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"HD5KrRY6tS"}],"key":"ElCorHW7zj"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"VHpTtCzcHu"}],"key":"bAccqrNP8V"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"IVtuHX7xRH"}],"key":"ywSm3K2Ss2"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"FpPvHJMtZS"}],"key":"Xg0lFPQJXV"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"I4lgK8pB2A"}],"key":"YG7l4cjxko"}],"key":"jIPtwHME6s"},{"type":"tableRow","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Ripperdan 760","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"c6CdD1a772"}],"key":"bFYYv6REma"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"36.839025","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"HhwvZxi2d6"}],"key":"cK9MbjStmr"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"-120.21014","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"OO4bKSMP9x"}],"key":"ABSmEZt6yZ"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"58","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"JmvTnX5rHK"}],"key":"Oq6O5yzgpn"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"BpLjeol2jJ"}],"key":"QEGZSjHhey"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"2.74","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"gOQKvzdTWC"}],"key":"c2UPmZDdEe"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"vnD96Ect7L"}],"key":"iARv0SN2F7"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"2.5","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"yXTPmXzASe"}],"key":"xrha2BcRsr"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"QwUAEUfNMJ"}],"key":"z10zthgc5p"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"1.8","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"JhN7is8WbU"}],"key":"vnK6Os3c3y"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"5.5","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"DmiB9aggQ2"}],"key":"QG2bXocc62"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"uTm6YxV0yv"}],"key":"lhvXzicLBf"}],"key":"Vc9LJnTR1Y"},{"type":"tableRow","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Barrelli_016","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"J4S9vic708"}],"key":"uQHRNKyXqa"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"38.747","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"mhqYYermKa"}],"key":"aAutFlAuPj"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"-122.963","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"A8W9BHcdr3"}],"key":"ynwcdSrRT6"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"112","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"QsjT0u3ynX"}],"key":"GDvK1Ctv8s"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"135","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"X0YyY76ARH"}],"key":"EBUaQ2Wzsx"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"uIAT9j5Njl"}],"key":"aOtN2uJJ2u"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"1.25","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"gp9AEGMwE6"}],"key":"GcdAowP9rK"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"2.3","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Up1hfooPpG"}],"key":"lqyHjcOhCC"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"VujG3vePwF"}],"key":"djYyKJn85P"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"1.8","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"NlSYSNsgBF"}],"key":"MCuuqbXIF4"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"mSlLZTztjU"}],"key":"KbGnb3HDZR"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"vl7ILi5dWm"}],"key":"t2oc3USt5f"}],"key":"UtCDABwLkI"}],"key":"XjUm7fqlZL"}],"label":"tab-site-description","identifier":"tab-site-description","enumerator":"1","html_id":"tab-site-description","key":"adleztEFAA"},{"type":"heading","depth":3,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Select a site","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"s4G4sLGCnI"}],"identifier":"select-a-site","label":"Select a site","html_id":"select-a-site","implicit":true,"key":"Adxc9uw8Ei"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"As an example, we suggest to work with data collected over ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"ifHqEm3Lyj"},{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Block 3","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"hYf4yyWg4k"}],"key":"iskroiWRBj"},{"type":"text","value":" of the ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"wfU9ES8FJZ"},{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Ripperdam","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"VnqlEbmBby"}],"key":"bEMZIbemY5"},{"type":"text","value":" site from ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"nGcddlqYZq"},{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"2019","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"rymssH44h0"}],"key":"juRE0nknZp"},{"type":"text","value":", as this site had a cover crop present during this year. But you can select any other site for comparison.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"uO6iyFGHAh"}],"key":"Ie8Fs7yOwn"}],"key":"lZv3QHONHe"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"w_site = widgets.Dropdown(\n    options=[('Sierra Loma N', \"slmN\"), ('Sierra Loma S', \"slmS\"), \n             ('Barrelli 007', \"bar007\"), ('Barrelli 012', \"bar012\"),\n             ('Ripperdan 760', \"rip760\"), \n             ('Ripperdan 720-1', \"rip720_1\"),  ('Ripperdan 720-2', \"rip720_2\"),  ('Ripperdan 720-3', \"rip720_3\"),  ('Ripperdan 720-4', \"rip720_4\")],\n    value=\"rip720_3\",\n    description='Site:',\n)\ndisplay(w_site)","visibility":"show","key":"SFqWPadfGo"},{"type":"output","id":"GgyTVsK6KXvGrlRiOKWRW","data":[],"visibility":"show","key":"t51Yf1Q6dQ"}],"visibility":"show","key":"fgbGsFDwnV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We read and merge the micrometeorology and LAI tables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wL3mrd4JmO"}],"identifier":"we-read-and-merge-the-micrometeorology-and-lai-tables","label":"We read and merge the micrometeorology and LAI tables","html_id":"we-read-and-merge-the-micrometeorology-and-lai-tables","implicit":true,"key":"pv68ZYOBZW"}],"key":"uf6COjokM0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Import Python libraries\nfrom pathlib import Path\nimport pandas as pd\n\n# Set the LAI and readiation folders\ninput_dir = Path().absolute() / \"input\"\nlai_dir = input_dir / \"canopy\"\nec_dir = input_dir / \"meteo\"\n# Set the input files based on the chosen site\nlai_filename = lai_dir / f\"FLX_US-{w_site.value}_FLUXNET2015_AUXCANOPY_DD.csv\"\nec_filename = ec_dir / f\"FLX_US-{w_site.value}_FLUXNET2015_SUBSET_HR.csv\"\nprint(f\"LAI file path is {lai_filename}\")\nprint(f\"EC file path is {ec_filename}\")\n\n# Read the LAI and radiation tables\nlai = pd.read_csv(lai_filename, sep=\";\", na_values=-9999)\nec = pd.read_csv(ec_filename, sep=\";\", na_values=-9999)\n\n# Merge both tables by date\nec[\"TIMESTAMP\"] = pd.to_datetime(ec[\"TIMESTAMP\"], format=\"%Y%m%d%H%M\")\nlai[\"DATE\"] = pd.to_datetime(lai[\"TIMESTAMP\"], format=\"%Y%m%d\").dt.date\nlai = lai.drop(labels=[\"TIMESTAMP\"], axis=1)\nec[\"DATE\"] = ec[\"TIMESTAMP\"].dt.date\nec = ec.merge(lai, on=\"DATE\")\n\n# We discard all cases at night (SW_IN <=0)\nec = ec[ec[\"SW_IN\"] > 0]\n\n# Convert Celsius to Kelvin\nec[\"TA\"] = ec[\"TA\"] + 273.15\n# Convert kPa to hPa\nec[\"PA\"] = 10 * ec[\"PA\"]\n\n# Evaluate different energy balance closure corrections\nec[\"H_RES\"] = ec[\"NETRAD\"] - ec[\"G\"] - ec[\"LE\"]\nec['LE_RES'] = ec['NETRAD'] - ec['G'] - ec['H']\nec[\"LE_BR\"], ec[\"H_BR\"] = TSEB.met.bowen_ratio_closure(ec[\"NETRAD\"], ec[\"G\"],\n                                                       ec[\"H\"], ec[\"LE\"])\n# Mean of uncorrected, ressidual and Bowen Ratio\nec[\"H_ENS\"] = np.nanmean([ec[\"H_RES\"], ec[\"H_BR\"], ec['H']], axis=0)\nec[\"LE_ENS\"] = np.nanmean([ec[\"LE_RES\"], ec[\"LE_BR\"], ec['LE']], axis=0)","key":"JD7msB1WFF"},{"type":"output","id":"IuVL1u1_Tk0FbILdr-SGj","data":[],"key":"t8WEnJAFJY"}],"key":"KubfjhWaBp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Site Description","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sgw8bqzJWq"}],"identifier":"site-description","label":"Site Description","html_id":"site-description","implicit":true,"key":"gznHdLYAL0"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Here we initialize relevant information related to the site characteristics including geographical position (lat/lon) and vineyard row direction/dimensions","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BmEiynEpyJ"}],"key":"XOORIaXWRA"}],"key":"bSbHBxrOjQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import yaml\nyaml_file = input_dir / \"site_description.yaml\"\nsite_dict = yaml.safe_load(yaml_file.read_text())\nlat = float(site_dict[\"lat\"][w_site.value])\nlon = float(site_dict[\"lon\"][w_site.value])\nelev = float(site_dict[\"elev\"][w_site.value])\nrow_direction = float(site_dict[\"row_direction\"][w_site.value])\ninterrow = float(site_dict[\"interrow\"][w_site.value])\nhc_min = float(site_dict[\"hc_min\"][w_site.value])\nhc_max = float(site_dict[\"hc_max\"][w_site.value])\nwc_min = float(site_dict[\"wc_min\"][w_site.value])\nwc_max = float(site_dict[\"wc_max\"][w_site.value])\nzh = float(site_dict[\"zh\"][w_site.value])\nzm = float(site_dict[\"zm\"][w_site.value])\n\nprint(f\"{w_site.label} has the following site characteristics:\\n\"\n      f\"\\t Latitude: {lat} deg. \\n\"\n      f\"\\t Longitude: {lon} deg. \\n\"\n      f\"\\t Elevation: {elev} m \\n\"\n      f\"\\t Row direction: {row_direction} deg. \\n\"\n      f\"\\t Row spacing: {interrow} m \\n\"\n      f\"\\t Min. canopy height: {hc_min} m \\n\"\n      f\"\\t Max. canopy height: {hc_max} m \\n\"\n      f\"\\t Min. canopy width: {wc_min} m \\n\"\n      f\"\\t Max. canopy width: {wc_max} m \\n\"\n      f\"\\t Air temperature measurement height: {zh} m \\n\"\n      f\"\\t Wind speed temperature measurement height: {zh} m\")","key":"E04KDMU9Ws"},{"type":"output","id":"0x4EiZoji1La82xHLxC5n","data":[],"key":"OmvOdcDd0p"}],"key":"hHRYE6HqZ0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Estimate vegetation traits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p0a0wqKmkN"}],"identifier":"estimate-vegetation-traits","label":"Estimate vegetation traits","html_id":"estimate-vegetation-traits","implicit":true,"key":"DTp1joivpj"},{"type":"heading","depth":4,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Separation of grapevine and cover crop LAI","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LqmFvWE61P"}],"identifier":"separation-of-grapevine-and-cover-crop-lai","label":"Separation of grapevine and cover crop LAI","html_id":"separation-of-grapevine-and-cover-crop-lai","implicit":true,"key":"jMMmI2NW7n"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"3SEB has very similar data requirements to TSEB but a key distinction is the need to separate biophsyical properties for the two vegetation sources, in this case the grapevine and cover crop. There is no general formula to separate or unmix LAI from the different vegetation sources, there are potentially many differnt methods that can be used.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mvSPK1J3g6"}],"key":"M97tT9ap4X"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"In this exercise, we will exploit the fact the grapevines and cover crops have different phenological dynamics and we will use this to separate the total LAI values into each component as described in ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"liZPda7dRO"},{"type":"cite","url":"https://doi.org/10.1007/s00271-022-00787-x","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Burchard-Levine ","key":"dDDwPB0Tc2"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"TzjrywxJ3u"}],"key":"gog9R1waEn"},{"type":"text","value":" (2022)","key":"Vz1lSwla4t"}],"kind":"narrative","label":"Burchard_Levine_2022","identifier":"https://doi.org/10.1007/s00271-022-00787-x","enumerator":"3","key":"AbVhggNCNO"}],"key":"Ccrtjslvgg"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The daily ecosystem LAI were acquired over each tower footprint at 30 m resolution by merging satellite data from the Harmonized Landsat and Sentinel-2 (HLS) surface reflectance and MODIS LAI data product together with in situ LAI measurements ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"XPHDfn0DEr"},{"type":"citeGroup","kind":"parenthetical","children":[{"type":"cite","kind":"parenthetical","label":"Kang_2022","identifier":"https://doi.org/10.1007/s00271-022-00798-8","children":[{"type":"text","value":"Kang ","key":"S7KkZWZBmk"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"gVXHwcogcu"}],"key":"iOoPf3pR6I"},{"type":"text","value":", 2022","key":"O3qEfWYNgv"}],"enumerator":"4","key":"U7J2hR8UMy"}],"key":"OBNEuLDa6U"},{"type":"text","value":". The LAI over each tower footprint was extracted from 3 × 3 30 m pixels, thus including vine and cover crop (CC) contributions.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"rn8Wcx6tSV"}],"key":"tuJRok2RAo"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"The CC normally has a growing phase during early spring and then is mowed in early summer becoming senescent stubble during the main grapevine growing period between May and August. Therefore, the CC LAI (","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"MWMfp5ympN"},{"type":"inlineMath","value":"LAI_{cc}","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>A</mi><msub><mi>I</mi><mrow><mi>c</mi><mi>c</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">LAI_{cc}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">cc</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XmoKI733tg"},{"type":"text","value":") was assumed to contribute completely to the total ecosystem LAI (","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"c0rXAXgaWJ"},{"type":"inlineMath","value":"LAI_{eco}","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>A</mi><msub><mi>I</mi><mrow><mi>e</mi><mi>c</mi><mi>o</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">LAI_{eco}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">eco</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"si2NrgeMD5"},{"type":"text","value":") before the vine bud-break (~spring) and after vine leaf-off during the fall. The ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"weuM42NB4N"},{"type":"inlineMath","value":"LAI_{cc}","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>A</mi><msub><mi>I</mi><mrow><mi>c</mi><mi>c</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">LAI_{cc}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">cc</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"j7HiosDzYs"},{"type":"text","value":" was simulated to exponentially decay from spring until the peak summer period and then exponentially re-grow during the fall period after the vine leaf-off from ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"twCBnDXdkD"},{"type":"crossReference","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Figure ","key":"RgjqEnkFaP"},{"type":"text","value":"3","key":"oTKmZZ5sDV"}],"identifier":"lai-timeseries","label":"lai-timeseries","kind":"figure","template":"Figure %s","enumerator":"3","resolved":true,"html_id":"lai-timeseries","key":"Ah5gETqWt0"},{"type":"text","value":".","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"OC7vDxNplG"}],"key":"R4TZyHxbnj"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/lai_partitioning-1415a93565e922c70bad2664403438c4.png","alt":"LAI time series","key":"kX80FPPTPC","urlSource":"./input/figures/lai_partitioning.png","urlOptimized":"/lai_partitioning-1415a93565e922c70bad2664403438c4.webp"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"lai-timeseries","identifier":"lai-timeseries","html_id":"lai-timeseries","enumerator":"3","children":[{"type":"text","value":"Figure ","key":"mP09FEefKr"},{"type":"text","value":"3","key":"xn8yOpCial"},{"type":"text","value":":","key":"skfzWRZQiN"}],"template":"Figure %s:","key":"dQJfoeEFyn"},{"type":"text","value":"Time series of ecosystem LAI (LAIeco) from satellite imagery (Kang et al., 2022) from block 3 of 2019 decomposed into vine (LAIvine) and cover crop (LAIcc) LAI based on seasonal dynamics. Source: ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"e1wL0ze9fL"},{"type":"cite","url":"https://doi.org/10.1007/s00271-022-00787-x","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Burchard-Levine ","key":"poO2eAPVvP"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"kXyo4wt1OD"}],"key":"LrfpvwaRSC"},{"type":"text","value":" (2022)","key":"ZSUQkQoVu5"}],"kind":"narrative","label":"Burchard_Levine_2022","identifier":"https://doi.org/10.1007/s00271-022-00787-x","enumerator":"3","key":"PVZc9jj3Zj"}],"key":"BM3vSJy05H"}],"key":"lfusns9FW6"}],"label":"lai-timeseries","identifier":"lai-timeseries","enumerator":"3","html_id":"lai-timeseries","key":"EvDeczMGUI"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Seasonal transitions dates were corroborated with in situ phenocam data. Subsequently, LAIcc was subtracted from the ecosystem LAI to obtain vine LAI (LAIvine)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"EjOGnxSEfZ"}],"key":"joPu0yR3vQ"},{"type":"math","value":"LAI_{vine} = LAI_{eco} - LAI_{cc}","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>L</mi><mi>A</mi><msub><mi>I</mi><mrow><mi>v</mi><mi>i</mi><mi>n</mi><mi>e</mi></mrow></msub><mo>=</mo><mi>L</mi><mi>A</mi><msub><mi>I</mi><mrow><mi>e</mi><mi>c</mi><mi>o</mi></mrow></msub><mo>−</mo><mi>L</mi><mi>A</mi><msub><mi>I</mi><mrow><mi>c</mi><mi>c</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">LAI_{vine} = LAI_{eco} - LAI_{cc}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal mtight\">in</span><span class=\"mord mathnormal mtight\">e</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">eco</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">cc</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"3","key":"DpBElo2c0m"}],"key":"k5irhIMPU3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set key seasonal transitions (DOY)\nbud_break = 97\nspring_start = 121\nsummer_end = 330\n# set a minimum of cover crop LAI \nlai_cc_min = 0.2  # do not set to 0 or very low values. This will make model unstable due to equations that use LAI in denominator i.e. Rx\n\n# get day of year array\ndoy = ec['TIMESTAMP'].dt.dayofyear\n\nmid_summer = int((spring_start + summer_end) / 2)\ncc_senescence = int((spring_start + mid_summer) / 2)\ncc_regrowth = int((mid_summer + summer_end) / 2)\n\n# =======================================\n# 2.1.3 simulate growth/decay of cover crop\n# =======================================\n\n#initialize LAI/fg vine and LAI/fg CC\nlai_cc = np.full_like(ec['LAI'].values, lai_cc_min)\nfg_cc = np.ones_like(ec['LAI'].values)\n\n# --- before vine bud-break\n# before bud-break all LAI is atributed to cover crop (CC)\nlai_cc[doy <= bud_break] = ec['LAI'].values[doy <= bud_break]\n\n# --- cover crop decay\n# When vine bud breaks, exponential decay until mid summer period\n# mid summer period cover crop is as minimum\n\n### get doy array associated with cover crop decay\ndoy_decay = doy[np.logical_and(doy > bud_break, doy < mid_summer)]\n## simulate exponetnial decay during senescence\nlai_cc_decay = np.logspace(np.log(lai_cc[doy == bud_break][0]), np.log(lai_cc_min),doy_decay.size, base=np.exp(1))\nlai_cc[doy_decay] = lai_cc_decay\n\n# do same for green fraction \nfg_cc_decay = np.logspace(np.log(1), np.log(0.01), doy_decay.size, base=np.exp(1))\nfg_cc[doy_decay] = fg_cc_decay\n\n# --- autumn regrowth\n\n#autumn regrowth (and vine leaf off)\ndoy_regrow = doy[np.logical_and(doy > cc_regrowth, doy <= summer_end)]\n# simulate exponential growth during autumn regrowth\nlai_cc_regrow = np.logspace(np.log(lai_cc[doy == cc_regrowth][0]), np.log(ec['LAI'].values[doy==summer_end][0]),doy_regrow.size, base=np.exp(1))\nlai_cc[doy_regrow] = lai_cc_regrow\n\n# same for green fraction \nfg_cc_regrow = np.logspace(np.log(0.01), np.log(1), doy_regrow.size, base=np.exp(1))\nfg_cc[np.logical_and(doy > cc_regrowth, doy <= summer_end)] = fg_cc_regrow\nfg_cc[np.logical_and(doy >= mid_summer, doy <= cc_regrowth)] = 0.01\n\n# ---post-autumn/winter\n\n# all LAI is CC after summer\nlai_cc[doy>summer_end] = ec['LAI'].values[doy>summer_end]\n\n# =======================================\n# 2.1.4 get grapevine LAI/fg\n# =======================================\n\n#get LAI vine but suctracting LAIcc from LAI\nlai_vine = ec['LAI'].values - lai_cc\n# set minimum of LAI to 0.4 (taking into account branches/trunk effect)\nlai_vine[lai_vine<0.4] = 0.4\nfg_vine = np.full_like(lai_vine, 1)\nprint('Done!')","key":"ptWio4hjfo"},{"type":"output","id":"cW-CPIjbEojEoyCggHgVQ","data":[],"key":"ERB2UuVL3Z"}],"key":"GmmqTXfkxP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize LAI partitioning","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bIgsJCIvOL"}],"identifier":"visualize-lai-partitioning","label":"Visualize LAI partitioning","html_id":"visualize-lai-partitioning","implicit":true,"key":"lv35fBdiTY"}],"key":"qshNdmZxuK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from plotly.subplots import make_subplots\nimport plotly.graph_objects as go\nfig = make_subplots(specs=[[{\"secondary_y\": True}]])\nfig.add_trace(go.Scatter(x=ec[\"TIMESTAMP\"].values, y=ec['LAI'].values, \n                         name=\"Total LAI\", mode=\"lines\", line={\"color\": \"black\"}))\n\nfig.add_trace(go.Scatter(x=ec[\"TIMESTAMP\"].values, y=lai_cc, \n                         name=\"Cover crop LAI\", mode=\"lines\", line={\"color\": \"green\"}))\nfig.add_trace(go.Scatter(x=ec[\"TIMESTAMP\"].values, y=lai_vine, \n                         name=\"Grapevine LAI\", mode=\"lines\", line={\"color\": \"red\"}))\nfig.add_trace(go.Scatter(x=ec[\"TIMESTAMP\"].values, y=fg_cc, \n                         name=\"Cover crop green fraction\", mode=\"lines\", line={\"color\": \"green\", \"dash\": \"dot\"}),\n              secondary_y=True)\nfig.update_layout(title_text=f\"LAI partition at {w_site.label}\",\n                  xaxis_title=\"Date\", yaxis_title=\"LAI\")","key":"YgxAEoCKFJ"},{"type":"output","id":"3N0KFnHsgWqwHtXxc7F3F","data":[],"key":"FDMd9c3WNO"}],"key":"UQkZofmecN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Estimate the structural variables based on Earth Observation LAI timeseries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sAy1TZrG25"}],"identifier":"estimate-the-structural-variables-based-on-earth-observation-lai-timeseries","label":"Estimate the structural variables based on Earth Observation LAI timeseries","html_id":"estimate-the-structural-variables-based-on-earth-observation-lai-timeseries","implicit":true,"key":"QHlvw569kd"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The structural traits for the vineyard, such as canopy height (hc) and fractional cover (fc), are estimated from empirical equations developed for this site as described in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"m3RiGrtiCl"},{"type":"cite","url":"https://doi.org/10.1007/s00271-018-0611-y","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Nieto ","key":"UtmfNbFglj"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"QCPSEm4TQF"}],"key":"rGZB5LIyoE"},{"type":"text","value":" (2018)","key":"Lk0FXPXjuI"}],"kind":"narrative","label":"Nieto_2018","identifier":"https://doi.org/10.1007/s00271-018-0611-y","enumerator":"5","key":"EVshWfAcmQ"},{"type":"text","value":". For canopy height and fractional cover, we used the same empirical equations as in previous exercises.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d5f4mMNyfM"}],"key":"ORzjVmtWV8"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/vineyard_structural_-5580286c447cd7404b3a56ad90a91a0d.png","alt":"Empirical structural functions","key":"G1jUphXRDZ","urlSource":"./input/figures/vineyard_structural_functions.png","urlOptimized":"/vineyard_structural_-5580286c447cd7404b3a56ad90a91a0d.webp"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"structural-functions","identifier":"structural-functions","html_id":"structural-functions","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"BKQmM44ib6"},{"type":"text","value":"2","key":"eBBQwUKxr3"},{"type":"text","value":":","key":"tdkJwxoMuP"}],"template":"Figure %s:","key":"KCylYMn2BF"},{"type":"text","value":"Empirical models relating canopy height , canopy width and the bottom of the canopy with the fused STARFM LAI. Solid dots represent in situ measured values","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"bMdQKYOdTu"}],"key":"SsgUsJ0pOc"}],"key":"dfJTszKhp7"}],"label":"structural-functions","identifier":"structural-functions","enumerator":"4","html_id":"structural-functions","key":"LlWaobT2Lr"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"J9IxcP52jv"}],"key":"esbDJ65brc"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Structural traits could also be prescribed based on a land cover map or, even better with LiDAR/PhoDAR information","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"M69o5GivIa"}],"key":"j2xYStHzRO"}],"class":"dropdown","key":"RROZAFLxVk"}],"key":"yyzkd32I3C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"################################################################################\n# Empirical equations to generate canopy structural parameters from LAI\n################################################################################\ndef lai_2_hc(lai, hc_min):\n    slope = 0.42\n    hc = hc_min + slope * lai\n    return hc\n\n\ndef lai_2_hbratio(lai, hc_min):\n    hb_ratio_mean = 0.4848388065\n    hb_ratio = np.zeros(lai.shape)\n\n    hb_ratio[lai < hc_min] = 1. + ((hb_ratio_mean - 1.) / hc_min) * lai[\n        lai < hc_min]\n    hb_ratio[lai >= hc_min] = hb_ratio_mean\n\n    return hb_ratio\n\n\ndef lai_2_width(lai, wc_min, wc_max):\n    beta = 6.96560056\n    offset = 1.70825736\n\n    width = wc_min + (wc_max - wc_min) / (1.0 + np.exp(-beta * (lai - offset)))\n\n    return width\n\n\ndef lai_2_fcover(lai, fc_min, fc_max):\n    beta = 7.0\n    offset = 1.70\n\n    fcover = fc_min + (fc_max - fc_min) / (1.0 + np.exp(-beta * (lai - offset)))\n\n    return fcover\n\n\ndef lai_2_canopy(lai, hc_min, fc_min, fc_max):\n    hc = lai_2_hc(lai, hc_min)\n    hb_ratio = lai_2_hbratio(lai, hc_min)\n    fcover = lai_2_fcover(lai, fc_min, fc_max)\n\n    return hc, hb_ratio, fcover\n\n\n# Grapevine height\nh_c_vine, hb_ratio_vine, f_c_vine = lai_2_canopy(lai_vine, hc_min, wc_min / interrow, wc_max / interrow)\n# clip to maximum and minimum possible\nh_c_vine = np.clip(h_c_vine, hc_min, hc_max)\nf_c_vine = np.clip(f_c_vine, 0, 1)","key":"cHA8zpHHKC"},{"type":"output","id":"I0mNtFdUdpK4Lg0Wwc8lO","data":[],"key":"UujD3dqpOz"}],"key":"J4ErBi8uCm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"and for the herbaceous cover crop we assume a constant canopy heigh and full coverage","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wFZFGtkss9"}],"key":"qQka0x0xBw"}],"key":"RR9DjHP4TB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Crop height\nh_c_cc = 0.35\nh_c_cc = np.full_like(h_c_vine, h_c_cc)\n# Crop coverage\nf_c_cc = np.ones_like(h_c_vine)\n# Crop width to height ratio\nw_c_cc = np.ones_like(h_c_vine)\nw_c_ratio_cc = np.ones_like(h_c_vine)","key":"oIGeCB2Pjy"},{"type":"output","id":"YzJNK79j9i-2NDs48QIyK","data":[],"key":"biM3nGI1m3"}],"key":"DLffvT2Z1w"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Estimate vegetation clumping index","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZD3RMJxeB1"}],"identifier":"estimate-vegetation-clumping-index","label":"Estimate vegetation clumping index","html_id":"estimate-vegetation-clumping-index","implicit":true,"key":"AaLMRHbFC6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Since grapevine canopies are highly clumped and have unique row structures, we will take into account row structure and orientation to calculate the clumping index, which is important when modelling the radiation transmission through the canopy.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GgpNTwVylS"}],"key":"UibKrAzUzw"}],"visibility":"show","key":"z5Usp5FKAQ"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# =======================================\n# Grapevine width\nw_c_vine = f_c_vine * interrow\n# Grapevine width to height ratio\nw_c_ratio_vine = w_c_vine / (h_c_vine - hb_ratio_vine * h_c_vine)\n# Grapevine Local LAI\nF_vine = lai_vine / f_c_vine\n\n# The time zone is PST, which corresponds to -120 deg, time longitude\nstdlon = -120\n# Call calc_sun_angles based on site coordinates and timestamp\nsza, saa = TSEB.met.calc_sun_angles(\n    np.full_like(ec['LAI'].values, lat),\n    np.full_like(ec[\"LAI\"].values, lon),\n    np.full_like(ec[\"LAI\"].values, stdlon),\n    ec['TIMESTAMP'].dt.dayofyear.values,\n    ec['TIMESTAMP'].dt.hour.values + ec['TIMESTAMP'].dt.minute.values / 60.)\n\n# Compute the relative sun-row azimuth angle\npsi = row_direction - saa\n# Compute the clumping index for row crops\nomega_vine = TSEB.CI.calc_omega_rows(lai_vine, f_c_vine, theta=sza, psi=psi, w_c=w_c_ratio_vine, x_lad=1)\n# effective lai\nlai_eff_vine = F_vine * omega_vine","visibility":"show","key":"n1Eha7heUn"},{"type":"output","id":"e5cllnWxRyygAsVTLDSFC","data":[],"visibility":"show","key":"nae1awg57I"}],"visibility":"show","key":"pXTHufMU3G"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"On the other hand, for the cover crop we can assume that it is horizontally homogeneous and non-clumped","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aPkELcwtkN"}],"key":"W09ukF8CgC"}],"key":"tyNzUERnCU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Estimate net radiation transfer through the three sources","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tEEyHpEGFn"}],"identifier":"estimate-net-radiation-transfer-through-the-three-sources","label":"Estimate net radiation transfer through the three sources","html_id":"estimate-net-radiation-transfer-through-the-three-sources","implicit":true,"key":"DGM8XxSAOp"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We use a beer-lambert (-type) modeling scheme to simulate the radiation transmission through the multiple vegetation canopies adapted from the model described in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"f72GEfFy1r"},{"type":"cite","url":"https://doi.org/10.1007/978-1-4612-1626-1_15","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Chapter 15 of Campbell and Norman (1998)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PLPs9zsRwd"}],"kind":"narrative","label":"Campbell_1998","identifier":"https://doi.org/10.1007/978-1-4612-1626-1_15","enumerator":"6","key":"xEWDbZ1DsL"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JdNqj7rVMB"}],"key":"yI4bJf8QjT"},{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"See Also","key":"VfPqtoxfw1"}],"key":"KQiL5YzIQx"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The full code for the Shuttleworth and Wallace model is at the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"o9tiKJa0ci"},{"type":"link","url":"https://github.com/VicenteBurchard/py3SEB/blob/c89b70e0f95d21338b65efc9cbbf90aac70ba3a0/py3seb/py3seb.py#L716","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"3SEB GitHub repository","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CXEm6XhABm"}],"urlSource":"https://github.com/VicenteBurchard/py3SEB/blob/c89b70e0f95d21338b65efc9cbbf90aac70ba3a0/py3seb/py3seb.py#L716","data":{"kind":"file","org":"VicenteBurchard","repo":"py3SEB","reference":"c89b70e0f95d21338b65efc9cbbf90aac70ba3a0","file":"py3seb/py3seb.py","from":716,"raw":"https://raw.githubusercontent.com/VicenteBurchard/py3SEB/c89b70e0f95d21338b65efc9cbbf90aac70ba3a0/py3seb/py3seb.py"},"internal":false,"protocol":"github","key":"Z0XjbYV09Q"}],"key":"JGRFOBYkeN"}],"class":"dropdown","key":"bEdcjo0Z2S"}],"key":"FEn2zoAI35"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from py3seb import py3seb\n\n# We need to define the leaf spectral properties for grapevine and cover crop. For simplicity we can just replicate the same values for both\nrho_leaf_vis_vine = 0.054\nrho_leaf_vis_cc = 0.054\nrho_leaf_nir_vine = 0.262\nrho_leaf_nir_cc = 0.262\ntau_leaf_vis_vine = 0.038\ntau_leaf_vis_cc = 0.038\ntau_leaf_nir_vine = 0.333\ntau_leaf_nir_cc = 0.333\nrho_soil_vis = 0.07\nrho_soil_nir = 0.32\n\n# Thermal spectra\ne_vine = 0.99  # Leaf emissivity\ne_cc = 0.99  # Leaf emissivity\ne_s = 0.94  # Soil emissivity\n\n# Estimates the direct and diffuse solar radiation\ndifvis, difnir, fvis, fnir = TSEB.rad.calc_difuse_ratio(ec[\"SW_IN\"].values,\n                                                        sza,\n                                                        press=np.full_like(sza, 1013.15))\npar_dir = fvis * (1. - difvis) * ec[\"SW_IN\"].values\nnir_dir = fnir * (1. - difnir) * ec[\"SW_IN\"].values\npar_dif = fvis * difvis * ec[\"SW_IN\"].values\nnir_dif = fnir * difnir * ec[\"SW_IN\"].values\n\n# net radiation transmission through the three sources\nsn_vine_3seb, sn_s_3seb, sn_cc_3seb = py3seb.calc_Sn_Campbell(lai_vine, \n                                                              lai_cc, \n                                                              sza, \n                                                              par_dir + nir_dir, \n                                                              par_dif + nir_dif, \n                                                              fvis, \n                                                              fnir,\n                                                              np.full_like(lai_vine, rho_leaf_vis_vine),\n                                                              np.full_like(lai_cc, rho_leaf_vis_cc),\n                                                              np.full_like(lai_vine, tau_leaf_vis_vine),\n                                                              np.full_like(lai_cc, tau_leaf_vis_cc),\n                                                              np.full_like(lai_vine, rho_leaf_nir_vine),\n                                                              np.full_like(lai_cc, rho_leaf_nir_cc),\n                                                              np.full_like(lai_vine, tau_leaf_nir_vine),\n                                                              np.full_like(lai_vine, tau_leaf_nir_cc),\n                                                              np.full_like(lai_vine, rho_soil_vis),\n                                                              np.full_like(lai_vine, rho_soil_nir), \n                                                              h_c_vine, \n                                                              h_c_vine * hb_ratio_vine, \n                                                              w_c_vine, \n                                                              f_c_vine,\n                                                              x_LAD=1, \n                                                              x_LAD_sub=1, \n                                                              LAI_eff=lai_eff_vine,\n                                                              LAI_eff_sub=lai_cc)\n\nsn_vine_3seb[~np.isfinite(sn_vine_3seb)] = 0\nsn_s_3seb[~np.isfinite(sn_s_3seb)] = 0\nsn_cc_3seb[~np.isfinite(sn_cc_3seb)] = 0\nprint('Done!')","visibility":"show","key":"bNCacba9U4"},{"type":"output","id":"Lw7K7lsW2lR595iVWTswQ","data":[],"visibility":"show","key":"NT3uSxCqQb"}],"visibility":"show","key":"tDDyacMgfF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evaluate net shortwave radiation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oGFLee8ZU0"}],"identifier":"evaluate-net-shortwave-radiation","label":"Evaluate net shortwave radiation","html_id":"evaluate-net-shortwave-radiation","implicit":true,"key":"EafIDyPGfU"}],"key":"YWRm7sBbDg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from model_evaluation import double_collocation as dc\ndaytime = ec[\"SW_IN\"] > 100\n\nsn_3seb = sn_vine_3seb + sn_s_3seb + sn_cc_3seb\nsn_obs = ec[\"SW_IN\"].values - ec[\"SW_OUT\"].values\n\nfig = go.Figure()\nfig.add_trace(go.Scattergl(x=sn_3seb[daytime], y=sn_obs[daytime], \n                         name=\"Sn for row crops\", mode=\"markers\"))\nfig.add_trace(go.Scatter(x=[0, 1000], y=[0, 1000], mode=\"lines\", name=\"1:1 line\", line={\"color\": \"black\", \"dash\": \"dash\"}))\nfig.update_layout(title_text=f\"Observed vs. Estimated below net radiation at {w_site.label}\",\n                  yaxis_range=[0, 1000], xaxis_range=[0, 1000],\n                  xaxis_title=\"Estimated (W m-2)\", yaxis_title=\"Observed (W m-2)\")","key":"PVXpBLGyph"},{"type":"output","id":"Mxkp6KX3V17HYdV6jy113","data":[],"key":"HjwD5aY0XE"}],"key":"JtnF6LqEAL"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Estimate surface roughness","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SSzi94sBem"}],"identifier":"estimate-surface-roughness","label":"Estimate surface roughness","html_id":"estimate-surface-roughness","implicit":true,"key":"JAeL4jClJi"}],"visibility":"show","key":"ZAfISzN8pK"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Roughness for bare soil\nz0_soil = 0.15\n\n# grapevine\n# =========\nz_0m_vine, d_0_vine = TSEB.res.calc_roughness(lai_vine, h_c_vine, w_c_ratio_vine,\n                                              np.ones(lai_vine.shape) * TSEB.res.BROADLEAVED_D,\n                                              f_c=f_c_vine)\n# Ensure realistic values\nd_0_vine[d_0_vine < 0] = 0\nz_0m_vine[np.isnan(z_0m_vine)] = z0_soil\nz_0m_vine[z_0m_vine < z0_soil] = z0_soil\n\n# cover crop\n# ==========\nz_0m_cc, d_0_cc = TSEB.res.calc_roughness(lai_cc, h_c_cc, w_c_ratio_cc,\n                                          np.ones(lai_cc.shape) * TSEB.res.GRASS,\n                                          f_c=f_c_cc)\n\n# Ensure realistic values\nd_0_cc[d_0_cc < 0] = 0\nz_0m_cc[np.isnan(z_0m_cc)] = z0_soil\nz_0m_cc[z_0m_cc < z0_soil] = z0_soil\nprint('Done!')","visibility":"show","key":"bqJNCvpGNk"},{"type":"output","id":"ym4x7a99syU7KDJ75uy-9","data":[],"visibility":"show","key":"ZFxz4TeSxl"}],"visibility":"show","key":"WLjjCzFxWq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"TSEB/3SEB processing options and model parameters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cfJuVp4shJ"}],"identifier":"tseb-3seb-processing-options-and-model-parameters","label":"TSEB/3SEB processing options and model parameters","html_id":"tseb-3seb-processing-options-and-model-parameters","implicit":true,"key":"XNywTxr4Mz"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In this section, we set-up some processing options related to how we want to run 3SEB, including assigning some values to constant ancillary parameters. These are the same as those set-up to run pyTSEB","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bxADx4z4Vn"}],"key":"rKDolsdAcm"}],"key":"TMmafYoacH"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"alpha_PT_0 = 1.26\n\n# Grapevine and cover crop leaf width (m)\nleaf_width_vine = 0.10\nleaf_width_cc = 0.01\n\n# Kustas and Norman boundary layer resistance parameters\nroil_resistance_c_param = 0.0038\nroil_resistance_b_param = 0.012\nroil_resistance_cprime_param = 90.\n\n# Thermal spectra\ne_v = 0.99  # Leaf vine emissivity\ne_cc = 0.99   # Leaf crop emissivity\ne_s = 0.94  # Soil emissivity","visibility":"show","key":"mr0nJ05xAx"},{"type":"output","id":"7KuYYDifHD45HL9W3Ss5E","data":[],"visibility":"show","key":"zF94MTp66F"}],"visibility":"show","key":"Q8UeD0ruFt"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We derive the half-hourly LST based on pyrgeomters on the EC tower","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tmYdHEaTSq"}],"identifier":"we-derive-the-half-hourly-lst-based-on-pyrgeomters-on-the-ec-tower","label":"We derive the half-hourly LST based on pyrgeomters on the EC tower","html_id":"we-derive-the-half-hourly-lst-based-on-pyrgeomters-on-the-ec-tower","implicit":true,"key":"UHLdJTVCVm"}],"visibility":"show","key":"USg0AOZ74r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Surface emissivity\ne_surf = f_c_vine * e_v + (1. - f_c_vine) * e_s\n\n# LST from longwave radiometers\nlst = ((ec['LW_OUT'].values - (1. - e_surf) * ec['LW_IN'].values) / (\n        TSEB.rad.SB * e_surf)) ** 0.25\n\n# And it is assuming that the radiometer is looking at nadir\nvza = np.zeros_like(lst)","key":"Hd5yVCuY8j"},{"type":"output","id":"y1bPFaDawolyU_HFEbc1J","data":[],"key":"sOLw6czJCm"}],"key":"ayamiiArn1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run 3SEB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HSwxLvI5Ru"}],"identifier":"run-3seb","label":"Run 3SEB","html_id":"run-3seb","implicit":true,"key":"Nvq3Oc9CJy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We are now finally ready to run 3SEB","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IFpW3yS9fZ"}],"key":"mGi9EdwPN5"},{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"See Also","key":"VyFkD8FWbz"}],"key":"Te4in428gh"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The full code for the Shuttleworth and Wallace model is at the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"h7GSbt3k5j"},{"type":"link","url":"https://github.com/VicenteBurchard/py3SEB/blob/c89b70e0f95d21338b65efc9cbbf90aac70ba3a0/py3seb/py3seb.py#L58","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"3SEB GitHub repository","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wZneS3Ex9S"}],"urlSource":"https://github.com/VicenteBurchard/py3SEB/blob/c89b70e0f95d21338b65efc9cbbf90aac70ba3a0/py3seb/py3seb.py#L58","data":{"kind":"file","org":"VicenteBurchard","repo":"py3SEB","reference":"c89b70e0f95d21338b65efc9cbbf90aac70ba3a0","file":"py3seb/py3seb.py","from":58,"raw":"https://raw.githubusercontent.com/VicenteBurchard/py3SEB/c89b70e0f95d21338b65efc9cbbf90aac70ba3a0/py3seb/py3seb.py"},"internal":false,"protocol":"github","key":"PmIqLYQ1ml"}],"key":"DSl82tCPuN"}],"class":"dropdown","key":"lnZGau62mU"}],"key":"FHTHtNACMn"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"resistance_flag = [0, {\"KN_c\": np.full_like(lst, roil_resistance_c_param),\n                       \"KN_b\": np.full_like(lst, roil_resistance_b_param),\n                       \"KN_C_dash\": np.full_like(lst, roil_resistance_cprime_param)}]\n\n# Run 3SEB\n[flag_3seb, t_s_3seb, t_vine_3seb, t_cc_3seb, t_ac_3seb, ln_sub_3seb, ln_vine_3seb, \n ln_cc_3seb, ln_s_3seb, le_vine_3seb, h_vine_3seb, le_cc_3seb, h_cc_3seb,\n le_s_3seb, h_s_3seb, g_3seb, r_s_3seb, r_sub_3seb, r_x_3seb, r_a_3seb, u_friction_3seb, \n l_mo_3seb, n_iterations_3seb] = py3seb.ThreeSEB_PT(lst,\n                                                    vza,\n                                                    ec[\"TA\"].values,\n                                                    ec[\"WS\"].values,\n                                                    ec[\"EA\"].values,\n                                                    ec[\"PA\"].values,\n                                                    sn_vine_3seb,\n                                                    sn_s_3seb,\n                                                    sn_cc_3seb,\n                                                    ec[\"LW_IN\"].values,\n                                                    lai_vine,\n                                                    lai_cc,\n                                                    h_c_vine,\n                                                    h_c_cc,\n                                                    e_vine,\n                                                    e_cc,\n                                                    e_s,\n                                                    z_0m_vine,\n                                                    z_0m_cc,\n                                                    d_0_vine,\n                                                    d_0_cc,\n                                                    zm,\n                                                    zh,\n                                                    leaf_width=leaf_width_vine,\n                                                    leaf_width_sub=leaf_width_cc,\n                                                    f_c=f_c_vine,\n                                                    f_c_sub=f_c_cc,\n                                                    f_g=fg_vine,\n                                                    f_g_sub=fg_cc,\n                                                    calcG_params=[[1], 0.35],\n                                                    resistance_form=resistance_flag)\n\n# ... and finally we compute the bulk fluxes\nle_3seb = le_vine_3seb + le_cc_3seb + le_s_3seb\nh_3seb = h_vine_3seb + h_cc_3seb + h_s_3seb\nnetrad_3seb = sn_vine_3seb + sn_cc_3seb + sn_s_3seb + ln_vine_3seb + ln_cc_3seb + ln_s_3seb","visibility":"show","key":"MELnPApaUK"},{"type":"output","id":"HhMS2rIcusligucaLY2ad","data":[],"visibility":"show","key":"pWmLrOiOH7"}],"visibility":"show","key":"O2egJrXe9i"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run TSEB-PT for comparison","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sN9wAPFaBO"}],"identifier":"run-tseb-pt-for-comparison","label":"Run TSEB-PT for comparison","html_id":"run-tseb-pt-for-comparison","implicit":true,"key":"S2n9MLKvlv"}],"key":"RFco9kPkOJ"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Compute the canopy and soil net radiation using Cambpell RTM\nsn_c, sn_s = TSEB.rad.calc_Sn_Campbell(ec[\"LAI\"].values,\n                                       sza,\n                                       par_dir + nir_dir,\n                                       par_dif + nir_dif,\n                                       fvis,\n                                       fnir,\n                                       np.full_like(sza, rho_leaf_vis_vine),\n                                       np.full_like(sza, tau_leaf_vis_vine),\n                                       np.full_like(sza, rho_leaf_nir_vine),\n                                       np.full_like(sza, tau_leaf_nir_vine),\n                                       np.full_like(sza, rho_soil_vis),\n                                       np.full_like(sza, rho_soil_nir),\n                                       x_LAD=1,\n                                       LAI_eff=lai_eff_vine)\n\nsn_c[~np.isfinite(sn_c)] = 0\nsn_s[~np.isfinite(sn_s)] = 0\n\n# TSEB-PT\n[flag_pt, ts_pt, tc_pt, t_ac_pt, ln_s_pt, ln_c_pt, le_c_pt, h_c_pt, le_s_pt, h_s_pt, g_pt,\n r_s_pt, r_x_pt, r_a_pt, u_friction_pt, lmo_pt, n_iterations_pt] = TSEB.TSEB_PT(                                                     \n     lst,\n     vza,\n     ec[\"TA\"].values,\n     ec[\"WS\"].values,\n     ec[\"EA\"].values,\n     ec[\"PA\"].values,\n     sn_c,\n     sn_s,\n     ec[\"LW_IN\"].values,\n     ec[\"LAI\"].values,\n     h_c_vine,\n     e_vine,\n     e_s,\n     z_0m_vine,\n     d_0_vine,\n     zm,\n     zh,\n     x_LAD=np.ones_like(lst),\n     f_c=f_c_vine,\n     f_g=fg_vine,\n     w_C=w_c_ratio_vine,\n     leaf_width=leaf_width_vine,\n     z0_soil=z0_soil,\n     alpha_PT=alpha_PT_0,\n     resistance_form=resistance_flag,\n     calcG_params=[[1], 0.35])\n\n# ... and we compute the bulk fluxes\nle_pt = le_c_pt + le_s_pt\nh_pt = h_c_pt + h_s_pt\nnetrad_pt = sn_c + sn_s + ln_c_pt + ln_s_pt","visibility":"show","key":"lxTo1nRYmu"},{"type":"output","id":"s4UYoBFWQfAfnOS-DnhLg","data":[],"visibility":"show","key":"YpeD1LMiDV"}],"visibility":"show","key":"yZi37y4E19"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Model evaluation and visualization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZFg430cYPg"}],"identifier":"model-evaluation-and-visualization","label":"Model evaluation and visualization","html_id":"model-evaluation-and-visualization","implicit":true,"key":"oob21Mvqii"},{"type":"heading","depth":3,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Evaluate model fluxes at half-hourly scale","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"W0u1Xy67fl"}],"identifier":"evaluate-model-fluxes-at-half-hourly-scale","label":"Evaluate model fluxes at half-hourly scale","html_id":"evaluate-model-fluxes-at-half-hourly-scale","implicit":true,"key":"djNJ9WmsLo"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Here, we will first create a scatter plot to evaluate how the modelled fluxes (LE, H, Rn, and G) compare to those measured by the EC tower. We will assess daytime fluxes (i.e. shortwave irradiance > 100 W/m2).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dHgbxMCI9g"}],"key":"eK4OiS7lR2"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Select which method of EB correction you want to apply during the validation and which year you want to evaluate (considering that cover crop might not be present in all years):","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JfPJO278zi"}],"key":"wpLDe6nU01"}],"visibility":"show","key":"Wyhg5jCW0P"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"w_ebc = widgets.Dropdown(\n    options=[('No EB correction', (\"LE\", \"H\")), \n             ('Residual to LE', (\"LE_RES\", \"H\")), \n             ('Residual to H', (\"LE_RES\", \"H\")), \n             ('Bowen Ratio', (\"LE_BR\", \"H_BR\")),\n             ('Ensemble correction', (\"LE_ENS\", \"H_ENS\"))],\n    value=(\"LE_ENS\", \"H_ENS\"),\n    description='EBC method:',\n)\n\nyears = np.unique(ec[\"TIMESTAMP\"].dt.year)\nw_year = widgets.Dropdown(\n    options=years,\n    value=2019,\n    description='Select year:',\n)\n\ndisplay(w_ebc, w_year)","visibility":"show","key":"k1jG8MKs4j"},{"type":"output","id":"Qa-BLz14o0OZ6yZY5SUG0","data":[],"visibility":"show","key":"CRjhsy2Umz"}],"visibility":"show","key":"jp9r343q0w"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from tabulate import tabulate\n\nLE_OBS, H_OBS = w_ebc.value\nprint(f\"Using {LE_OBS} and {H_OBS} fields for validating respectively  LE and H\")\n\ndaytime = ec[\"SW_IN\"] > 100\nvalid_3seb = np.logical_and(flag_3seb < 5, daytime, ec[\"TIMESTAMP\"].dt.year == w_year.value)\nvalid_pt = np.logical_and(flag_pt < 5, daytime)\n\nle_marker = {\"color\": \"blue\", \"size\": 3}\nh_marker = {\"color\": \"red\", \"size\": 3}\ng_marker = {\"color\": \"green\", \"size\": 3}\nrn_marker = {\"color\": \"black\", \"size\": 3}\n\nfig = make_subplots(rows=1, cols=2,\n                    shared_yaxes=True,\n                    horizontal_spacing=0.01,\n                    subplot_titles=[\"3SEB\", \"TSEB-PT\"])\n\nfig.add_trace(go.Scattergl(x=netrad_3seb[valid_3seb], y=ec.loc[valid_3seb, \"NETRAD\"], \n                         name=\"Rn 3SEB\", mode=\"markers\", marker=rn_marker),\n             row=1, col=1)\n\nfig.add_trace(go.Scattergl(x=netrad_pt[valid_pt], y=ec.loc[valid_pt, \"NETRAD\"], \n                         name=\"Rn TSEB-PT\", mode=\"markers\", marker=rn_marker),\n             row=1, col=2)\n\nfig.add_trace(go.Scattergl(x=g_3seb[valid_3seb], y=ec.loc[valid_3seb, \"G\"], \n                         name=\"G 3SEB\", mode=\"markers\", marker=g_marker),\n             row=1, col=1)\n\nfig.add_trace(go.Scattergl(x=g_pt[valid_pt], y=ec.loc[valid_pt, \"G\"], \n                         name=\"G TSEB-PT\", mode=\"markers\", marker=g_marker),\n             row=1, col=2)\n\nfig.add_trace(go.Scattergl(x=le_3seb[valid_3seb], y=ec.loc[valid_3seb, LE_OBS], \n                         name=\"LE 3SEB\", mode=\"markers\", marker=le_marker),\n             row=1, col=1)\n\nfig.add_trace(go.Scattergl(x=le_pt[valid_pt], y=ec.loc[valid_pt, LE_OBS], \n                         name=\"LE TSEB-PT\", mode=\"markers\", marker=le_marker),\n             row=1, col=2)\n\nfig.add_trace(go.Scattergl(x=h_3seb[valid_3seb], y=ec.loc[valid_3seb, H_OBS], \n                         name=\"H 3SEB\", mode=\"markers\", marker=h_marker),\n             row=1, col=1)\n\nfig.add_trace(go.Scattergl(x=h_pt[valid_pt], y=ec.loc[valid_pt, H_OBS], \n                         name=\"H TSEB-PT\", mode=\"markers\", marker=h_marker),\n             row=1, col=2)\n\nfig.add_trace(go.Scatter(x=[-200, 800], y=[-200, 800], mode=\"lines\", name=\"1:1 line\", line={\"color\": \"black\", \"dash\": \"dash\"}),\n             row=1, col=1)\nfig.add_trace(go.Scatter(x=[-200, 800], y=[-200, 800], mode=\"lines\", name=\"1:1 line\", line={\"color\": \"black\", \"dash\": \"dash\"}),\n             row=1, col=2)\n\n\nfig.update_layout(title_text=f\"Observed vs. Estimated hourly turbulent fluxes at {w_site.label}\",\n                  yaxis_range=[-200, 800], xaxis_range=[-200, 800], \n                  xaxis_title=\"Estimated (W m-2)\", yaxis_title=\"Observed (W m-2)\")\nfig.update_xaxes(title_text=\"Estimated (W m-2)\", row=1, col=2)","visibility":"show","key":"tjvGBM8S9f"},{"type":"output","id":"Y5Vs0S0oIDenYmZzZg6Sv","data":[],"visibility":"show","key":"GPd66vx4Rn"}],"visibility":"show","key":"cD3qHmJaxg"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"LE partitioning evaluation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uxSsZFQJ7Q"}],"identifier":"le-partitioning-evaluation","label":"LE partitioning evaluation","html_id":"le-partitioning-evaluation","implicit":true,"key":"XWrh0jrUZn"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We will now compare the partitioning of LE from vegetation sources (i.e. transpiration) derived from 3SEB (i.e. LEvine + LEcc) compared to the those measured from the EC flux towers using the ensemble of CEC, REA and FVS approaches ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VCSPzMSwAz"},{"type":"citeGroup","kind":"parenthetical","children":[{"type":"cite","kind":"parenthetical","label":"Zahn_2022","identifier":"https://doi.org/10.1016/j.agrformet.2021.108790","children":[{"type":"text","value":"Zahn ","key":"auJ1eblxfP"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"uNwfaSPvUO"}],"key":"yRmJ8RqsQX"},{"type":"text","value":", 2022","key":"zLtZ4iOIfT"}],"enumerator":"7","key":"fQjVCgBdWt"}],"key":"QbL9fgChtf"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"CWWqhkyKYu"}],"key":"ZENn0yxV7P"}],"visibility":"show","key":"JbR9hbPwdT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ec[\"LE_C\"] = np.nanmean(ec[[\"LE_C_ECC\", \"LE_C_REA\", \"LE_C_FVS\"]], axis=1)\n\nle_c_3seb = le_vine_3seb + le_cc_3seb\n\nfig = make_subplots(rows=1, cols=2,\n                    shared_yaxes=True,\n                    horizontal_spacing=0.01,\n                   subplot_titles=(\"3SEB\", \"TSEB-PT\"))\n\nfig.add_trace(go.Scattergl(x=le_c_3seb[valid_3seb], y=ec.loc[valid_3seb, \"LE_C\"], \n                         name=\"LE_C 3SEB\", mode=\"markers\", marker=le_marker),\n             row=1, col=1)\n\nfig.add_trace(go.Scattergl(x=le_c_pt[valid_pt], y=ec.loc[valid_pt, \"LE_C\"], \n                         name=\"LE TSEB-PT\", mode=\"markers\", marker=le_marker),\n             row=1, col=2)\n\nfig.add_trace(go.Scatter(x=[-200, 800], y=[-200, 800], mode=\"lines\", name=\"1:1 line\", line={\"color\": \"black\", \"dash\": \"dash\"}),\n             row=1, col=1)\nfig.add_trace(go.Scatter(x=[-200, 800], y=[-200, 800], mode=\"lines\", name=\"1:1 line\", line={\"color\": \"black\", \"dash\": \"dash\"}),\n             row=1, col=2)\n\n\nfig.update_layout(title_text=f\"Observed vs. Estimated hourly canopy latent heat flux {w_site.label}\",\n                  yaxis_range=[-200, 800], xaxis_range=[-200, 800], \n                  xaxis_title=\"Estimated (W m-2)\", yaxis_title=\"Observed (W m-2)\")\n\nfig.update_xaxes(title_text=\"Estimated (W m-2)\", row=1, col=2)","key":"JwmFGhEmjK"},{"type":"output","id":"74MTw9Iugu3WkRL7sGpv1","data":[],"key":"Chsrns3Vdd"}],"key":"ZFuQ1aZEQb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Save outputs to an ASCII table","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vBGQwXJtil"}],"identifier":"save-outputs-to-an-ascii-table","label":"Save outputs to an ASCII table","html_id":"save-outputs-to-an-ascii-table","implicit":true,"key":"NzS7sFMDIV"}],"key":"jvOH9DMifU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Define the output filename\nout_dir = Path().absolute() / \"output\"\noutfile = out_dir / f\"FLX_US-{w_site.value}_FLUXNET2015_3SEB-ROWS_HR.csv\"\n\n# Create the output folder in case it does not exist\nif not out_dir.exists():\n    out_dir.mkdir(parents=True)\n\nle_3seb = le_vine_3seb + le_cc_3seb + le_s_3seb\nh_3seb = h_vine_3seb + h_cc_3seb + h_s_3seb\nnetrad_3seb = sn_vine_3seb + sn_cc_3seb + sn_s_3seb + ln_vine_3seb + ln_cc_3seb + ln_s_3seb\n# Convert the outputs to a Python dictionary\noutdict = {\"TIMESTAMP\": ec[\"TIMESTAMP\"].dt.strftime(\"%Y%m%d%H%M\"),\n           \"FLAG_3SEB\": flag_3seb, \"LE_3SEB\": le_3seb, \"H_3SEB\": h_3seb, \"NETRAD_3SEB\": netrad_3seb, \"G_3SEB\": g_3seb, \n           \"T_S_3SEB\": t_s_3seb, \"T_CC_3SEB\": t_cc_3seb, \"T_VINE_3SEB\": t_vine_3seb, \"T_AC_3SEB\": t_ac_3seb, \n           \"LN_S_3SEB\": ln_s_3seb, \"LN_CC_3SEB\": ln_cc_3seb, \"LN_VINE_3SEB\": ln_vine_3seb, \"LE_CC_3SEB\": le_cc_3seb, \"H_CC_3SEB\": h_cc_3seb, \n           \"LE_S_3SEB\": le_s_3seb, \"H_S_3SEB\": h_s_3seb, \"LE_VINE_3SEB\": le_vine_3seb, \"H_VINE_3SEB\": h_vine_3seb, \n           \"R_S_3SEB\": r_s_3seb, \"R_SUB_3SEB\": r_sub_3seb, \"R_X_3SEB\": r_x_3seb, \"R_A_3SEB\": r_a_3seb, \"USTAR_3SEB\": u_friction_3seb, \n           \"L_MO_3SEB\":l_mo_3seb, \"ITERATIONS_3SEB\": n_iterations_3seb}\n\n# Crete the output dataframe and save it to csv\npd.DataFrame(outdict).to_csv(outfile, sep=\";\", na_rep=-9999, index=False)\nprint(f\"Saved to {outfile}\")\n\noutfile = out_dir / f\"FLX_US-{w_site.value}_FLUXNET2015_TSEB-PT-ROWS_HR.csv\"\n\n# Convert the outputs to a Python dictionary\noutdict = {\"TIMESTAMP\": ec[\"TIMESTAMP\"].dt.strftime(\"%Y%m%d%H%M\"),\n           \"FLAG_TSEBPT\": flag_pt, \"LE_TSEBPT\": le_pt, \"H_TSEBPT\": h_pt, \"NETRAD_TSEBPT\": netrad_pt, \"G_TSEBPT\": g_pt, \n           \"T_S_TSEBPT\": ts_pt, \"T_C_TSEBPT\": tc_pt, \"T_AC_TSEBPT\": t_ac_pt, \"LN_S_TSEBPT\": ln_s_pt, \"LN_C_TSEBPT\": ln_c_pt, \n           \"LE_C_TSEBPT\": le_c_pt, \"H_C_TSEBPT\": h_c_pt, \"LE_S_TSEBPT\": le_s_pt, \"H_S_TSEBPT\": h_s_pt, \"R_S_TSEBPT\": r_s_pt, \n           \"R_X_TSEBPT\": r_x_pt, \"R_A_TSEBPT\": r_a_pt, \"USTAR_TSEBPT\": u_friction_pt, \"L_MO_TSEBPT\":lmo_pt, \n           \"ITERATIONS_TSEBPT\": n_iterations_pt}\n\n# Crete the output dataframe and save it to csv\npd.DataFrame(outdict).to_csv(outfile, sep=\";\", na_rep=-9999, index=False)\nprint(f\"Saved to {outfile}\")\n","key":"zAC62t0pN8"},{"type":"output","id":"8FmlS1xXPkujSiBGmL525","data":[],"key":"rvx9wc3gWJ"}],"key":"eVU8gHoaKa"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Annual ET accounting","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cQUuKqv4Ld"}],"identifier":"annual-et-accounting","label":"Annual ET accounting","html_id":"annual-et-accounting","implicit":true,"key":"UfwUjPY8Ul"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"One of the advantages of the 3SEB model is the ability to separate the flux contributions of the different vegetation (+soil) sources. In this section, we will check how much each source (vine, cover crop and soil) contribute to the total ET and account for their annual water use.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"LinCSBS03u"}],"key":"z703Iu7mHF"}],"key":"PN0nTz1MFu"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Instantaneous to daily","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xAqm2y7SAI"}],"identifier":"instantaneous-to-daily","label":"Instantaneous to daily","html_id":"instantaneous-to-daily","implicit":true,"key":"MrVeSGZvcU"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We will first convert the instantaneous fluxes to daily, instead of aggregating all hourly 3SEB estimates we will upscale a single estimate (assuming it was obtained by a satellite overpass to daily).","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ExMn8XkoAN"}],"key":"RwQLZJ8atc"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We will use the solar irradiance upscaling method, that assumes that the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"p2R1kXNC8V"},{"type":"inlineMath","value":"\\lambda E/ S^\\downarrow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mi>E</mi><mi mathvariant=\"normal\">/</mi><msup><mi>S</mi><mo>↓</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\lambda E/ S^\\downarrow</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0991em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mrel mtight\">↓</span></span></span></span></span></span></span></span></span></span></span>","key":"jYtkZhYsBS"},{"type":"text","value":" ratio is preserved. Therefore, the daily latent heat fluxes are obtained as:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xUXSKN1sgv"}],"key":"LOOl61T78d"},{"type":"math","value":"\\lambda E_{daily} = S^\\downarrow_{daily} \\frac{\\lambda E_{inst.}}{S^\\downarrow_{inst.}}","label":"daily_et","identifier":"daily_et","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>λ</mi><msub><mi>E</mi><mrow><mi>d</mi><mi>a</mi><mi>i</mi><mi>l</mi><mi>y</mi></mrow></msub><mo>=</mo><msubsup><mi>S</mi><mrow><mi>d</mi><mi>a</mi><mi>i</mi><mi>l</mi><mi>y</mi></mrow><mo>↓</mo></msubsup><mfrac><mrow><mi>λ</mi><msub><mi>E</mi><mrow><mi>i</mi><mi>n</mi><mi>s</mi><mi>t</mi><mi mathvariant=\"normal\">.</mi></mrow></msub></mrow><msubsup><mi>S</mi><mrow><mi>i</mi><mi>n</mi><mi>s</mi><mi>t</mi><mi mathvariant=\"normal\">.</mi></mrow><mo>↓</mo></msubsup></mfrac></mrow><annotation encoding=\"application/x-tex\">\\lambda E_{daily} = S^\\downarrow_{daily} \\frac{\\lambda E_{inst.}}{S^\\downarrow_{inst.}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">ai</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.5053em;vertical-align:-1.1339em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.967em;\"><span style=\"top:-2.3987em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">ai</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span style=\"top:-3.1809em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mrel mtight\">↓</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4374em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.143em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.967em;\"><span style=\"top:-2.4231em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">in</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mtight\">.</span></span></span></span><span style=\"top:-3.1809em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mrel mtight\">↓</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2769em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">in</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mtight\">.</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1339em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"4","html_id":"daily-et","key":"p2mEPQvMl1"}],"key":"PW9Z9uAhw1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set the local time of satellie overpass in decimal hours\noverpass = 10.5\n\n\n# Aggregate hourly irradiance and temporature to daily means\nec_daily = ec.groupby(ec[\"TIMESTAMP\"].dt.date)\nec_daily = ec_daily[[\"SW_IN\", \"TA\"]].mean().reset_index()\n# Select only the year of interest\nec_daily[\"TIMESTAMP\"] = pd.to_datetime(ec_daily[\"TIMESTAMP\"])\nec_daily = ec_daily.loc[ec_daily[\"TIMESTAMP\"].dt.year == w_year.value]\n\n# Select only the year of interest and overpass time for instantaneous estimates\nvalid = np.logical_and(ec[\"TIMESTAMP\"].dt.hour + ec[\"TIMESTAMP\"].dt.minute / 60 == overpass,\n                       ec[\"TIMESTAMP\"].dt.year == w_year.value)\n\nle_ratio = le_3seb[valid] / ec.loc[valid, \"SW_IN\"].values\nle_daily = le_ratio * ec_daily[\"SW_IN\"].values\n\nle_vine_ratio = le_vine_3seb[valid] / ec.loc[valid, \"SW_IN\"].values\nle_vine_daily = le_vine_ratio * ec_daily[\"SW_IN\"].values\n\nle_cc_ratio = le_cc_3seb[valid] / ec.loc[valid, \"SW_IN\"].values\nle_cc_daily = le_cc_ratio * ec_daily[\"SW_IN\"].values\n\nle_s_ratio = le_s_3seb[valid] / ec.loc[valid, \"SW_IN\"].values\nle_s_daily = le_s_ratio * ec_daily[\"SW_IN\"].values\n\n# convert to mm/day\net_daily = TSEB.met.flux_2_evaporation(le_daily, time_domain=24, t_k=ec_daily[\"TA\"].values)\net_vine_daily = TSEB.met.flux_2_evaporation(le_vine_daily, time_domain=24, t_k=ec_daily[\"TA\"].values)\net_cc_daily = TSEB.met.flux_2_evaporation(le_cc_daily, time_domain=24, t_k=ec_daily[\"TA\"].values)\net_s_daily = TSEB.met.flux_2_evaporation(le_s_daily, time_domain=24, t_k=ec_daily[\"TA\"].values)\n\n# get annual sums \net_annual = np.nansum(et_daily)\net_vine_annual = np.nansum(et_vine_daily)\net_cc_annual = np.nansum(et_cc_daily)\net_soil_annual = np.nansum(et_s_daily)\n\n%matplotlib inline\nfrom matplotlib import pyplot as plt\n# plot annual bar and pie chart for water accounting of each ET source \nfig, (ax1, ax2) = plt.subplots(nrows=1, ncols=2, figsize=(14, 6), dpi=300)\n# labels\net_sources = ['$ET_{total}$', '$T_{vine}$', '$T_{cc}$', '$E_{soil}$']\n# values\net_values = [et_annual, et_vine_annual, et_cc_annual, et_soil_annual]\n# relative contribution for pie chart\nratios = [et_vine_annual/et_annual, et_cc_annual/et_annual, et_soil_annual/et_annual]\n# colors for each source\ncolors = ['black', 'seagreen', 'steelblue', 'peru']\n# bar chart\nax1.bar(et_sources, et_values, color=colors)\nax1.set_ylabel('ET (mm/day)', fontsize=20)\nax1.set_title('Annual water use (mm/year)', fontsize=22)\n# pie chart\nax2.pie(ratios, labels=et_sources[1:], colors = colors[1:], autopct='%1.1f%%')\nax2.set_title('Relative water use (%)', fontsize=22)\n\nplt.show()","key":"hkhScQnBgc"},{"type":"output","id":"nDqnMhJEIOgpY4wCd-agB","data":[],"key":"QURjBUdv7H"}],"key":"nW2aopxNQJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Conclusions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ns5wfhbjVO"}],"identifier":"conclusions","label":"Conclusions","html_id":"conclusions","implicit":true,"key":"LjM6izEXHQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"3SEB presents the advantage of partitioning fluxes from two distict coexisting canopies, one sparse overstory and another rather horizontally homogenous understory.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RKcbOiqOGf"}],"key":"WhbO7gB5xY"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"As compared to TSEB, it requires basically the same inputs plus an estimate of LAI separation between the overstory and the understory. With some knowledge of phenology of both layers, it is doable to make such separation","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"COB2pYFV0r"}],"key":"eNcQLnx4gA"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The improvement of 3SEB over TSEB is only evident when both layers are coexisting and actively transpiring. Otherwise TSEB could be used instead due to its greater simplicity.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cGkdthNzFc"}],"key":"ILjjH533TR"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"[...]","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rQrhUbBwxe"}],"key":"mxZQJzy91q"}],"key":"xTYPZEzFD1"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"Roji0UrHjG"}],"key":"lG7Pw4HCaF"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Please feel free comment any thoughts. This is work in progress!!!","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qgobbn3Xn4"}],"key":"m9f6S8ntDW"}],"key":"NISTXU8cN2"}],"key":"zP4LYGm0WK"}],"key":"qripUdn2ip"},"references":{"cite":{"order":["Burchard_Levine_2021","Norman_1995","Burchard_Levine_2022","Kang_2022","Nieto_2018","Campbell_1998","Zahn_2022"],"data":{"Burchard_Levine_2021":{"label":"Burchard_Levine_2021","enumerator":"1","doi":"10.1111/gcb.16002","html":"Burchard‐Levine, V., Nieto, H., Riaño, D., Kustas, W. P., Migliavacca, M., El‐Madany, T. S., Nelson, J. A., Andreu, A., Carrara, A., Beringer, J., Baldocchi, D., & Martín, M. P. (2021). A remote sensing‐based three‐source energy balance model to improve global estimations of evapotranspiration in semi‐arid tree‐grass ecosystems. <i>Global Change Biology</i>, <i>28</i>(4), 1493–1515. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1111/gcb.16002\">10.1111/gcb.16002</a>","url":"https://doi.org/10.1111/gcb.16002"},"Norman_1995":{"label":"Norman_1995","enumerator":"2","doi":"10.1016/0168-1923(95)02265-y","html":"Norman, J. M., Kustas, W. P., & Humes, K. S. (1995). Source approach for estimating soil and vegetation energy fluxes in observations of directional radiometric surface temperature. <i>Agricultural and Forest Meteorology</i>, <i>77</i>(3–4), 263–293. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1016/0168-1923(95)02265-y\">10.1016/0168-1923(95)02265-y</a>","url":"https://doi.org/10.1016/0168-1923(95)02265-y"},"Burchard_Levine_2022":{"label":"Burchard_Levine_2022","enumerator":"3","doi":"10.1007/s00271-022-00787-x","html":"Burchard-Levine, V., Nieto, H., Kustas, W. P., Gao, F., Alfieri, J. G., Prueger, J. H., Hipps, L. E., Bambach-Ortiz, N., McElrone, A. J., Castro, S. J., Alsina, M. M., McKee, L. G., Zahn, E., Bou-Zeid, E., & Dokoozlian, N. (2022). Application of a remote-sensing three-source energy balance model to improve evapotranspiration partitioning in vineyards. <i>Irrigation Science</i>, <i>40</i>(4–5), 593–608. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/s00271-022-00787-x\">10.1007/s00271-022-00787-x</a>","url":"https://doi.org/10.1007/s00271-022-00787-x"},"Kang_2022":{"label":"Kang_2022","enumerator":"4","doi":"10.1007/s00271-022-00798-8","html":"Kang, Y., Gao, F., Anderson, M., Kustas, W., Nieto, H., Knipper, K., Yang, Y., White, W., Alfieri, J., Torres-Rua, A., Alsina, M. M., & Karnieli, A. (2022). Evaluation of satellite Leaf Area Index in California vineyards for improving water use estimation. <i>Irrigation Science</i>, <i>40</i>(4–5), 531–551. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/s00271-022-00798-8\">10.1007/s00271-022-00798-8</a>","url":"https://doi.org/10.1007/s00271-022-00798-8"},"Nieto_2018":{"label":"Nieto_2018","enumerator":"5","doi":"10.1007/s00271-018-0611-y","html":"Nieto, H., Kustas, W. P., Alfieri, J. G., Gao, F., Hipps, L. E., Los, S., Prueger, J. H., McKee, L. G., & Anderson, M. C. (2018). Impact of different within-canopy wind attenuation formulations on modelling sensible heat flux using TSEB. <i>Irrigation Science</i>, <i>37</i>(3), 315–331. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/s00271-018-0611-y\">10.1007/s00271-018-0611-y</a>","url":"https://doi.org/10.1007/s00271-018-0611-y"},"Campbell_1998":{"label":"Campbell_1998","enumerator":"6","doi":"10.1007/978-1-4612-1626-1_15","html":"Campbell, G. S., & Norman, J. M. (1998). The Light Environment of Plant Canopies. In <i>An Introduction to Environmental Biophysics</i> (pp. 247–278). Springer New York. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/978-1-4612-1626-1_15\">10.1007/978-1-4612-1626-1_15</a>","url":"https://doi.org/10.1007/978-1-4612-1626-1_15"},"Zahn_2022":{"label":"Zahn_2022","enumerator":"7","doi":"10.1016/j.agrformet.2021.108790","html":"Zahn, E., Bou-Zeid, E., Good, S. P., Katul, G. G., Thomas, C. K., Ghannam, K., Smith, J. A., Chamecki, M., Dias, N. L., Fuentes, J. D., Alfieri, J. G., Kwon, H., Caylor, K. K., Gao, Z., Soderberg, K., Bambach, N. E., Hipps, L. E., Prueger, J. H., & Kustas, W. P. (2022). Direct partitioning of eddy-covariance water and carbon dioxide fluxes into ground and plant components. <i>Agricultural and Forest Meteorology</i>, <i>315</i>, 108790. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1016/j.agrformet.2021.108790\">10.1016/j.agrformet.2021.108790</a>","url":"https://doi.org/10.1016/j.agrformet.2021.108790"}}}}}