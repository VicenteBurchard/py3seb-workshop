{"version":2,"kind":"Notebook","sha256":"6b09e629526428f75b9556f24f56b3ecf2527dc74a97871f67675d2f91b6be63","slug":"b02-tseb-sw","location":"/B02-TSEB-SW.ipynb","dependencies":[],"frontmatter":{"title":"Shuttleworth-Wallace TSEB in advective conditions","short_title":"TSEB-SW","subtitle":"Notebook to evaluate the new TSEB version initialized by the Shuttleworth & Wallace energy combination model","keywords":["TSEB","radiation","Beer-Lambert law","albedo"],"authors":[{"nameParsed":{"literal":"Héctor Nieto","given":"Héctor","family":"Nieto"},"name":"Héctor Nieto","orcid":"0000-0003-4250-6424","email":"hector.nieto@ica.csic.es","affiliations":["Instituto de Ciencias Agrarias, ICA","CSIC"],"id":"contributors-B02-TSEB-SW-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Benjamin Mary","given":"Benjamin","family":"Mary"},"name":"Benjamin Mary","orcid":"0000-0001-7199-2885","affiliations":["Insituto de Ciencias Agrarias","CSIC"],"id":"contributors-B02-TSEB-SW-generated-uid-1"}],"affiliations":[{"id":"Instituto de Ciencias Agrarias, ICA","name":"Instituto de Ciencias Agrarias, ICA"},{"id":"CSIC","name":"CSIC"},{"id":"Insituto de Ciencias Agrarias","name":"Insituto de Ciencias Agrarias"}],"license":{"content":{"id":"CC-BY-SA-4.0","url":"https://creativecommons.org/licenses/by-sa/4.0/","name":"Creative Commons Attribution Share Alike 4.0 International","free":true,"CC":true}},"subject":"Tutorial","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"open_access":false,"github":"https://github.com/VicenteBurchard/py3SEB-workshop","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/VicenteBurchard/py3SEB-workshop/blob/master/B02-TSEB-SW.ipynb","thumbnail":"/shuttleworth_wallace-71e71a6267f609a34302442a4aba9ed1.png","thumbnailOptimized":"/shuttleworth_wallace-71e71a6267f609a34302442a4aba9ed1.webp","exports":[{"format":"ipynb","filename":"B02-TSEB-SW.ipynb","url":"/B02-TSEB-SW-8757f857a73b361257661b57c7238919.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rxBkZEH5sU"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"LCqyQPP3C6"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This interactive Jupyter Notebook has the objective of showing the implemenation of TSEB-SW under advective conditions. It is based on ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fpV0FENOs7"},{"type":"cite","url":"https://doi.org/10.1007/s00271-022-00778-y","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Kustas ","key":"TYVGAZMoRM"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"dnc9pYWTyP"}],"key":"hCbLzuEBDu"},{"type":"text","value":" (2022)","key":"SRDkyPiCp6"}],"kind":"narrative","label":"Kustas_2022","identifier":"https://doi.org/10.1007/s00271-022-00778-y","enumerator":"1","key":"bSuPJC1ZXb"},{"type":"text","value":" and ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jjNh9kjnWn"},{"type":"cite","url":"https://doi.org/10.1007/s00271-022-00790-2","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Nieto ","key":"inwIWRd30d"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"icECnhX9w3"}],"key":"nx69WoLfpC"},{"type":"text","value":" (2022)","key":"pYU8vIie2d"}],"kind":"narrative","label":"Nieto_2022","identifier":"https://doi.org/10.1007/s00271-022-00790-2","enumerator":"2","key":"d7f9s5zCMQ"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hjALOY9P0b"}],"key":"FdQlub63IT"}],"key":"bEXvpPnnw8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Instructions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HUOd7Xyvl8"}],"identifier":"instructions","label":"Instructions","html_id":"instructions","implicit":true,"key":"LuJPSNenmZ"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Read carefully all the text and follow the instructions.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"D3mu3C89YQ"}],"key":"OuBOaMoLQ3"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Once each section is read, run the jupyter code cell underneath (marked as ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"buHopwJ5fb"},{"type":"inlineCode","value":"In []","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"tc8d2xQ2TP"},{"type":"text","value":") by clicking the icon ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"t7zKBbPpd0"},{"type":"inlineCode","value":"Run","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"cEr5HaSYiy"},{"type":"text","value":", or pressing the keys SHIFT+ENTER of your keyboard. A graphical interface will then display, which allows you to interact with and perform the assigned tasks.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vc0apymxT9"}],"key":"KstCsxLLzm"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"To start, please run the following cell to import all the packages required for this notebook. Once you run the cell below, an acknowledgement message, stating all libraries were correctly imported, should be printed on screen.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kRWocDcAlL"}],"key":"T9Y6JaU8aj"}],"key":"VKosjfrN1p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline\nfrom pathlib import Path\nfrom ipywidgets import interact, interactive, fixed, widgets\nfrom IPython.display import display\nfrom functions import radiation_and_available_energy as fn\nimport numpy as np","key":"gn4shOFjGN"},{"type":"output","id":"R8VFmsJN0g95WgwMx4Qsr","data":[],"key":"HS8AR1ohzk"}],"key":"HZPPAOA01c"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Shuttleworth-Wallace model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q3yDWaHkj7"}],"identifier":"shuttleworth-wallace-model","label":"Shuttleworth-Wallace model","html_id":"shuttleworth-wallace-model","implicit":true,"key":"sPvsL4GNHm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The two-source Shuttleworth-Wallace energy combination model ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"x6LdGIcoZI"},{"type":"citeGroup","kind":"parenthetical","children":[{"type":"cite","kind":"parenthetical","label":"Shuttleworth_1985","identifier":"https://doi.org/10.1002/qj.49711146910","children":[{"type":"text","value":"Shuttleworth & Wallace, 1985","key":"n4pEM5flIE"}],"enumerator":"3","key":"jYn5eUElik"}],"key":"CWnXLDXqRp"},{"type":"text","value":" was specifically designed to account for evapotranspiration partitioning in sparse crops. Therefore, both the heat and water fluxes are separated into a soil and canopy layer, with a series of resistances set in series).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BM3U0E9Zoo"}],"key":"ZAi2TFu1wK"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/shuttleworth_wallace-71e71a6267f609a34302442a4aba9ed1.png","alt":"Shuttleworth & Wallace energy combination model","key":"Ra7wPBWvvy","urlSource":"./input/figures/shuttleworth_wallace_model.png","urlOptimized":"/shuttleworth_wallace-71e71a6267f609a34302442a4aba9ed1.webp"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Two-Source energy balance scheme including the transport of both heat (H) and water vapour (","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ihgPDZgHh7"},{"type":"inlineMath","value":"\\lambda E","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span>","key":"q4Ice1SeNU"},{"type":"text","value":"). Adapted from ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ezXp4MDPVO"},{"type":"cite","url":"https://doi.org/10.1002/qj.49711146910","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Shuttleworth & Wallace (1985)","key":"j1J2mCvPdz"}],"kind":"narrative","label":"Shuttleworth_1985","identifier":"https://doi.org/10.1002/qj.49711146910","enumerator":"3","key":"pYNC2lvATp"},{"type":"text","value":".","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"hbwaVY0BCG"}],"key":"lsNPEo67lZ"}],"key":"aQRlQrEXNx"}],"label":"shuttleworth-wallace-model","identifier":"shuttleworth-wallace-model","enumerator":"1","html_id":"shuttleworth-wallace-model","key":"aS7Nn7tmSj"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Energy fluxes are therefore split into soil and canopy, considering the conservation of energy:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"BmU7MSHsW8"}],"key":"dxd7kVjttX"},{"type":"math","value":"R_{n} & \\approx H + \\lambda E + G\\\\\n  R_{n,S} & \\approx H_{S} + \\lambda E_{S} + G\\\\\n  R_{n,C} & \\approx H_{C} + \\lambda E_{C}","identifier":"eq:energy_balance_tseb","label":"eq:Energy_Balance_TSEB","html_id":"eq-energy-balance-tseb","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>R</mi><mi>n</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>≈</mo><mi>H</mi><mo>+</mo><mi>λ</mi><mi>E</mi><mo>+</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>R</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>S</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>≈</mo><msub><mi>H</mi><mi>S</mi></msub><mo>+</mo><mi>λ</mi><msub><mi>E</mi><mi>S</mi></msub><mo>+</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>R</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>C</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>≈</mo><msub><mi>H</mi><mi>C</mi></msub><mo>+</mo><mi>λ</mi><msub><mi>E</mi><mi>C</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align*}\nR_{n} &amp; \\approx H + \\lambda E + G\\\\\n  R_{n,S} &amp; \\approx H_{S} + \\lambda E_{S} + G\\\\\n  R_{n,C} &amp; \\approx H_{C} + \\lambda E_{C}\n\\end{align*}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.5em;vertical-align:-2em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5em;\"><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5em;\"><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">G</span></span></span><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">G</span></span></span><span style=\"top:-1.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"wHpTm4gNKG"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"with ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"In2KKtO6oX"},{"type":"inlineMath","value":"R_n","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">R_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XE6hw3Yd5D"},{"type":"text","value":" being the net radiation, ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"G2dMokl5os"},{"type":"inlineMath","value":"H","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"ULoNsmZZqh"},{"type":"text","value":" the sensible heat flux, ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"rlyzHLjVGg"},{"type":"inlineMath","value":"\\lambda E","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span>","key":"x8I4a3aWK0"},{"type":"text","value":" the latent heat flux or evapotranspiration, and ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"pUZKc6lqfp"},{"type":"inlineMath","value":"G","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>","key":"uw7s0mPHC8"},{"type":"text","value":" the soil heat flux (all fluxes are expressed in W m","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"TYRxDqTjc4"},{"type":"inlineMath","value":"^{-2}","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow></mrow><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">^{-2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>","key":"i0jl2qFC6t"},{"type":"text","value":". The approximation in Eq. \\ref{eq:Energy_Balance} reflects additional components of the energy balance that are usually neglected, such as heat advection, storage of energy in the canopy layer or energy for the fixation of CO","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"zGo8YSVI4d"},{"type":"inlineMath","value":"_2","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PmRBYEiHfj"},{"type":"text","value":" \\citep{Hillel1998, Baldocchi1991}, which are not computed by the model.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"WmIx1cfhdA"}],"key":"iizrTRdOE9"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Canopy latent heat flux (or transpiration) is computed as","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"S3A7MoLb7A"}],"key":"pE5h0d2MsW"},{"type":"math","value":" \\lambda E_C = \\frac{\\Delta R_{n.C} + \\rho_a c_p \\frac{VPD_0}{R_x}}{\\Delta + \\gamma  \\left(1 + \\frac{R_c}{R_x}\\right)}","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>λ</mi><msub><mi>E</mi><mi>C</mi></msub><mo>=</mo><mfrac><mrow><mi mathvariant=\"normal\">Δ</mi><msub><mi>R</mi><mrow><mi>n</mi><mi mathvariant=\"normal\">.</mi><mi>C</mi></mrow></msub><mo>+</mo><msub><mi>ρ</mi><mi>a</mi></msub><msub><mi>c</mi><mi>p</mi></msub><mfrac><mrow><mi>V</mi><mi>P</mi><msub><mi>D</mi><mn>0</mn></msub></mrow><msub><mi>R</mi><mi>x</mi></msub></mfrac></mrow><mrow><mi mathvariant=\"normal\">Δ</mi><mo>+</mo><mi>γ</mi><mrow><mo fence=\"true\">(</mo><mn>1</mn><mo>+</mo><mfrac><msub><mi>R</mi><mi>c</mi></msub><msub><mi>R</mi><mi>x</mi></msub></mfrac><mo fence=\"true\">)</mo></mrow></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\"> \\lambda E_C = \\frac{\\Delta R_{n.C} + \\rho_a c_p \\frac{VPD_0}{R_x}}{\\Delta + \\gamma  \\left(1 + \\frac{R_c}{R_x}\\right)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.4136em;vertical-align:-1.69em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7235em;\"><span style=\"top:-2.11em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"mord\"><span class=\"mord\">Δ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8884em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4101em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span></span></span><span style=\"top:-3.38em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.9851em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"mord\"><span class=\"mord\">Δ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mtight\">.</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8884em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4101em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"2","key":"f76N0NVvFC"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"pfG3pEnGHS"},{"type":"inlineMath","value":"\\rho_a","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ρ</mi><mi>a</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\rho_a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"i8376vMlhk"},{"type":"text","value":" is the air density; ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"xzAK3fAYPl"},{"type":"inlineMath","value":"c_p","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>c</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">c_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XaKYJe4AGk"},{"type":"text","value":" the heat capacity of air, ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"wHnYXd5rhU"},{"type":"inlineMath","value":"VPD_0","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mi>P</mi><msub><mi>D</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">VPD_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ls9y70dwi9"},{"type":"text","value":" is the air vapour pressure deficit at the canopy-air interface; ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"M4P7Pt2eHb"},{"type":"inlineMath","value":"R_x","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">R_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jd3GZr5fcn"},{"type":"text","value":" is the canopy boundary resistance to momentum, heat and vapour transport; and ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"gtcOSoBiI3"},{"type":"inlineMath","value":"R_c","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">R_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Rud8nMUAoN"},{"type":"text","value":" is related to the leaf stomatal conductance ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"qs46FoZbmz"},{"type":"inlineMath","value":"g_{s}","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>g</mi><mi>s</mi></msub></mrow><annotation encoding=\"application/x-tex\">g_{s}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"d5kld7loHZ"},{"type":"text","value":" as we will see later in section ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"etcS9Sgu9w"},{"type":"crossReference","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Sensitivity of stomatal conductance to vapour pressure deficit","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"qDhDZyRfbS"}],"identifier":"gs-header","label":"gs-header","kind":"heading","template":"{name}","resolved":true,"html_id":"gs-header","key":"XouhaOrvwG"}],"key":"fDfoumrVD9"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"The vapor pressure deficit at the canopy-air interface (","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"otRKbMM3nV"},{"type":"inlineMath","value":"VPD_0","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mi>P</mi><msub><mi>D</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">VPD_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IdDOcmTSbz"},{"type":"text","value":") is computed as","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"CXRJpYjufA"}],"key":"MmRMsDnUBh"},{"type":"math","value":" VPD_0 = VPD + R_a \\frac{\\Delta \\left(R_n - G\\right) - \\left(\\Delta + \\gamma\\right) \\lambda E} {\\rho_a c_p}","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>V</mi><mi>P</mi><msub><mi>D</mi><mn>0</mn></msub><mo>=</mo><mi>V</mi><mi>P</mi><mi>D</mi><mo>+</mo><msub><mi>R</mi><mi>a</mi></msub><mfrac><mrow><mi mathvariant=\"normal\">Δ</mi><mrow><mo fence=\"true\">(</mo><msub><mi>R</mi><mi>n</mi></msub><mo>−</mo><mi>G</mi><mo fence=\"true\">)</mo></mrow><mo>−</mo><mrow><mo fence=\"true\">(</mo><mi mathvariant=\"normal\">Δ</mi><mo>+</mo><mi>γ</mi><mo fence=\"true\">)</mo></mrow><mi>λ</mi><mi>E</mi></mrow><mrow><msub><mi>ρ</mi><mi>a</mi></msub><msub><mi>c</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\"> VPD_0 = VPD + R_a \\frac{\\Delta \\left(R_n - G\\right) - \\left(\\Delta + \\gamma\\right) \\lambda E} {\\rho_a c_p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3991em;vertical-align:-0.9721em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">Δ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\">Δ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"3","key":"SZA4tP0Rl1"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"DP5vUIUNv4"},{"type":"inlineMath","value":"VPD","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mi>P</mi><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">VPD</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"nz4avJ4Nrp"},{"type":"text","value":" is the measured atmospheric vapour pressure deficit, ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"qTHvuiW8Aj"},{"type":"inlineMath","value":"R_a","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mi>a</mi></msub></mrow><annotation encoding=\"application/x-tex\">R_a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"HNVfAOOmAS"},{"type":"text","value":" is the aerodynamic resistance to turbulent transport, ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"h2NRLazIly"},{"type":"inlineMath","value":"R_n","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">R_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IEx4wQwV9X"},{"type":"text","value":" is the surface net radiation, ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"cChU22TarV"},{"type":"inlineMath","value":"G","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>","key":"hkRW3QYwwF"},{"type":"text","value":" is the soil heat flux, and ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"xDwWFQLnw2"},{"type":"inlineMath","value":"\\lambda E","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span>","key":"h1CqPiR37S"},{"type":"text","value":" is the surface bulk (soil + canopy) latent heat flux, estimated as:","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"SswvOK5gFh"}],"key":"LlIUPeOoGr"},{"type":"math","value":"\\lambda E = C_c PM_C + C_s PM_S","identifier":"eq:sw_weight","label":"eq:sw_weight","html_id":"eq-sw-weight","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>λ</mi><mi>E</mi><mo>=</mo><msub><mi>C</mi><mi>c</mi></msub><mi>P</mi><msub><mi>M</mi><mi>C</mi></msub><mo>+</mo><msub><mi>C</mi><mi>s</mi></msub><mi>P</mi><msub><mi>M</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\lambda E = C_c PM_C + C_s PM_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"4","key":"Ebzb6zjO1Q"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"inlineMath","value":"PM_C","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><msub><mi>M</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">PM_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YJamu1Lj6m"},{"type":"text","value":" and ","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"acIGvbuhGn"},{"type":"inlineMath","value":"PM_S","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><msub><mi>M</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">PM_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"FeJ2XWoBL9"},{"type":"text","value":" are the estimates of an infinite deep canopy and bare soil latent heat fluxes, respectively using the Penman-Monteith equation:","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"f2ARVkXxo9"}],"key":"kK4I5LkrJN"},{"type":"math","value":"  PM_C & = \\frac{\\Delta  \\left(R_n - G\\right) + \\frac{\\rho_a c_p VPD - \\Delta  R_x \\left(R_{n,S} - G\\right)}{\n      R_a + R_x}}{\\Delta + \\gamma \\left(1 + \\frac{R_c}{R_a + R_x}\\right)}\\\\\n  PM_S & = \\frac{\\Delta  \\left(R_n - G\\right) + \\frac{\\rho_a c_p VPD - \\Delta R_s R_{n,C}}{R_a + R_s}}{\\Delta + \\gamma \\left(1 + \\frac{R_{ss}} {R_a + R_s}\\right)}","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>P</mi><msub><mi>M</mi><mi>C</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi mathvariant=\"normal\">Δ</mi><mrow><mo fence=\"true\">(</mo><msub><mi>R</mi><mi>n</mi></msub><mo>−</mo><mi>G</mi><mo fence=\"true\">)</mo></mrow><mo>+</mo><mfrac><mrow><msub><mi>ρ</mi><mi>a</mi></msub><msub><mi>c</mi><mi>p</mi></msub><mi>V</mi><mi>P</mi><mi>D</mi><mo>−</mo><mi mathvariant=\"normal\">Δ</mi><msub><mi>R</mi><mi>x</mi></msub><mrow><mo fence=\"true\">(</mo><msub><mi>R</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>S</mi></mrow></msub><mo>−</mo><mi>G</mi><mo fence=\"true\">)</mo></mrow></mrow><mrow><msub><mi>R</mi><mi>a</mi></msub><mo>+</mo><msub><mi>R</mi><mi>x</mi></msub></mrow></mfrac></mrow><mrow><mi mathvariant=\"normal\">Δ</mi><mo>+</mo><mi>γ</mi><mrow><mo fence=\"true\">(</mo><mn>1</mn><mo>+</mo><mfrac><msub><mi>R</mi><mi>c</mi></msub><mrow><msub><mi>R</mi><mi>a</mi></msub><mo>+</mo><msub><mi>R</mi><mi>x</mi></msub></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>P</mi><msub><mi>M</mi><mi>S</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi mathvariant=\"normal\">Δ</mi><mrow><mo fence=\"true\">(</mo><msub><mi>R</mi><mi>n</mi></msub><mo>−</mo><mi>G</mi><mo fence=\"true\">)</mo></mrow><mo>+</mo><mfrac><mrow><msub><mi>ρ</mi><mi>a</mi></msub><msub><mi>c</mi><mi>p</mi></msub><mi>V</mi><mi>P</mi><mi>D</mi><mo>−</mo><mi mathvariant=\"normal\">Δ</mi><msub><mi>R</mi><mi>s</mi></msub><msub><mi>R</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>C</mi></mrow></msub></mrow><mrow><msub><mi>R</mi><mi>a</mi></msub><mo>+</mo><msub><mi>R</mi><mi>s</mi></msub></mrow></mfrac></mrow><mrow><mi mathvariant=\"normal\">Δ</mi><mo>+</mo><mi>γ</mi><mrow><mo fence=\"true\">(</mo><mn>1</mn><mo>+</mo><mfrac><msub><mi>R</mi><mrow><mi>s</mi><mi>s</mi></mrow></msub><mrow><msub><mi>R</mi><mi>a</mi></msub><mo>+</mo><msub><mi>R</mi><mi>s</mi></msub></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align*}\n  PM_C &amp; = \\frac{\\Delta  \\left(R_n - G\\right) + \\frac{\\rho_a c_p VPD - \\Delta  R_x \\left(R_{n,S} - G\\right)}{\n      R_a + R_x}}{\\Delta + \\gamma \\left(1 + \\frac{R_c}{R_a + R_x}\\right)}\\\\\n  PM_S &amp; = \\frac{\\Delta  \\left(R_n - G\\right) + \\frac{\\rho_a c_p VPD - \\Delta R_s R_{n,C}}{R_a + R_s}}{\\Delta + \\gamma \\left(1 + \\frac{R_{ss}} {R_a + R_s}\\right)}\n\\end{align*}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:7.6686em;vertical-align:-3.5843em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.0843em;\"><span style=\"top:-6.0843em;\"><span class=\"pstrut\" style=\"height:3.8676em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.2733em;\"><span class=\"pstrut\" style=\"height:3.8676em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.5843em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.0843em;\"><span style=\"top:-6.0843em;\"><span class=\"pstrut\" style=\"height:3.8676em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8676em;\"><span style=\"top:-2.11em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"mord\"><span class=\"mord\">Δ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8884em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4101em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span></span></span><span style=\"top:-3.38em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.9851em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"mord\"><span class=\"mord\">Δ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0325em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.5075em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">Δ</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"minner mtight\"><span class=\"mopen mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">(</span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3567em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2822em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">G</span><span class=\"mclose mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">)</span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.2733em;\"><span class=\"pstrut\" style=\"height:3.8676em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.821em;\"><span style=\"top:-2.11em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"mord\"><span class=\"mord\">Δ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8884em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4101em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ss</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span></span></span><span style=\"top:-3.38em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.9851em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"mord\"><span class=\"mord\">Δ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9859em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.5075em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">Δ</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3567em;margin-left:-0.0077em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2822em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.5843em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"5","key":"WZ48ulgV7F"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"e6JLWYbKEf"},{"type":"inlineMath","value":"R_s","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mi>s</mi></msub></mrow><annotation encoding=\"application/x-tex\">R_s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Zs49EssNXj"},{"type":"text","value":" is the soil boundary layer resistance to turbulent transport and ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"OYAZLV26HM"},{"type":"inlineMath","value":"R_{ss}","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{ss}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ss</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XsCbNQQHj6"},{"type":"text","value":" is the near-surface soil resistance to vapour transport. The latter is set to a fixed value of ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"j3Lz38SyDX"},{"type":"inlineMath","value":"R_{ss}=2000","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>=</mo><mn>2000</mn></mrow><annotation encoding=\"application/x-tex\">R_{ss}=2000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ss</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2000</span></span></span></span>","key":"UMqE8B2buO"},{"type":"text","value":" s m","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"xtWigX3wi1"},{"type":"inlineMath","value":"^{-1}","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">^{-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"z7tLaMFAF4"},{"type":"text","value":" considering a rather dry soil surface, in order to be consistent with the definition of potential ET adopted with the Penman-Monteith approach.","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"Jmn2ayaEUT"}],"key":"hfdVlCIk20"},{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"See Also","key":"RlvPF6Onv6"}],"key":"dVFxu0h15S"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"The full code for the Shuttleworth and Wallace model is at the ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"L7yZ3bfguQ"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/energy_combination_ET.py#L277","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"pyTSEB GitHub repository","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"CWMklQanrk"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/energy_combination_ET.py#L277","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/energy_combination_ET.py","from":277,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/energy_combination_ET.py"},"internal":false,"protocol":"github","key":"i1dNDls2sI"}],"key":"WdXFzPmZgz"}],"class":"dropdown","key":"A8pl61y4vo"}],"key":"oqtrFnqX5p"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Sensitivity of stomatal conductance to vapour pressure deficit","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Qk3nc1ipCY"}],"label":"gs-header","identifier":"gs-header","html_id":"gs-header","key":"mw3F21l9lF"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"cite","url":"https://doi.org/10.1007/s00271-022-00778-y","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Kustas ","key":"W87isjibxH"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"uL7sbFgSNw"}],"key":"jMkhpYrlDD"},{"type":"text","value":" (2022)","key":"QCha8bNnbD"}],"kind":"narrative","label":"Kustas_2022","identifier":"https://doi.org/10.1007/s00271-022-00778-y","enumerator":"1","key":"YGPzDoksgl"},{"type":"text","value":" showed the advantages of accounting for the sensitivity of stomatal closure at higher VPD in canopies highly coupled with the atmosphere ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zUQg9urbJ6"},{"type":"citeGroup","kind":"parenthetical","children":[{"type":"cite","kind":"parenthetical","label":"Jarvis_1986","identifier":"https://doi.org/10.1016/s0065-2504(08)60119-1","children":[{"type":"text","value":"Jarvis & McNaughton, 1986","key":"C7fb5zVTdg"}],"enumerator":"4","key":"hr0ZsxV9Ef"}],"key":"kUCHLvZSb5"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"L0oCiRVnaL"}],"key":"epXxI01S5B"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We are going to evaluate the sensitivity of leaf stomata to VPD using estimates of transpiration derived from the Eddy Covariance. This approach is based on the method proposed by ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"H9jbRDwLMY"},{"type":"cite","url":"https://doi.org/10.1111/j.1365-3040.1995.tb00371.x","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"MONTEITH (1995)","key":"lIh3c8bC9J"}],"kind":"narrative","label":"MONTEITH_1995","identifier":"https://doi.org/10.1111/j.1365-3040.1995.tb00371.x","enumerator":"5","key":"iPdlMv3JRE"}],"key":"Z9QgHBuAlG"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The canopy stomatal resistance (","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RlqGCK1vvm"},{"type":"inlineMath","value":"R_c","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">R_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"D1rIvTTK6r"},{"type":"text","value":"), dependent of VPD variations, is then computed as.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"EafbzoNZWI"}],"key":"vNbAsDWxSP"},{"type":"math","value":"R_c = \\frac{1}{g_{s,0} f_s f_g LAI}","label":"R_c","identifier":"r_c","tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>R</mi><mi>c</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mi>g</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mn>0</mn></mrow></msub><msub><mi>f</mi><mi>s</mi></msub><msub><mi>f</mi><mi>g</mi></msub><mi>L</mi><mi>A</mi><mi>I</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">R_c = \\frac{1}{g_{s,0} f_s f_g LAI}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2935em;vertical-align:-0.9721em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"6","html_id":"r-c","key":"xe1moBR007"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Ls5JxNsO7s"},{"type":"inlineMath","value":"LAI","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>A</mi><mi>I</mi></mrow><annotation encoding=\"application/x-tex\">LAI</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span></span>","key":"f7LUlYcbbZ"},{"type":"text","value":" is the leaf area index, defined as half of the total leaf area, and ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"jbsBBFD3iF"},{"type":"inlineMath","value":"f_s","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>s</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XlSq631b6o"},{"type":"text","value":" is a factor representing the distribution of stomata in the leaf (","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"bqqkIeJxR2"},{"type":"inlineMath","value":"f_s=1","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>s</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">f_s=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"SWoIEcgHum"},{"type":"text","value":" for hypostomatous leaves and ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"n5OGvHeZHj"},{"type":"inlineMath","value":"f_s=2","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>s</mi></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">f_s=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"c2wTdgiRoa"},{"type":"text","value":" for amphistomatous leaves) and ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"cTgcpnTNvj"},{"type":"inlineMath","value":"f_g","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>g</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Inv9wnlbX8"},{"type":"text","value":" is the fraction of LAI that is green and hence actively transpiring.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"LkENueMwdt"}],"key":"fHriFFZeys"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Accounting for the negative feedback observed between transpiration (T) rates and stomatal closure based on a wide variety of plant level measurements, ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ONxwmin5eL"},{"type":"cite","url":"https://doi.org/10.1111/j.1365-3040.1995.tb00371.x","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"MONTEITH (1995)","key":"hD4dC6eld1"}],"kind":"narrative","label":"MONTEITH_1995","identifier":"https://doi.org/10.1111/j.1365-3040.1995.tb00371.x","enumerator":"5","key":"dYbwodcv64"},{"type":"text","value":" proposed a method to parameterize the relationship between leaf stomatal conductance (","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"sYnCgC3oNo"},{"type":"inlineMath","value":"g_s","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>g</mi><mi>s</mi></msub></mrow><annotation encoding=\"application/x-tex\">g_s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"n5XU1zsnXX"},{"type":"text","value":") and ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"szzqXCSnZl"},{"type":"inlineMath","value":"VPD","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mi>P</mi><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">VPD</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"n9oXaZJI3m"},{"type":"text","value":", based on measurements of transpiration as follows:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"wGN5jkIRcF"}],"key":"NbdV4bqk2L"},{"type":"math","value":"g_{s} = \\frac{g_m}{1 + g_m VPD/T_m}","label":"monteith1995","identifier":"monteith1995","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>g</mi><mi>s</mi></msub><mo>=</mo><mfrac><msub><mi>g</mi><mi>m</mi></msub><mrow><mn>1</mn><mo>+</mo><msub><mi>g</mi><mi>m</mi></msub><mi>V</mi><mi>P</mi><mi>D</mi><mi mathvariant=\"normal\">/</mi><msub><mi>T</mi><mi>m</mi></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">g_{s} = \\frac{g_m}{1 + g_m VPD/T_m}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0436em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"7","html_id":"monteith1995","key":"b1H6EHwW76"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Values of ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"iT4dSpfojA"},{"type":"inlineMath","value":"g_m","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>g</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">g_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PZncHOvkuX"},{"type":"text","value":" and ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"TISlQVe83W"},{"type":"inlineMath","value":"T_m","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"luvfGy66l9"},{"type":"text","value":" will be empirically derived by plotting observations of ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"QTWCzNK3Ni"},{"type":"inlineMath","value":"T","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"FbNwtq4EG7"},{"type":"text","value":" and ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"dCqNElNHa3"},{"type":"inlineMath","value":"VPD","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mi>P</mi><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">VPD</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"rqv5HxuCzF"},{"type":"text","value":", and building a linear regression:","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"v0gkhJKIaO"}],"key":"fNi7TWHqC6"},{"type":"math","value":"1/T = \\frac{1}{a{VPD}} + b","label":"vpd-linear","identifier":"vpd-linear","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>T</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mi>a</mi><mrow><mi>V</mi><mi>P</mi><mi>D</mi></mrow></mrow></mfrac><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">1/T = \\frac{1}{a{VPD}} + b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span>","enumerator":"8","html_id":"vpd-linear","key":"K8KG2J1PHp"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"from which ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"kCp8YC73BR"},{"type":"inlineMath","value":"g_m = a","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>g</mi><mi>m</mi></msub><mtext> </mtext><mo>=</mo><mtext> </mtext><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">g_m = a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\"> </span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"dbDiGMd1aN"},{"type":"text","value":" and ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"Bpfj3n2cc0"},{"type":"inlineMath","value":"T_m = 1/b","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>m</mi></msub><mtext> </mtext><mo>=</mo><mtext> </mtext><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">T_m = 1/b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"> 1/</span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"rCTWxjloRp"},{"type":"text","value":". Finally, from these metrics qe can derive the ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"ecqhZeGmFO"},{"type":"cite","url":"https://doi.org/10.1111/j.1365-3040.1995.tb00370.x","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"LEUNING (1995)","key":"BVrdR9KyN1"}],"kind":"narrative","label":"LEUNING_1995","identifier":"https://doi.org/10.1111/j.1365-3040.1995.tb00370.x","enumerator":"6","key":"ve9ioaw45e"},{"type":"text","value":" stomatal conductance model:","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"bz55IcrkwU"}],"key":"SoAkI0XBqu"},{"type":"math","value":"g_{s,0} = \\frac{g_m}{1 + VPD / D_0}","label":"leuning1995","identifier":"leuning1995","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>g</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mn>0</mn></mrow></msub><mo>=</mo><mfrac><msub><mi>g</mi><mi>m</mi></msub><mrow><mn>1</mn><mo>+</mo><mi>V</mi><mi>P</mi><mi>D</mi><mi mathvariant=\"normal\">/</mi><msub><mi>D</mi><mn>0</mn></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">g_{s,0} = \\frac{g_m}{1 + VPD / D_0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0436em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"9","html_id":"leuning1995","key":"d7JYrt66LM"}],"key":"lCoJvzNqf0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Application with actual data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rigFUI2a73"}],"identifier":"application-with-actual-data","label":"Application with actual data","html_id":"application-with-actual-data","implicit":true,"key":"DLnLxifDp5"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"To build the linear regression of Eq. ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kNJzS7tDWz"},{"type":"crossReference","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"(","key":"IDUefL0DcQ"},{"type":"text","value":"8","key":"ALmhblEO4S"},{"type":"text","value":")","key":"Af2i1eZbkK"}],"identifier":"vpd-linear","label":"vpd-linear","kind":"equation","template":"(%s)","enumerator":"8","resolved":true,"html_id":"vpd-linear","key":"sV61IxrI4W"},{"type":"text","value":" we need work at leaf scale. Therefore, the estimated canopy transpiration from the eddy covariance tower is (TEC) first downscaled to an effective leaf transpiration rate using the satellite LAI (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"LvlAe0qZ1D"},{"type":"inlineMath","value":"T_{leaf} = T/LAI","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mrow><mi>l</mi><mi>e</mi><mi>a</mi><mi>f</mi></mrow></msub><mtext> </mtext><mo>=</mo><mtext> </mtext><mi>T</mi><mi mathvariant=\"normal\">/</mi><mi>L</mi><mi>A</mi><mi>I</mi></mrow><annotation encoding=\"application/x-tex\">T_{leaf} = T/LAI</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"> </span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span></span>","key":"Ci95QSz2vZ"},{"type":"text","value":").","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"QBSGt5eyrv"}],"key":"jrkBpMaxMl"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"First select the sites that you want to use to derived the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"fJTPUUxFbA"},{"type":"inlineMath","value":"g_m","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>g</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">g_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"boR42aFF2C"},{"type":"text","value":", ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HkxJIs2HGE"},{"type":"inlineMath","value":"T_m","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Neu3KeE2w2"},{"type":"text","value":" and ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"TR5Loe3MAb"},{"type":"inlineMath","value":"D_0","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">D_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"bBSWZy7ntA"},{"type":"text","value":" metrics. You can select one or several sites and see how sensitive are these parameters to the grape varieties.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GWCVz0YEek"}],"key":"JMTKPCldgD"}],"key":"aZCGJM1r5j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"w_site_list = widgets.SelectMultiple(\n    options=[('Sierra Loma N', \"slmN\"), ('Sierra Loma S', \"slmS\"), \n             ('Barrelli 007', \"bar007\"), ('Barrelli 012', \"bar012\"),\n             ('Ripperdan 760', \"rip760\"), \n             ('Ripperdan 720-1', \"rip720_1\"),  ('Ripperdan 720-2', \"rip720_2\"),  ('Ripperdan 720-3', \"rip720_3\"),  ('Ripperdan 720-4', \"rip720_4\")],\n    value=[\"rip720_1\", \"rip720_2\", \"rip760\"],\n    description='Sites',\n    rows=9\n)\ndisplay(w_site_list)","key":"LRcQebxn8i"},{"type":"output","id":"9CB2uNTjc291fcRjALqUi","data":[],"key":"TPLCDEYBJa"}],"key":"MWNOmw8buw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Read the EC and LAI data files","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hFwWvODQAL"}],"identifier":"read-the-ec-and-lai-data-files","label":"Read the EC and LAI data files","html_id":"read-the-ec-and-lai-data-files","implicit":true,"key":"srjAz13HRK"}],"key":"IrXSA1X2GV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Import Python libraries\nfrom pathlib import Path\nimport pandas as pd\nfrom pyTSEB import TSEB\n\n# Set the LAI and readiation folders\ninput_dir = Path().absolute() / \"input\"\nlai_dir = input_dir / \"canopy\"\nrad_dir = input_dir / \"meteo\"\n\n# Append all tables in a single merged table\nec_all = pd.DataFrame()\nfor site in w_site_list.value:\n    # Set the input files based on the chosen site\n    lai_filename = lai_dir / f\"FLX_US-{site}_FLUXNET2015_AUXCANOPY_DD.csv\"\n    ec_filename = rad_dir / f\"FLX_US-{site}_FLUXNET2015_SUBSET_HR.csv\"\n    print(f\"LAI file path is {lai_filename}\")\n    print(f\"Micrometeorogy file path is {ec_filename}\")\n    \n    # Read the LAI and radiation tables\n    lai = pd.read_csv(lai_filename, sep=\";\", na_values=-9999)\n    ec = pd.read_csv(ec_filename, sep=\";\", na_values=-9999)\n    \n    # Merge both tables by date\n    ec[\"TIMESTAMP\"] = pd.to_datetime(ec[\"TIMESTAMP\"], format=\"%Y%m%d%H%M\")\n    lai[\"DATE\"] = pd.to_datetime(lai[\"TIMESTAMP\"], format=\"%Y%m%d\").dt.date\n    lai = lai.drop(labels=[\"TIMESTAMP\"], axis=1)\n    ec[\"DATE\"] = ec[\"TIMESTAMP\"].dt.date\n    ec = ec.merge(lai, on=\"DATE\")\n    ec[\"SITE\"] = site\n    \n\n    ec_all = pd.concat([ec_all, ec], ignore_index=True, axis=0)","key":"iq73yN77Uu"},{"type":"output","id":"d5fiUZP9FOW5PyVUPJp2F","data":[],"key":"Nkwu6mHIgw"}],"key":"Rj1xkpnWs2"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"See Also","key":"Vx21hyTvTG"}],"key":"fXSPUPO13n"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This is a full description of the EC column fields:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gRmhV2FgIi"}],"key":"ycl3ex7x0p"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"./fluxnet2015_variables.md","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"urlSource":"./fluxnet2015_variables.md","key":"AMM9bDwt22"}],"key":"pM9HmK3RtH"}],"class":"dropdown","key":"UeipDOqQl0"}],"key":"Zq414Szczv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The values of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mHkwPBXuSN"},{"type":"inlineMath","value":"T","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"TcuBLX5d70"},{"type":"text","value":" are estimated using a several methods based on relaxed-eddy accumulation and quadrant analysis ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jzqbxrrLZs"},{"type":"citeGroup","kind":"parenthetical","children":[{"type":"cite","kind":"parenthetical","label":"Thomas_2008","identifier":"https://doi.org/10.1016%2fj.agrformet.2008.03.002","children":[{"type":"text","value":"Thomas ","key":"z9ngmUfSTp"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"zZBrmRAAeB"}],"key":"m4srLV3hY3"},{"type":"text","value":", 2008","key":"ouGl4Brn2U"}],"enumerator":"7","key":"Q8yi8Ck0ei"},{"type":"cite","kind":"parenthetical","label":"Zahn_2022","identifier":"https://doi.org/10.1016/j.agrformet.2021.108790","children":[{"type":"text","value":"Zahn ","key":"C5cLwvM6A4"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"vupJjsUpZA"}],"key":"BdR30f4xK5"},{"type":"text","value":", 2022","key":"k8MAelGQAD"}],"enumerator":"8","key":"nDXuz0uQOg"}],"key":"GzeT1ERZtR"},{"type":"text","value":". We compute the average of the three methods (CEC, REA, and FVS). Then we convert those values expressed in energy units into mole fractions:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q7OLD9bhrS"}],"key":"HDUqnkvJzE"}],"key":"icKFPpkYCr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from pyTSEB import physiology as lf\n\n# Only derive the parameters when grapevine in active\nDOY_LIMS = (120, 246)\n\nec_all[\"LE_C\"] = np.nanmean(ec_all[[\"LE_C_ECC\", \"LE_C_REA\", \"LE_C_FVS\"]], axis=1)\n# Convert Celsius to Kelvin\nec_all[\"TA\"] = ec_all[\"TA\"] + 273.15\n# Convert kPa to hPa\nec_all[\"PA\"] = 10 * ec_all[\"PA\"]\n\n# Work only under daytime conditions and positive LE fluxes\nvalid = np.logical_and.reduce((ec_all[\"SW_IN\"] > 100,\n                               ec_all[\"VPD\"] > 0,\n                               np.isfinite(ec_all[\"LE_C\"]),\n                               ec_all[\"TIMESTAMP\"].dt.dayofyear >= DOY_LIMS[0],\n                               ec_all[\"TIMESTAMP\"].dt.dayofyear <= DOY_LIMS[1],\n                               ec_all[\"LE_C\"] > 0))\n\nec_all = ec_all.loc[valid, :]\n# Monteith approach needs to convert units to millimoles\nec_all[\"VPD_MMOL\"] = 1e3 * ec_all[\"VPD\"].values / ec_all[\"PA\"].values\nec_all[\"LE_C_MMOL\"] = ec_all[\"LE_C\"].values / (ec_all[\"LAI\"].values * lf.mmolh20_2_wm2(ec_all[\"TA\"].values))","key":"L3D4jPYajc"},{"type":"output","id":"0n3Kd-5wz4W24moBgU4fl","data":[],"key":"CGXauQbyKi"}],"key":"LJcrORqN91"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The linear relationship between the reciprocals of VPD and maximum T only appears when VPD is the main limiting factor to stomata closure ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dM3OdZTDrE"},{"type":"citeGroup","kind":"parenthetical","children":[{"type":"cite","kind":"parenthetical","label":"MONTEITH_1995","identifier":"https://doi.org/10.1111/j.1365-3040.1995.tb00371.x","children":[{"type":"text","value":"MONTEITH, 1995","key":"uh7Bm4M9ib"}],"enumerator":"5","key":"FY4B9kq9tP"}],"key":"Z2cS0AZ2TO"},{"type":"text","value":". Therefore, this linear relationship is derived from the lower envelope of the 1/T vs. 1/VPD scatterplot for all daytime EC observations under relatively high VPD values.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vRfmvXnszN"}],"key":"wbZlepayot"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We create the following helper functions to get the lower envelope of the vpd vs. T relationship and the stomatal metrics:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"y4fqCcrPat"}],"key":"KUtJSzMGsU"}],"key":"HgR2QxXOv6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_envelope(x_array, y_array, percentile=0.95, n_bins=30):\n    # Bin x_array\n    _, bin_edges = np.histogram(x_array, bins=n_bins)\n\n    x_values = []\n    y_values = []\n    for i, edge in enumerate(bin_edges[:-1]):\n        valid = np.logical_and(x_array >= edge, x_array < bin_edges[i + 1])\n        if np.any(valid):\n            x_values.append(np.mean(x_array[valid]))\n            if percentile == \"minimum\":\n                y_values.append(np.nanmin(y_array[valid]))\n            elif percentile == \"maximum\":\n                y_values.append(np.nanmax(y_array[valid]))\n            else:\n                y_values.append(np.percentile(y_array[valid], 100 * percentile))\n\n    return np.asarray(x_values), np.asarray(y_values)\n\n    \ndef monteith_2_leuning(g_m, t_m, p=1013.15):\n    \"\"\"\n\n    :param g_m: mol m$^{{-2}}$ s$^{{-1}}$\n    :param t_m: mmol m$^{{-2}}$ s$^{{-1}}$\n    :return:\n    d_0: hPa\n    \"\"\"\n    d_0 = t_m / g_m  # mmol mol-1\n    # Convert from mmol mol-1 to mb\n    d_0 *= 1e-3 * p\n    return d_0\n\n\ndef leuning_stress(vpd, d_0):\n\n    stress = 1. / (1. + vpd / d_0)\n    return stress\n","key":"Euqac05anl"},{"type":"output","id":"IjsTTJByjvaVgJ9KPcKkv","data":[],"key":"LOny7Qq8JI"}],"key":"LMgORl4AW4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"... and with these helper functions we are ready to estimate the stomatal parameters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UqTNdCmyFA"}],"key":"cUKn0aAGYx"}],"key":"TxIehVBsal"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import scipy.stats as st\nfrom plotly.subplots import make_subplots\nimport plotly.graph_objects as go\n\n# Set the criteria for the envelope search\nMIN_PERCENTILE = 0.01\nN_BINS = \"auto\"\n\n# We first dervive the parameters based on all the selected sites together\nvalid = 1. / ec_all[\"VPD_MMOL\"] < 0.08\n\nprint(f\"Finding stomatal parameters for all sites together\")\n# Find the lower envelope                         \nxs, ys = get_envelope(1. / ec_all.loc[valid, \"VPD_MMOL\"], 1. / ec_all.loc[valid, \"LE_C_MMOL\"],\n                      percentile=MIN_PERCENTILE,\n                      n_bins=N_BINS)\n\n# Adjust a linear model from the lower envelope\nlm = st.linregress(xs, ys)\n# Plot the linear model\nfig = go.Figure()\nfig.add_trace(go.Scatter(x=xs, y=lm.intercept + lm.slope * xs, name=\"Fit ALL\", mode=\"lines\", line={\"color\":\"black\"}))\n\n# We will store each parameter in a Python dictionary\nn_cases = {}\ngm = {}\nt_m = {}\nd_0 = {}\n\n# Derive the Monteith and Leuning stomata parameters\nn_cases[\"ALL\"] = np.sum(valid)\ngm[\"ALL\"] = 1. / lm.slope\nt_m[\"ALL\"] = 1. / lm.intercept\nd_0[\"ALL\"] = monteith_2_leuning(gm[\"ALL\"], t_m[\"ALL\"], p=np.nanmean(ec_all.loc[valid, \"PA\"]))\n\n# We now repeat the same procedure for each site individually\nfor site, site_label in zip(w_site_list.value, w_site_list.label):\n    print(f\"Finding stomatal parameters for {site_label}\")\n    valid = np.logical_and(1. / ec_all[\"VPD_MMOL\"] < 0.08, ec_all[\"SITE\"] == site)\n    \n    # Find the lower envelope                         \n    xs, ys = get_envelope(1. / ec_all.loc[valid, \"VPD_MMOL\"], 1. / ec_all.loc[valid, \"LE_C_MMOL\"],\n                          percentile=MIN_PERCENTILE,\n                          n_bins=N_BINS)\n    # Adjust a linear model from the lower envelope\n    lm = st.linregress(xs, ys)\n    # Plot the linear model\n    fig.add_trace(go.Scatter(x=xs, y=lm.intercept + lm.slope * xs, name=f\"Fit {site}\", mode=\"lines\")) \n\n    # Derive the Monteith and Leuning stomata parameters\n    n_cases[site] = np.sum(valid)\n    gm[site] = 1. / lm.slope\n    t_m[site] = 1. / lm.intercept\n    d_0[site] = monteith_2_leuning(gm[site], t_m[site], p=np.nanmean(ec_all.loc[valid, \"PA\"]))\n    fig.add_trace(go.Scatter(x=1. / ec_all.loc[valid, \"VPD_MMOL\"], y=1. / ec_all.loc[valid, \"LE_C_MMOL\"], name=site, mode=\"markers\"))  \n\nfig.update_layout(title_text=f\"Derivation of Stomata parameters\", \n                  xaxis_title=\"1/VPD (mol mmol-1)\", yaxis_title=\"1/T (s m2 mmol-1)\",\n                  yaxis_range=[0, 0.5], xaxis_range=[0.01, 0.1])\n\n","key":"CH0zEvsZnp"},{"type":"output","id":"-1h4cgdpy0-hYLmAMGCoQ","data":[],"key":"qTm4Yf9S35"}],"key":"JQTk2MF4T5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from tabulate import tabulate\ntable = [#[\"N cases\"] + [value for key, value in n_cases.items()],\n         [\"$g_m$ mol m$^{{-2}}$ s$^{{-1}}$\"] + [value for key, value in gm.items()],\n         [\"$T_m$ mmol m$^{{-2}}$ s$^{{-1}}\"] + [value for key, value in t_m.items()],\n         [\"$D_0$ hPa\"] + [value for key, value in d_0.items()]]\n\nprint(tabulate(table, headers=[\"Parameter\"] + [i for i in gm.keys()]))","key":"F3aBPU5aVU"},{"type":"output","id":"fgGfgcog81IfJEemMfQ2M","data":[],"key":"mRXcJz91Ai"}],"key":"QtfpF9EL1m"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Implementation with actual data in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LBBXCTtFps"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"pyTSEB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TPgXaP033V"}],"urlSource":"https://github.com/hectornieto/pyTSEB","error":true,"key":"tQ9CoZk82o"}],"identifier":"implementation-with-actual-data-in-pytseb","label":"Implementation with actual data in pyTSEB","html_id":"implementation-with-actual-data-in-pytseb","implicit":true,"key":"u90dLFRVVJ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"As with the previous exercices, we will work with any of the sites of GRAPEX, using the micrometeorological measurements and Earth Observation LAI.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bt7otqwP10"}],"key":"pnnUrsNiku"},{"type":"container","kind":"table","children":[{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"table","label":"tab-site-description","identifier":"tab-site-description","html_id":"tab-site-description","enumerator":"1","children":[{"type":"text","value":"Table ","key":"g2s3Swmr8w"},{"type":"text","value":"1","key":"s9D279Hr8G"},{"type":"text","value":":","key":"bYCZ7X0nL4"}],"template":"Table %s:","key":"WahD54G6SA"},{"type":"text","value":"Description of GRAPEX sites","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gUZ4NmMJ8s"}],"key":"TrA4fHGIsX"}],"key":"KVO0ssXHDR"},{"type":"table","position":{"start":{"line":9,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Site","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"idCUi7KUGc"}],"key":"pVjbw8MeQ5"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Latitude","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"C78AKnmz9m"}],"key":"awz3sHRMLV"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Longitude","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Z2XVVrSG1E"}],"key":"WtFYYODpic"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Elevation (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"DMQGg0457i"}],"key":"CmmQbB01bl"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Row direction (deg.)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Px5FpGilAY"}],"key":"XBDPoNUKjm"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Row spacing (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hAcekrNRvL"}],"key":"lByZ9PrgJX"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Min. height (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"zzV7Xs7MUd"}],"key":"xcKc6C7UDp"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Max. height (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"M0LCSjFGhX"}],"key":"NW7w5jfRTH"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Min. width (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"JxNcFQxNyI"}],"key":"K3NGLSiIA2"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Max. width (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"wZ4ugNdS1T"}],"key":"Gdz4JZHiEL"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"TA height (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"QSFDdil8em"}],"key":"yJKgeA4bJf"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"WS height (m)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"rC6lGTpOlT"}],"key":"ePSvuY7mxm"}],"key":"KnNYYn7zhh"},{"type":"tableRow","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Ripperdan 720-1","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"BLdTVWaGhI"}],"key":"TQsPBIu2ig"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"36.849","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"gUMWml5ZZU"}],"key":"xmCmtYxulO"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"-120.176","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"v8vwI0SI6Q"}],"key":"Z2psxfNhfM"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"61","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"GCmCINNnfw"}],"key":"A5gt1Jsx1o"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"YE6mZlhJhX"}],"key":"QxPIwyn6Xn"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"sBm9BZalws"}],"key":"wfzlnFBqSV"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"o1jqSD9SyQ"}],"key":"bhwdpMfaNn"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"2.2","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"tO0hfljYwQ"}],"key":"ROoxCBcoK2"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Wp6VFTAVgg"}],"key":"e7rELdctmY"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"wNBf3zd7Cx"}],"key":"sdW0WYJgtu"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"vlAWRjIeq2"}],"key":"Q1yTAwbJ2Q"},{"type":"tableCell","align":"right","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Rw2dDDqpid"}],"key":"LPuHSof96s"}],"key":"UCof3Y4Qex"},{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Ripperdan 720-2","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Pghem8tECN"}],"key":"PlWZqhw1Jb"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"36.849","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"KsF6pz6Jf9"}],"key":"kjozzRIQSz"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"-120.174","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"MhsyCwCiSj"}],"key":"lPCP7zPOjj"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"61","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"iddh6fOecQ"}],"key":"UYxCBLlaz9"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"g4K5vafFDx"}],"key":"hgt7FRX0Ds"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"jQtsZOHyBp"}],"key":"LYHNbGGpYL"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"eWqRxaWgmK"}],"key":"oRr2Z1ojJL"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"2.2","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"pjZTVWoK0L"}],"key":"GA7L3xuQE7"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"cIHK4WZih3"}],"key":"gHcsQke7Pm"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"sUE14GFHiS"}],"key":"bXro7wHQE2"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"D6TlAKMQfy"}],"key":"Mz8u7O2BNV"},{"type":"tableCell","align":"right","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"DYZpHJb7LX"}],"key":"q7PhIIZSvl"}],"key":"sBtxiSrHF4"},{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Ripperdan 720-3","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"nyy9QW7b2W"}],"key":"EWAUHg6un6"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"36.848","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"PMIk2jW0X1"}],"key":"U4nvkurZs3"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"-120.176","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Fi3lOJiNEn"}],"key":"PQ6uCmoY6y"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"61","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"C1P8hpcNIe"}],"key":"tzHuh7HMu1"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"SSIOi6nLOI"}],"key":"B86dEfwb83"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"aXyCd24G51"}],"key":"bigjbBvw0z"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"DNGT7nqMpd"}],"key":"isy8jXvw2o"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"2.2","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"QgjtNHwYfa"}],"key":"JgxT6BitJ2"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"rzMp4fW10T"}],"key":"T0qRrrcgYD"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Pt6pVRjjh6"}],"key":"fCeu4LJ3Ky"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"o5pkzXlNsv"}],"key":"UDAm1G0nne"},{"type":"tableCell","align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"bG6X1fxxcO"}],"key":"cKUTDBgi2B"}],"key":"dFZcI7ItYQ"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Ripperdan 720-4","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"cXoNZgp9qM"}],"key":"GbhdOqWsZm"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"36.848","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"y0PDB6wdTk"}],"key":"uMGyGox0cO"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"-120.174","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"q6XSSycw7y"}],"key":"xZrrsvlADq"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"61","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"IQ1swoJGL8"}],"key":"TEV8wLHV5l"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"CmDi1PNkn6"}],"key":"QkRU2QxK5N"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"YWHc1gA3PZ"}],"key":"IORrfnWSOP"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ecH6CKeUOl"}],"key":"gEL78Gn86M"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"2.2","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ovvdwqczr3"}],"key":"CtI19wGffe"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"K3wK0ziVtR"}],"key":"Pt6xbM3w7W"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Mkx7Bc3fbi"}],"key":"OSGR35Pza8"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"njrkb2StB4"}],"key":"gGp4g2p864"},{"type":"tableCell","align":"right","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"AyXSzNYlbn"}],"key":"ZTLGvfjC8I"}],"key":"z9SiLzUYt0"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Barrelli_007","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"VVhje64GOW"}],"key":"jtaCNVxrmi"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"38.753","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"irwXbuPDfn"}],"key":"EcleAMTTVg"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"-122.98","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"dXTHu7O4Hm"}],"key":"n4cSOiALf1"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"113","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"WUtPrb2oBA"}],"key":"gk3a9r9UrH"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"135","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"sQWqLlg0tO"}],"key":"v68r4csRgl"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"P5N34YGRQZ"}],"key":"ac8BZpScD1"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"1.25","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Wo8msomFmI"}],"key":"LqvFmyxClj"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"2.3","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"jPE8GFVVlq"}],"key":"A4pyWrvi6H"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"JbSfT99lDb"}],"key":"uTeUBIX8Cm"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"1.8","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"B0qg2E6AoY"}],"key":"gLzuPezM8L"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"nUrdez2H0R"}],"key":"Or0AlRTBkn"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"cWf4mOI0Ld"}],"key":"eTtcalZsNi"}],"key":"fG8hgTgAwd"},{"type":"tableRow","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Barrelli_012","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"tkR0yEXNi1"}],"key":"Rt9C0lJXd4"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"38.751369","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"SB1GWL6aG4"}],"key":"FMWDC5ufrd"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"-122.974658","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Q4ja9Oi0Bq"}],"key":"z1OdbkZdJI"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"112","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"JxIsL51myd"}],"key":"YCLMfF7mLS"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"45","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"B8sEnnZbFa"}],"key":"ZaeMXCqrUO"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"n7aTX3oaWr"}],"key":"B6gFyvxwfc"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"1.25","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"XrltuV3DyW"}],"key":"yZwTD8VOaK"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"2.3","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"XMFoDU2LuJ"}],"key":"zJ1hWJLgf9"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"cONwI67ipS"}],"key":"VKrD46zCRB"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"1.8","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"YBsCjKrUWw"}],"key":"QehYr5iwqV"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"4.4","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"lBRhsvekR2"}],"key":"rOtG6pGFsO"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"4.4","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"zTH8mZU4DQ"}],"key":"DcxYRD06fl"}],"key":"i089uf1rDV"},{"type":"tableRow","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Sierra Loma-north","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"d9TEXqFwGd"}],"key":"KA4vT5W8gq"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"38.289338","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"LyrC52nlEd"}],"key":"xDfe4KZFQd"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"-121.117764","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"CY2ydBBFln"}],"key":"kJCXlmM6x6"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"38","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"aqp7YVgSV9"}],"key":"xC4Iq3RKK3"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"EXVCuFP4R4"}],"key":"Rv0y1gw2R8"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"u7GO7fDBLG"}],"key":"C69TDUUJ17"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"1.42","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"scqDKG2lp9"}],"key":"XRQTPRAfFX"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"mlmmDEyk2j"}],"key":"IKItXfX9OC"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"zIITnbS6Dy"}],"key":"a9QAfps19D"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"2.6","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"CyA2tSqKFy"}],"key":"g68py4ZdlS"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"uTeNXiQsSP"}],"key":"TFbTv2c2to"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"KDm626ZkWS"}],"key":"TtG4lLwY1L"}],"key":"DqvkkKsTUL"},{"type":"tableRow","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Sierra Loma-south","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"qYsudblH5v"}],"key":"rsTfaiSr0M"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"38.280488","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"RHxW6AQYl3"}],"key":"xyZa3pQMsy"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"-121.117597","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"DljJNJ34ZI"}],"key":"Uz1qADE78f"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"37","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"gtDlOA1cXG"}],"key":"TFXSaK21M8"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"wgPPPALWbF"}],"key":"jWSA1LSZ9V"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"hFrvARNjGG"}],"key":"sX75TlwB9n"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"1-42","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"KJrDlWJZfz"}],"key":"p4rCpuM6mR"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"qdkkfWksQR"}],"key":"xoH5Y7qbT7"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"qHGJMEvfRU"}],"key":"pMYm8SgAm9"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"MdCuTTSiep"}],"key":"ESHu2iLPZj"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"cXEGphlLr9"}],"key":"ouWBD8jZ3r"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"fNIwDGlRl9"}],"key":"hhK8onFXBE"}],"key":"DoGQOkASGC"},{"type":"tableRow","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Ripperdan 760","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"dAS0FGuHke"}],"key":"jMPtsb70N5"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"36.839025","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"H53YEkyBsx"}],"key":"MmLq3nVofC"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"-120.21014","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Rtdk1QNpeA"}],"key":"o4dCB2ds9C"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"58","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"U4rJFps6nt"}],"key":"fUMwtykyJ2"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"RdXs4r3Nno"}],"key":"FOYFtw1JPS"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"2.74","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"mjX9lyscwi"}],"key":"lRZuRb8HmG"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Xy8jjOzHWU"}],"key":"uezkNw77ac"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"2.5","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"y7yQrusoWf"}],"key":"RMeR6uxN7V"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"CiDx6iCxJZ"}],"key":"Dz5MJJQ5Cb"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"1.8","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"k1U0CLW9RV"}],"key":"QItAqWzMyh"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"5.5","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"STeLxPgxyy"}],"key":"ATkxnXamBZ"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"MXPhBdVRv7"}],"key":"vAIAVbCSZv"}],"key":"R5dzy5P8OT"},{"type":"tableRow","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Barrelli_016","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"OYiE5HK0aa"}],"key":"ekJL0HWeww"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"38.747","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ZofEmrtKbX"}],"key":"SUXLAth6UI"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"-122.963","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"lTPdxa9U46"}],"key":"nlIToh8w2i"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"112","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"AiSqmo8N8q"}],"key":"mue6Np6Qle"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"135","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Q1YkHaJHFP"}],"key":"FzP5dXL0v0"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"P2plIn6f0S"}],"key":"HVsytCQLoy"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"1.25","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"hk2fkFFLZT"}],"key":"Qi9AVKiuJI"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"2.3","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"bHQCYQLubh"}],"key":"Mj1t8611jp"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"gTEmpZTegX"}],"key":"QZ2qiGbIa5"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"1.8","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"n4Sb1BROdv"}],"key":"CkdLiTeQSB"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"xAvPM9pGPF"}],"key":"Qaji0soSuR"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"buiVxAjsLE"}],"key":"c1cPiTOX2W"}],"key":"jDuKjTHMC6"}],"key":"hY9Zxi2gri"}],"label":"tab-site-description","identifier":"tab-site-description","enumerator":"1","html_id":"tab-site-description","key":"MPIrE40wjW"},{"type":"heading","depth":3,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Select a site","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"ezngK5LWtI"}],"identifier":"select-a-site","label":"Select a site","html_id":"select-a-site","implicit":true,"key":"kUKEZYt6Gm"}],"key":"mklQSrumEE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"w_site = widgets.Dropdown(\n    options=[('Sierra Loma N', \"slmN\"), ('Sierra Loma S', \"slmS\"), \n             ('Barrelli 007', \"bar007\"), ('Barrelli 012', \"bar012\"),\n             ('Ripperdan 760', \"rip760\"), \n             ('Ripperdan 720-1', \"rip720_1\"),  ('Ripperdan 720-2', \"rip720_2\"),  ('Ripperdan 720-3', \"rip720_3\"),  ('Ripperdan 720-4', \"rip720_4\")],\n    value=\"rip760\",\n    description='Site:',\n)\ndisplay(w_site)","key":"ZPMpw6cFTa"},{"type":"output","id":"575nTi5ZmOH5nla7ow1Fq","data":[],"key":"mDQO6nRbKJ"}],"key":"WUM73UgZ8S"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Read the LAI and Micrometeorology data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o7ZZUT3htn"}],"identifier":"read-the-lai-and-micrometeorology-data","label":"Read the LAI and Micrometeorology data","html_id":"read-the-lai-and-micrometeorology-data","implicit":true,"key":"wgO9cd5jUQ"}],"key":"DeZnBlzLNw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Import Python libraries\nfrom pathlib import Path\nimport pandas as pd\n\n# Set the LAI and readiation folders\ninput_dir = Path().absolute() / \"input\"\nlai_dir = input_dir / \"canopy\"\nec_dir = input_dir / \"meteo\"\n# Set the input files based on the chosen site\nlai_filename = lai_dir / f\"FLX_US-{w_site.value}_FLUXNET2015_AUXCANOPY_DD.csv\"\nec_filename = ec_dir / f\"FLX_US-{w_site.value}_FLUXNET2015_SUBSET_HR.csv\"\nprint(f\"LAI file path is {lai_filename}\")\nprint(f\"EC file path is {ec_filename}\")\n\n# Read the LAI and radiation tables\nlai = pd.read_csv(lai_filename, sep=\";\", na_values=-9999)\nec = pd.read_csv(ec_filename, sep=\";\", na_values=-9999)\n\n# Merge both tables by date\nec[\"TIMESTAMP\"] = pd.to_datetime(ec[\"TIMESTAMP\"], format=\"%Y%m%d%H%M\")\nlai[\"DATE\"] = pd.to_datetime(lai[\"TIMESTAMP\"], format=\"%Y%m%d\").dt.date\nlai = lai.drop(labels=[\"TIMESTAMP\"], axis=1)\nec[\"DATE\"] = ec[\"TIMESTAMP\"].dt.date\nec = ec.merge(lai, on=\"DATE\")\n\n# We discard all cases at night (SW_IN <=0)\nec = ec[ec[\"SW_IN\"] > 0]\n\n# Convert Celsius to Kelvin\nec[\"TA\"] = ec[\"TA\"] + 273.15\n# Convert kPa to hPa\nec[\"PA\"] = 10 * ec[\"PA\"]\n\n# Evaluate different energy balance closure corrections\nec[\"H_RES\"] = ec[\"NETRAD\"] - ec[\"G\"] - ec[\"LE\"]\nec['LE_RES'] = ec['NETRAD'] - ec['G'] - ec['H']\nec[\"LE_BR\"], ec[\"H_BR\"] = TSEB.met.bowen_ratio_closure(ec[\"NETRAD\"], ec[\"G\"],\n                                                       ec[\"H\"], ec[\"LE\"])\n# Mean of uncorrected, ressidual and Bowen Ratio\nec[\"H_ENS\"] = np.nanmean([ec[\"H_RES\"], ec[\"H_BR\"], ec['H']], axis=0)\nec[\"LE_ENS\"] = np.nanmean([ec[\"LE_RES\"], ec[\"LE_BR\"], ec['LE']], axis=0)","key":"t9VkqOn1my"},{"type":"output","id":"Oc-hsl51UCYC_vsEH7ONt","data":[],"key":"RiGo3OgjyE"}],"key":"up7oni1lFc"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Set the stomata sensitivty to VPD","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cIWuPL0daI"}],"identifier":"set-the-stomata-sensitivty-to-vpd","label":"Set the stomata sensitivty to VPD","html_id":"set-the-stomata-sensitivty-to-vpd","implicit":true,"key":"vorVVyXCWH"}],"key":"ilW9tG4t2j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"style = {'description_width': 'initial'}\nw_d_0 = widgets.BoundedFloatText(min=0.01, max=20, value=16.93, description=\"$D_0$ (hPa)\", step=0.1, style=style)\nw_g_m = widgets.BoundedFloatText(min=0.01, max=1, value=0.53, description=\"$g_m$ (mol m$^{-2}$ s$^{-1}$)\", step=0.01, style=style)\ndisplay(w_d_0, w_g_m)","key":"RiZs1hnEFP"},{"type":"output","id":"_nEtufvoftAlhqBgoJ50l","data":[],"key":"JTaHQtM1Lj"}],"key":"SdWCsO5ddm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get the canopy a priori structural properties","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VP2ChKTF9m"}],"identifier":"get-the-canopy-a-priori-structural-properties","label":"Get the canopy a priori structural properties","html_id":"get-the-canopy-a-priori-structural-properties","implicit":true,"key":"T6PEZ07qel"}],"key":"HPTtDg46Nq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import yaml\nyaml_file = input_dir / \"site_description.yaml\"\nsite_dict = yaml.safe_load(yaml_file.read_text())\nlat = float(site_dict[\"lat\"][w_site.value])\nlon = float(site_dict[\"lon\"][w_site.value])\nelev = float(site_dict[\"elev\"][w_site.value])\nrow_direction = float(site_dict[\"row_direction\"][w_site.value])\ninterrow = float(site_dict[\"interrow\"][w_site.value])\nhc_min = float(site_dict[\"hc_min\"][w_site.value])\nhc_max = float(site_dict[\"hc_max\"][w_site.value])\nwc_min = float(site_dict[\"wc_min\"][w_site.value])\nwc_max = float(site_dict[\"wc_max\"][w_site.value])\nzh = float(site_dict[\"zh\"][w_site.value])\nzm = float(site_dict[\"zm\"][w_site.value])\n\nprint(f\"{w_site.label} has the following site characteristics:\\n\"\n      f\"\\t Latitude: {lat} deg. \\n\"\n      f\"\\t Longitude: {lon} deg. \\n\"\n      f\"\\t Elevation: {elev} m \\n\"\n      f\"\\t Row direction: {row_direction} deg. \\n\"\n      f\"\\t Row spacing: {interrow} m \\n\"\n      f\"\\t Min. canopy height: {hc_min} m \\n\"\n      f\"\\t Max. canopy height: {hc_max} m \\n\"\n      f\"\\t Min. canopy width: {wc_min} m \\n\"\n      f\"\\t Max. canopy width: {wc_max} m \\n\"\n      f\"\\t Air temperature measurement height: {zh} m \\n\"\n      f\"\\t Wind speed temperature measurement height: {zh} m\"\n)","key":"lMxf6sOxlB"},{"type":"output","id":"Ia5VwyI9ct9Doyccfl0Ow","data":[],"key":"BGJgRSMG6f"}],"key":"jvu331W7Ml"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Estimate the structural variables based on Earth Observation LAI timeseries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iHhixR1TxE"}],"identifier":"estimate-the-structural-variables-based-on-earth-observation-lai-timeseries","label":"Estimate the structural variables based on Earth Observation LAI timeseries","html_id":"estimate-the-structural-variables-based-on-earth-observation-lai-timeseries","implicit":true,"key":"QNEBLRJNWy"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"As with the previous exercise, we will estimate timeseries of canopy structural variables based on LAI and empirical observations of trellis development.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ua4XH2rjrw"}],"key":"AxtBo01QWi"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/vineyard_structural_-59f51fdb831e95cbac9c5249ce0cd27d.png","alt":"Empirical structural functions","key":"dau44hBrTL","urlSource":"./input/figures/vineyard_structural_functions.png","urlOptimized":"/vineyard_structural_-59f51fdb831e95cbac9c5249ce0cd27d.webp"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"structural-functions","identifier":"structural-functions","html_id":"structural-functions","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"uCsAzuy2Ok"},{"type":"text","value":"2","key":"RhHADJ1WrO"},{"type":"text","value":":","key":"Q1SzobVW28"}],"template":"Figure %s:","key":"DHOCpDNApk"},{"type":"text","value":"Empirical models relating canopy height , canopy width and the bottom of the canopy with the fused STARFM LAI. Solid dots represent in situ measured values","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FMLDSMfsqB"}],"key":"cjjKx3o39x"}],"key":"SAzgvYf7AH"}],"label":"structural-functions","identifier":"structural-functions","enumerator":"2","html_id":"structural-functions","key":"DGgg3mHAkQ"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"These empirical equations are coded in Python as:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"dPZhI8naFV"}],"key":"VM52XOP0x8"}],"key":"rsJcUyPDl3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\n\n################################################################################\n# Empirical equations to generate canopy structural parameters from LAI\n################################################################################\ndef lai_2_hc(lai, hc_min):\n    slope = 0.42\n    hc = hc_min + slope * lai\n    return hc\n\n\ndef lai_2_hbratio(lai, hc_min):\n    hb_ratio_mean = 0.4848388065\n    hb_ratio = np.zeros(lai.shape)\n\n    hb_ratio[lai < hc_min] = 1. + ((hb_ratio_mean - 1.) / hc_min) * lai[\n        lai < hc_min]\n    hb_ratio[lai >= hc_min] = hb_ratio_mean\n\n    return hb_ratio\n\n\ndef lai_2_width(lai, wc_min, wc_max):\n    beta = 6.96560056\n    offset = 1.70825736\n\n    width = wc_min + (wc_max - wc_min) / (1.0 + np.exp(-beta * (lai - offset)))\n\n    return width\n\n\ndef lai_2_fcover(lai, fc_min, fc_max):\n    beta = 7.0\n    offset = 1.70\n\n    fcover = fc_min + (fc_max - fc_min) / (1.0 + np.exp(-beta * (lai - offset)))\n\n    return fcover\n\n\ndef lai_2_canopy(lai, hc_min, fc_min, fc_max):\n    hc = lai_2_hc(lai, hc_min)\n    hb_ratio = lai_2_hbratio(lai, hc_min)\n    fcover = lai_2_fcover(lai, fc_min, fc_max)\n\n    return hc, hb_ratio, fcover","key":"VOKe4rTnhY"},{"type":"output","id":"1TopEE2bIcH2eKcT_dv6t","data":[],"key":"WPWzjwlCgn"}],"key":"wLQj185v5s"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From these empirical functions together with the site description properties described in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ipvJYGp0DB"},{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Site Description","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ds4ETn5tWP"}],"identifier":"site-description","label":"site-description","kind":"heading","template":"{name}","resolved":true,"html_id":"site-description","remote":true,"url":"/seb-introduction","dataUrl":"/seb-introduction.json","key":"SG2gZJRBL3"},{"type":"text","value":" we can caluculate the time series of canopy structural variables needed to compute the shadowing as shown in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jnGzUbYCh3"},{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Figure ","key":"kGz8yJQzCg"},{"type":"text","value":"1","key":"Rbv8w0JZ76"}],"identifier":"row-crop-model","label":"row-crop-model","kind":"figure","template":"Figure %s","enumerator":"1","resolved":true,"html_id":"row-crop-model","remote":true,"url":"/b01-row-crops","dataUrl":"/b01-row-crops.json","key":"QpBMohgyRC"}],"key":"cXagGucP49"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"KGL2Ku3qC5"}],"key":"w2GlCy0vCO"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"These equations are site specific and most likely not applicable to other sites and crops. For operational purposes, such as using Earth Observation/satellite data a trade-off must be made between accuracy and applicability.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CBK56lwlHb"}],"key":"QmP2jWNzfo"}],"class":"dropdown","key":"vflD2Na4jy"}],"key":"XveUzOFuRj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Compute the expected minimum and maximum canopy cover based on mininum and maximum canopy width\nfc_min = wc_min / interrow\nfc_max = wc_max / interrow\nh_c, hb_ratio, f_c = lai_2_canopy(ec[\"LAI\"].values,\n                                  hc_min,\n                                  fc_min,\n                                  fc_max)\n\n# Ensure that both canopy height and cover are within the limits\nh_c = np.clip(h_c, hc_min, hc_max)\nf_c = np.clip(f_c, 0, 1)","key":"MNkMfsWp4U"},{"type":"output","id":"DxWE7YRGceSz_B2f1jE0M","data":[],"key":"LpBxOpJAFp"}],"key":"YAhxNAE6k2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can get the shortwave net radiation for row crops","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UR7doWw2iQ"}],"identifier":"we-can-get-the-shortwave-net-radiation-for-row-crops","label":"We can get the shortwave net radiation for row crops","html_id":"we-can-get-the-shortwave-net-radiation-for-row-crops","implicit":true,"key":"exQvuRryOi"}],"key":"jHp5YmkZfq"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from pyTSEB import TSEB\n\n# We can get the leaf and soil spectral from the values above, or hard code the corresponding values\nrho_leaf_vis = 0.054\nrho_leaf_nir = 0.262\ntau_leaf_vis = 0.038\ntau_leaf_nir = 0.333\nrho_soil_vis = 0.07\nrho_soil_nir = 0.32\n\n# canopy width\nw_c = f_c * interrow\n# Canopy width to height ratio\nw_c_ratio = w_c / (h_c - hb_ratio * h_c)\n# Local LAI\nF = ec[\"LAI\"].values / f_c\n\n# The time zone is PST, which corresponds to -120 deg, time longitude\nstdlon = -120\n# Call calc_sun_angles based on site coordinates and timestamp\nsza, saa = TSEB.met.calc_sun_angles(\n    np.full_like(ec['LAI'].values, lat),\n    np.full_like(ec[\"LAI\"].values, lon),\n    np.full_like(ec[\"LAI\"].values, stdlon),\n    ec['TIMESTAMP'].dt.dayofyear.values,\n    ec['TIMESTAMP'].dt.hour.values + ec['TIMESTAMP'].dt.minute.values / 60.)\n\n# Compute the relative sun-row azimuth angle\npsi = row_direction - saa\n# Compute the clumping index for row crops\nomega = TSEB.CI.calc_omega_rows(ec[\"LAI\"], f_c, theta=sza,\n                                psi=psi, w_c=w_c_ratio)\n\n# And the effective LAI is the product of local LAI and the clumping index\nlai_eff = F * omega\n\n# Estimates the direct and diffuse solar radiation\ndifvis, difnir, fvis, fnir = TSEB.rad.calc_difuse_ratio(ec[\"SW_IN\"].values,\n                                                        sza,\n                                                        press=np.full_like(sza, 1013.15))\npar_dir = fvis * (1. - difvis) * ec[\"SW_IN\"].values\nnir_dir = fnir * (1. - difnir) * ec[\"SW_IN\"].values\npar_dif = fvis * difvis * ec[\"SW_IN\"].values\nnir_dif = fnir * difnir * ec[\"SW_IN\"].values\n\n# Compute the canopy and soil net radiation using Cambpell RTM\nsn_c, sn_s = TSEB.rad.calc_Sn_Campbell(ec[\"LAI\"].values,\n                                       sza,\n                                       par_dir + nir_dir,\n                                       par_dif + nir_dif,\n                                       fvis,\n                                       fnir,\n                                       np.full_like(sza, rho_leaf_vis),\n                                       np.full_like(sza, tau_leaf_vis),\n                                       np.full_like(sza, rho_leaf_nir),\n                                       np.full_like(sza, tau_leaf_nir),\n                                       np.full_like(sza, rho_soil_vis),\n                                       np.full_like(sza, rho_soil_nir),\n                                       x_LAD=1,\n                                       LAI_eff=lai_eff)\n\nsn_c[~np.isfinite(sn_c)] = 0\nsn_s[~np.isfinite(sn_s)] = 0","visibility":"show","key":"YGFlVPL6uP"},{"type":"output","id":"sQdAbVq1813b6e3Bnwpqr","data":[],"visibility":"show","key":"W7y1RJvKeh"}],"visibility":"show","key":"daFynaXxzK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evaluate the shortwave net radiation estimates","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tXv4m4OjlJ"}],"identifier":"evaluate-the-shortwave-net-radiation-estimates","label":"Evaluate the shortwave net radiation estimates","html_id":"evaluate-the-shortwave-net-radiation-estimates","implicit":true,"key":"CeYAV2LfaV"}],"key":"PFGJQG09It"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from model_evaluation import double_collocation as dc\ndaytime = ec[\"SW_IN\"] > 100\n\nsn_model = sn_c + sn_s\nsn_obs = ec[\"SW_IN\"].values - ec[\"SW_OUT\"].values\n\nfig = go.Figure()\nfig.add_trace(go.Scattergl(x=sn_model[daytime], y=sn_obs[daytime], \n                         name=\"Sn for row crops\", mode=\"markers\"))\nfig.add_trace(go.Scatter(x=[0, 1000], y=[0, 1000], mode=\"lines\", name=\"1:1 line\", line={\"color\": \"black\", \"dash\": \"dash\"}))\nfig.update_layout(title_text=f\"Observed vs. Estimated below net radiation at {w_site.label}\",\n                  yaxis_range=[0, 1000], xaxis_range=[0, 1000],\n                  xaxis_title=\"Estimated (W m-2)\", yaxis_title=\"Observed (W m-2)\")","visibility":"show","key":"kjLnOi2vau"},{"type":"output","id":"b2yKiWwU4KRkyF8X3ozDx","data":[],"visibility":"show","key":"k0ALzNvsfw"}],"visibility":"show","key":"JWzHSvrXX9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Set additional site parameters needed for TSEB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VcP7tvFzmX"}],"identifier":"set-additional-site-parameters-needed-for-tseb","label":"Set additional site parameters needed for TSEB","html_id":"set-additional-site-parameters-needed-for-tseb","implicit":true,"key":"fktSnUrE10"}],"key":"yUfGDkF1pj"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Grapevine leaf width\nleaf_width = 0.10\n\n# Roughness for bare soil\nz0_soil = 0.15\n\n# Kustas and Norman boundary layer resistance parameters\nroil_resistance_c_param = 0.0038\nroil_resistance_b_param = 0.012\nroil_resistance_cprime_param = 90.\n# Thermal spectra\ne_v = 0.99  # Leaf emissivity\ne_s = 0.94  # Soil emissivity\n\n# Resistance for soil evaporation of a well watered situation\nrss_min = 0  # Asumme initial free water evaporation","visibility":"show","key":"u2MpwCeRNl"},{"type":"output","id":"1lBpxnAz-KZBLfYDcVkwu","data":[],"visibility":"show","key":"GTDgrX0bu3"}],"visibility":"show","key":"Gp2ClO2qn4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Estimate surface aerodynamic roughness","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mgGZlgMUyn"}],"identifier":"estimate-surface-aerodynamic-roughness","label":"Estimate surface aerodynamic roughness","html_id":"estimate-surface-aerodynamic-roughness","implicit":true,"key":"mfQl5lD58k"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We estimate aerodynamic roughness for tall canopies based on ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"IC7WYuaemJ"},{"type":"cite","url":"https://doi.org/10.1007/BF00709229","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Raupach (1994)","key":"yDy7ZNAbmj"}],"kind":"narrative","label":"Raupach_1994","identifier":"https://doi.org/10.1007/BF00709229","enumerator":"9","key":"NY3doouFLE"},{"type":"text","value":" and ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Hd6E1lOi7x"},{"type":"link","url":"https://doi.org/10.1016/S0168-1923(00)00153-2.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[],"urlSource":"http://dx.doi.org/10.1016/S0168-1923(00)00153-2.","data":{"doi":"10.1016/S0168-1923(00)00153-2."},"internal":false,"protocol":"doi","key":"ZETlihrUHZ"},{"type":"text","value":":","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"D8P3Xa6uy3"}],"key":"Uh7p3HSQvN"}],"key":"ODKOptCdW0"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"z_0m, d_0 = TSEB.res.calc_roughness(ec[\"LAI\"], h_c, w_c_ratio, np.full_like(ec[\"LAI\"], TSEB.res.BROADLEAVED_D), f_c=f_c)\n# Ensure realistic values\nd_0[d_0 < 0] = 0\nz_0m[np.isnan(z_0m)] = z0_soil\nz_0m[z_0m < z0_soil] = z0_soil","visibility":"show","key":"gy4rV64ODv"},{"type":"output","id":"IqhuAVkuIVUd3bMhx8uCK","data":[],"visibility":"show","key":"P17rz9tMkc"}],"visibility":"show","key":"YrXF7GVHGg"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We derive the half-hourly LST based on pyrgeomters on the EC tower","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tnfhSXHXpT"}],"identifier":"we-derive-the-half-hourly-lst-based-on-pyrgeomters-on-the-ec-tower","label":"We derive the half-hourly LST based on pyrgeomters on the EC tower","html_id":"we-derive-the-half-hourly-lst-based-on-pyrgeomters-on-the-ec-tower","implicit":true,"key":"u0nA6Yzeak"}],"visibility":"show","key":"GvbDdGvnYU"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Surface emissivity\ne_surf = f_c * e_v + (1. - f_c) * e_s\n\n# LST from longwave radiometers\nlst = ((ec['LW_OUT'].values - (1. - e_surf) * ec['LW_IN'].values) / (\n        TSEB.rad.SB * e_surf)) ** 0.25\n\n# And it is assuming that the radiometer is looking at nadir\nvza = np.zeros_like(lst)","visibility":"show","key":"O1vJj5IOt7"},{"type":"output","id":"vmdFUXQIyW7eSCWdG9Dwo","data":[],"visibility":"show","key":"mpoYASsoW3"}],"visibility":"show","key":"DdYPoV2nld"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We run now TSEB-SW","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z3ZMfpqYXd"}],"identifier":"we-run-now-tseb-sw","label":"We run now TSEB-SW","html_id":"we-run-now-tseb-sw","implicit":true,"key":"pklhj49vCN"},{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"See Also","key":"lnLZv2CowI"}],"key":"ijS1qezYzx"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The full code for the Shuttleworth and Wallace model is at the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FmeFhXB2Ev"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L946","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"pyTSEB GitHub repository","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZrJi0QdLZf"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L946","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/TSEB.py","from":946,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py"},"internal":false,"protocol":"github","key":"FGo7mPl0Yk"}],"key":"r63jyf0hxt"}],"class":"dropdown","key":"Iz4hvmjS3s"}],"key":"UMw7Q4z349"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Initialize the potential stomtal conductance by a minimum value\ngs = np.full_like(lst, 0.01)\n\n# Update the  potential stomtal conductance for daytime\ngs[daytime] = w_g_m.value * leuning_stress(ec[\"VPD\"][daytime],  w_d_0.value)\n\n# Convert stomtata conductance to resistance (s m-1)\nrst_min = 1. / (TSEB.res.molm2s1_2_ms1(ec[\"TA\"].values, ec[\"PA\"].values) * gs)\nrst_min[rst_min < 0] = np.nan\n\nresistance_flag = [0, {\"KN_c\": np.full_like(lst, roil_resistance_c_param),\n                       \"KN_b\": np.full_like(lst, roil_resistance_b_param),\n                       \"KN_C_dash\": np.full_like(lst, roil_resistance_cprime_param)}]\n\n# Run TSEB-SW\n[flag_sw, ts_sw, tc_sw, t_ac_sw, ln_s_sw, ln_c_sw, le_c_sw, h_c_sw, le_s_sw, h_s_sw, g_sw,\n r_s_sw, r_x_sw, r_a_sw, rss_sw, rst_sw, u_friction_sw, lmo_sw, n_iterations_sw] = TSEB.TSEB_SW(                                                     \n     lst,\n     vza,\n     ec[\"TA\"].values,\n     ec[\"WS\"].values,\n     ec[\"EA\"].values,\n     ec[\"PA\"].values,\n     sn_c,\n     sn_s,\n     ec[\"LW_IN\"].values,\n     ec[\"LAI\"].values,\n     h_c,\n     e_v,\n     e_s,\n     z_0m,\n     d_0,\n     zm,\n     zh,\n     x_LAD=np.ones_like(lst),\n     f_c=f_c,\n     f_g=np.ones_like(lst),\n     w_C=w_c_ratio,\n     leaf_width=leaf_width,\n     z0_soil=z0_soil,\n     Rst_min=rst_min,\n     Rss_min=rss_min,\n     resistance_form=resistance_flag,\n     calcG_params=[[1], 0.35])\n\n# ... and finally we compute the bulk fluxes\nle_sw = le_c_sw + le_s_sw\nh_sw = h_c_sw + h_s_sw\nnetrad_sw = sn_c + sn_s + ln_c_sw + ln_s_sw","visibility":"show","key":"CJkJDck0wg"},{"type":"output","id":"8yVXdJLjvmeO9ggLupg9F","data":[],"visibility":"show","key":"TPA1nyyLaZ"}],"visibility":"show","key":"Vxjvo4kAcz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"... and to compare we also run TSEB-PT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C04O5xotch"}],"identifier":"id-and-to-compare-we-also-run-tseb-pt","label":"... and to compare we also run TSEB-PT","html_id":"id-and-to-compare-we-also-run-tseb-pt","implicit":true,"key":"NlO2yKLF9m"}],"key":"GUoVvDXb5I"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Run TSEB-PT\nalpha_PT_0 = 1.26\n[flag_pt, ts_pt, tc_pt, t_ac_pt, ln_s_pt, ln_c_pt, le_c_pt, h_c_pt, le_s_pt, h_s_pt, g_pt,\n r_s_pt, r_x_pt, r_a_pt, u_friction_pt, lmo_pt, n_iterations_pt] = TSEB.TSEB_PT(                                                     \n     lst,\n     vza,\n     ec[\"TA\"].values,\n     ec[\"WS\"].values,\n     ec[\"EA\"].values,\n     ec[\"PA\"].values,\n     sn_c,\n     sn_s,\n     ec[\"LW_IN\"].values,\n     ec[\"LAI\"].values,\n     h_c,\n     e_v,\n     e_s,\n     z_0m,\n     d_0,\n     zm,\n     zh,\n     x_LAD=np.ones_like(lst),\n     f_c=f_c,\n     f_g=np.ones_like(lst),\n     w_C=w_c_ratio,\n     leaf_width=leaf_width,\n     z0_soil=z0_soil,\n     alpha_PT=alpha_PT_0,\n     resistance_form=resistance_flag,\n     calcG_params=[[1], 0.35])\n\n# ... and we compute the bulk fluxes\nle_pt = le_c_pt + le_s_pt\nh_pt = h_c_pt + h_s_pt\nnetrad_pt = sn_c + sn_s + ln_c_pt + ln_s_pt","visibility":"show","key":"TomkxcPXE8"},{"type":"output","id":"pUkICQPcWKZI92fc_HqN2","data":[],"visibility":"show","key":"m4MxId7wRL"}],"visibility":"show","key":"t6emjEMsIi"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"... and with TSEB-PM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pVhlFBiWbA"}],"identifier":"id-and-with-tseb-pm","label":"... and with TSEB-PM","html_id":"id-and-with-tseb-pm","implicit":true,"key":"s7kEOyMifx"}],"key":"tfWdcDYIy2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Run TSEB-PT\nr_c_min = rst_min / ec[\"LAI\"].values\n[flag_pm, ts_pm, tc_pm, t_ac_pm, ln_s_pm, ln_c_pm, le_c_pm, h_c_pm, le_s_pm, h_s_pm, g_pm,\n r_s_pm, r_x_pm, r_a_pm, u_friction_pm, lmo_pm, n_iterations_pm] = TSEB.TSEB_PM(                                                     \n     lst,\n     vza,\n     ec[\"TA\"].values,\n     ec[\"WS\"].values,\n     ec[\"EA\"].values,\n     ec[\"PA\"].values,\n     sn_c,\n     sn_s,\n     ec[\"LW_IN\"].values,\n     ec[\"LAI\"].values,\n     h_c,\n     e_v,\n     e_s,\n     z_0m,\n     d_0,\n     zm,\n     zh,\n     x_LAD=np.ones_like(lst),\n     f_c=f_c,\n     f_g=np.ones_like(lst),\n     w_C=w_c_ratio,\n     leaf_width=leaf_width,\n     z0_soil=z0_soil,\n     r_c_min=r_c_min,\n     resistance_form=resistance_flag,\n     calcG_params=[[1], 0.35])\n\n# ... and we compute the bulk fluxes\nle_pm = le_c_pm + le_s_pm\nh_pm = h_c_pm + h_s_pm\nnetrad_pm = sn_c + sn_s + ln_c_pm + ln_s_pm","key":"btKpYwgbUx"},{"type":"output","id":"MPRpX8rTJLR07cdnQPd3p","data":[],"key":"zI1oe0rKBC"}],"key":"yUyhJpu9qZ"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Finally we compare the different retrievals","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hker57nFRr"}],"identifier":"finally-we-compare-the-different-retrievals","label":"Finally we compare the different retrievals","html_id":"finally-we-compare-the-different-retrievals","implicit":true,"key":"nVzxKn2bij"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Select which method of EB correction you want to apply during the validation:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"vc7V8x5TpZ"}],"key":"hLl49b4LfJ"}],"visibility":"show","key":"Rz8wpg8nL4"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"w_ebc = widgets.Dropdown(\n    options=[('No EB correction', (\"LE\", \"H\")), \n             ('Residual to LE', (\"LE_RES\", \"H\")), \n             ('Residual to H', (\"LE_RES\", \"H\")), \n             ('Bowen Ratio', (\"LE_BR\", \"H_BR\")),\n             ('Ensemble correction', (\"LE_ENS\", \"H_ENS\"))],\n    value=(\"LE_ENS\", \"H_ENS\"),\n    description='EBC method:',\n)\ndisplay(w_ebc)","visibility":"show","key":"hzlvlkfy2q"},{"type":"output","id":"LDjhkOMhQWce8IiAOyi3f","data":[],"visibility":"show","key":"K3QKeHp7ym"}],"visibility":"show","key":"i1uhtEt4lq"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from model_evaluation import double_collocation as dc\nfrom tabulate import tabulate\nLE_OBS, H_OBS = w_ebc.value\nprint(f\"Using {LE_OBS} and {H_OBS} fields for validating respectively  LE and H\")\n\nle_marker = {\"color\": \"blue\", \"size\": 3}\nh_marker = {\"color\": \"red\", \"size\": 3}\ng_marker = {\"color\": \"green\", \"size\": 3}\nrn_marker = {\"color\": \"black\", \"size\": 3}\n\nfig = make_subplots(rows=1, cols=3,\n                    shared_yaxes=True,\n                    horizontal_spacing=0.01,\n                   subplot_titles=(\"TSEB-SW\", \"TSEB-PT\", \"TSEB-PM\"))\n\nvalid_sw = np.logical_and(flag_sw < 5, daytime)\nvalid_pt = np.logical_and(flag_pt < 5, daytime)\nvalid_pm = np.logical_and(flag_pm < 5, daytime)\n\n\nfig.add_trace(go.Scattergl(x=netrad_sw[valid_sw], y=ec.loc[valid_sw, \"NETRAD\"], \n                         name=\"Rn TSEB-SW\", mode=\"markers\", marker=rn_marker),\n             row=1, col=1)\n\nfig.add_trace(go.Scattergl(x=netrad_pt[valid_pt], y=ec.loc[valid_pt, \"NETRAD\"], \n                         name=\"Rn TSEB-PT\", mode=\"markers\", marker=rn_marker),\n             row=1, col=2)\n\nfig.add_trace(go.Scattergl(x=netrad_pm[valid_pm], y=ec.loc[valid_pm, \"NETRAD\"], \n                         name=\"Rn TSEB-Pm\", mode=\"markers\", marker=rn_marker),\n             row=1, col=3)\n\nfig.add_trace(go.Scattergl(x=g_sw[valid_sw], y=ec.loc[valid_sw, \"G\"], \n                         name=\"G TSEB-SW\", mode=\"markers\", marker=g_marker),\n             row=1, col=1)\n\nfig.add_trace(go.Scattergl(x=g_pt[valid_pt], y=ec.loc[valid_pt, \"G\"], \n                         name=\"G TSEB-PT\", mode=\"markers\", marker=g_marker),\n             row=1, col=2)\n\nfig.add_trace(go.Scattergl(x=g_pm[valid_pm], y=ec.loc[valid_pm, \"G\"], \n                         name=\"G TSEB-PM\", mode=\"markers\", marker=g_marker),\n             row=1, col=3)\n\nfig.add_trace(go.Scattergl(x=le_sw[valid_sw], y=ec.loc[valid_sw, LE_OBS], \n                         name=\"LE TSEB-SW\", mode=\"markers\", marker=le_marker),\n             row=1, col=1)\n\nfig.add_trace(go.Scattergl(x=le_pt[valid_pt], y=ec.loc[valid_pt, LE_OBS], \n                         name=\"LE TSEB-PT\", mode=\"markers\", marker=le_marker),\n             row=1, col=2)\n\nfig.add_trace(go.Scattergl(x=le_pm[valid_pm], y=ec.loc[valid_pm, LE_OBS], \n                         name=\"LE TSEB-Pm\", mode=\"markers\", marker=le_marker),\n             row=1, col=3)\n\nfig.add_trace(go.Scattergl(x=h_sw[valid_sw], y=ec.loc[valid_sw, H_OBS], \n                         name=\"H TSEB-SW\", mode=\"markers\", marker=h_marker),\n             row=1, col=1)\n\nfig.add_trace(go.Scattergl(x=h_pt[valid_pt], y=ec.loc[valid_pt, H_OBS], \n                         name=\"H TSEB-PT\", mode=\"markers\", marker=h_marker),\n             row=1, col=2)\n\nfig.add_trace(go.Scattergl(x=h_pm[valid_pm], y=ec.loc[valid_pm, H_OBS], \n                         name=\"H TSEB-PM\", mode=\"markers\", marker=h_marker),\n             row=1, col=3)\n\nfig.add_trace(go.Scatter(x=[-200, 800], y=[-200, 800], mode=\"lines\", name=\"1:1 line\", line={\"color\": \"black\", \"dash\": \"dash\"}),\n             row=1, col=1)\nfig.add_trace(go.Scatter(x=[-200, 800], y=[-200, 800], mode=\"lines\", name=\"1:1 line\", line={\"color\": \"black\", \"dash\": \"dash\"}),\n             row=1, col=2)\nfig.add_trace(go.Scatter(x=[-200, 800], y=[-200, 800], mode=\"lines\", name=\"1:1 line\", line={\"color\": \"black\", \"dash\": \"dash\"}),\n             row=1, col=3)\n\n\nfig.update_layout(title_text=f\"Observed vs. Estimated fluxes at {w_site.label}\",\n                  yaxis_range=[-200, 800], xaxis_range=[-200, 800], \n                  xaxis_title=\"Estimated (W m-2)\", yaxis_title=\"Observed (W m-2)\")\n","visibility":"show","key":"uNLAF6XMOX"},{"type":"output","id":"Z1Zjw07J2TGDbN9iawpRZ","data":[],"visibility":"show","key":"gp6r39lJpy"}],"visibility":"show","key":"qgSoDCSiMz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evaluate the errors in H and LE","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y4YETrCfvd"}],"identifier":"evaluate-the-errors-in-h-and-le","label":"Evaluate the errors in H and LE","html_id":"evaluate-the-errors-in-h-and-le","implicit":true,"key":"LbA1r9AOVW"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In this last step you can evaluate the error metric for both TSEB-SW and TSEB-PT models. In addition, you can filter by observed values of sensible heat flux to see better the performance of both models under advective condition, such as negative H at daytime.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"J8MmphVy8k"}],"key":"i8nHG6d1ga"}],"key":"GScmsOet9T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"w_h_lims = widgets.IntRangeSlider(value=[-200, 800], min=-200, max=800, step=1, description='Validate on a range for H:', \n                                  style={'description_width': 'auto'}, layout=widgets.Layout(width='50%'))\ndisplay(w_h_lims)","key":"elbU4vDzVs"},{"type":"output","id":"mMq_GCjElMlCacu5vu62L","data":[],"key":"Eyd14BmZI5"}],"key":"b8I5cOVqQY"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"\nvalid_sw_2 = np.logical_and.reduce((valid_sw, ec[H_OBS] >= w_h_lims.value[0], ec[H_OBS] <= w_h_lims.value[1]))\nvalid_pt_2 = np.logical_and.reduce((valid_pt, ec[H_OBS] >= w_h_lims.value[0], ec[H_OBS] <= w_h_lims.value[1]))\nvalid_pm_2 = np.logical_and.reduce((valid_pm, ec[H_OBS] >= w_h_lims.value[0], ec[H_OBS] <= w_h_lims.value[1]))\n\n\nh_sw_bias, h_sw_mae, h_sw_rmse = dc.error_metrics(ec.loc[valid_sw_2, H_OBS].values, h_sw[valid_sw_2])\nh_pt_bias, h_pt_mae, h_pt_rmse = dc.error_metrics(ec.loc[valid_pt_2, H_OBS].values, h_pt[valid_pt_2])\nh_pm_bias, h_pm_mae, h_pm_rmse = dc.error_metrics(ec.loc[valid_pm_2, H_OBS].values, h_pm[valid_pm_2])\nle_sw_bias, le_sw_mae, le_sw_rmse = dc.error_metrics(ec.loc[valid_sw_2, LE_OBS].values, le_sw[valid_sw_2])\nle_pt_bias, le_pt_mae, le_pt_rmse = dc.error_metrics(ec.loc[valid_pt_2, LE_OBS].values,le_pt[valid_pt_2])\nle_pm_bias, le_pm_mae, le_pm_rmse = dc.error_metrics(ec.loc[valid_pm_2, LE_OBS].values,le_pm[valid_pm_2])\n\nh_sw_cor, h_sw_p_value, h_sw_slope, h_sw_intercept, h_sw_d = dc.agreement_metrics(ec.loc[valid_sw_2, H_OBS].values, \n                                                                                  h_sw[valid_sw_2])\nh_pt_cor, h_pt_p_value, h_pt_slope, h_pt_intercept, h_pt_d = dc.agreement_metrics(ec.loc[valid_pt_2, H_OBS].values, \n                                                                                  h_pt[valid_pt_2])\nh_pm_cor, h_pm_p_value, h_pm_slope, h_pm_intercept, h_pm_d = dc.agreement_metrics(ec.loc[valid_pm_2, H_OBS].values, \n                                                                                  h_pm[valid_pm_2])\n\nle_sw_cor, le_sw_p_value, le_sw_slope, le_sw_intercept, le_sw_d = dc.agreement_metrics(ec.loc[valid_sw_2, LE_OBS].values, \n                                                                                       le_sw[valid_sw_2])\nle_pt_cor, le_pt_p_value, le_pt_slope, le_pt_intercept, le_pt_d = dc.agreement_metrics(ec.loc[valid_pt_2, LE_OBS].values, \n                                                                                       le_pt[valid_pt_2])\nle_pm_cor, le_pm_p_value, le_pm_slope, le_pm_intercept, le_pm_d = dc.agreement_metrics(ec.loc[valid_pm_2, LE_OBS].values, \n                                                                                       le_pm[valid_pm_2])\n\ntable_h = [[\"bias\", h_sw_bias, h_pt_bias, h_pm_bias],\n         [\"RMSE\", h_sw_rmse, h_pt_rmse, h_pm_rmse],\n         [\"MAE\", h_sw_mae, h_pt_mae, h_pm_mae],\n         [\"Pearson\", h_sw_cor, h_pt_cor, h_pm_cor],\n         [\"Willmot's d\", h_sw_d, h_pt_d, h_pm_d]]\nprint(\"Error metrics for sensible heat flux\")\nprint(tabulate(table_h, headers=[\"Metric\", \"TSEB-SW\", \"TSEB-PT\", \"TSEB-PM\"]))\n\ntable_le = [[\"bias\", le_sw_bias, le_pt_bias, le_pm_bias],\n         [\"RMSE\", le_sw_rmse, le_pt_rmse, le_pm_rmse],\n         [\"MAE\", le_sw_mae, le_pt_mae, le_pm_mae],\n         [\"Pearson\", le_sw_cor, le_pt_cor, le_pm_cor],\n         [\"Willmot's d\", le_sw_d, le_pt_d, le_pm_d]]\n\nprint(\"\\n=======================================\\n\")\nprint(\"Error metrics for latent heat flux\")\nprint(tabulate(table_le, headers=[\"Metric\", \"TSEB-SW\", \"TSEB-PT\", \"TSEB-PM\"]))","visibility":"show","key":"ErrB4ffVzg"},{"type":"output","id":"FWTFREo-GMuRD_wwiNR7p","data":[],"visibility":"show","key":"sOQ7PF1dOA"}],"visibility":"show","key":"IdeN8AaxPf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We save the results to ASCII tables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t8DS4TB9ZR"}],"identifier":"we-save-the-results-to-ascii-tables","label":"We save the results to ASCII tables","html_id":"we-save-the-results-to-ascii-tables","implicit":true,"key":"cTZIVItkyY"}],"key":"GT5D4WsVDJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Define the output filename\nout_dir = Path().absolute() / \"output\"\noutfile = out_dir / f\"FLX_US-{w_site.value}_FLUXNET2015_TSEB-PT-ROWS_HR.csv\"\n\n# Create the output folder in case it does not exist\nif not out_dir.exists():\n    out_dir.mkdir(parents=True)\n\n# Convert the outputs to a Python dictionary\noutdict = {\"TIMESTAMP\": ec[\"TIMESTAMP\"].dt.strftime(\"%Y%m%d%H%M\"),\n           \"FLAG_TSEBPT\": flag_pt, \"LE_TSEBPT\": le_pt, \"H_TSEBPT\": h_pt, \"NETRAD_TSEBPT\": netrad_pt, \"G_TSEBPT\": g_pt, \n           \"T_S_TSEBPT\": ts_pt, \"T_C_TSEBPT\": tc_pt, \"T_AC_TSEBPT\": t_ac_pt, \"LN_S_TSEBPT\": ln_s_pt, \"LN_C_TSEBPT\": ln_c_pt, \n           \"LE_C_TSEBPT\": le_c_pt, \"H_C_TSEBPT\": h_c_pt, \"LE_S_TSEBPT\": le_s_pt, \"H_S_TSEBPT\": h_s_pt, \"R_S_TSEBPT\": r_s_pt, \n           \"R_X_TSEBPT\": r_x_pt, \"R_A_TSEBPT\": r_a_pt, \"USTAR_TSEBPT\": u_friction_pt, \"L_MO_TSEBPT\":lmo_pt, \n           \"ITERATIONS_TSEBPT\": n_iterations_pt}\n\n# Crete the output dataframe and save it to csv\npd.DataFrame(outdict).to_csv(outfile, sep=\";\", na_rep=-9999, index=False)\nprint(f\"Saved to {outfile}\")\n\n# Define the output filename\noutfile = out_dir / f\"FLX_US-{w_site.value}_FLUXNET2015_TSEB-SW-ROWS_HR.csv\"\n\n# Convert the outputs to a Python dictionary\noutdict = {\"TIMESTAMP\": ec[\"TIMESTAMP\"].dt.strftime(\"%Y%m%d%H%M\"),\n           \"FLAG_TSEBSW\": flag_sw, \"LE_TSEBSW\": le_sw, \"H_TSEBSW\": h_sw, \"NETRAD_TSEBSW\": netrad_sw, \"G_TSEBSW\": g_sw, \n           \"T_S_TSEBSW\": ts_sw, \"T_C_TSEBSW\": tc_sw, \"T_AC_TSEBSW\": t_ac_sw, \"LN_S_TSEBSW\": ln_s_sw, \"LN_C_TSEBSW\": ln_c_sw, \n           \"LE_C_TSEBSW\": le_c_sw, \"H_C_TSEBSW\": h_c_sw, \"LE_S_TSEBSW\": le_s_sw, \"H_S_TSEBSW\": h_s_sw, \"R_S_TSEBSW\": r_s_sw, \n           \"R_X_TSEBSW\": r_x_sw, \"R_A_TSEBSW\": r_a_sw, \"USTAR_TSEBSW\": u_friction_sw, \"L_MO_TSEBSW\":lmo_sw, \n           \"ITERATIONS_TSEBSW\": n_iterations_sw}\n\n# Crete the output dataframe and save it to csv\npd.DataFrame(outdict).to_csv(outfile, sep=\";\", na_rep=-9999, index=False)\nprint(f\"Saved to {outfile}\")\n\n# Define the output filename\noutfile = out_dir / f\"FLX_US-{w_site.value}_FLUXNET2015_TSEB-PM-ROWS_HR.csv\"\n\n# Convert the outputs to a Python dictionary\noutdict = {\"TIMESTAMP\": ec[\"TIMESTAMP\"].dt.strftime(\"%Y%m%d%H%M\"),\n           \"FLAG_TSEBPM\": flag_pm, \"LE_TSEBPM\": le_pm, \"H_TSEBPM\": h_pm, \"NETRAD_TSEBPM\": netrad_pm, \"G_TSEBPM\": g_pm, \n           \"T_S_TSEBPM\": ts_pm, \"T_C_TSEBPM\": tc_pm, \"T_AC_TSEBPM\": t_ac_pm, \"LN_S_TSEBPM\": ln_s_pm, \"LN_C_TSEBPM\": ln_c_pm, \n           \"LE_C_TSEBPM\": le_c_pm, \"H_C_TSEBPM\": h_c_pm, \"LE_S_TSEBPM\": le_s_pm, \"H_S_TSEBPM\": h_s_pm, \"R_S_TSEBPM\": r_s_pm, \n           \"R_X_TSEBPM\": r_x_pm, \"R_A_TSEBPM\": r_a_pm, \"USTAR_TSEBPM\": u_friction_pm, \"L_MO_TSEBPM\":lmo_pm, \n           \"ITERATIONS_TSEBPM\": n_iterations_pm}\n\n# Crete the output dataframe and save it to csv\npd.DataFrame(outdict).to_csv(outfile, sep=\";\", na_rep=-9999, index=False)\nprint(f\"Saved to {outfile}\")","key":"MtsiIrobmm"},{"type":"output","id":"-aVrUI5Hgb95MGryQwOze","data":[],"key":"vDMGE6tN5w"}],"key":"YVCm2XtMlw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Conclusions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IisP7MYddM"}],"identifier":"conclusions","label":"Conclusions","html_id":"conclusions","implicit":true,"key":"Jmi968SU2s"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"TSEB-SW seems to outperform TSEB-PT under advective conditions/sites with negative sensible heat fluxes at daytime","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L7MJpuA7Bi"}],"key":"BXHilyTtrQ"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"However, TSEB-SW requires additional parametrization: minimuim stomata resistance and its relationship to the environmental conditions","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"fXCz2RRtRw"}],"key":"exzZgvz5Wv"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Both TSEB-PT and TSEB-SW seems to produce larger errors in Barelli 007, and Barelli 012*","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Ny5zLgzuKE"}],"key":"IsTfOWJf0q"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"[...]","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"nHwPW4xJp5"}],"key":"cDj3Na0mv4"}],"key":"vQL7viAFHo"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"AjSikPGMwG"}],"key":"M8w2x654tf"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Please feel free comment any thoughts. This is work in progress!!!","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"IcBKx7i8fT"}],"key":"wm2jUqanME"}],"key":"wEiGkDSl6l"}],"key":"Z6108e9GxP"}],"key":"bK50rfviQO"},"references":{"cite":{"order":["Kustas_2022","Nieto_2022","Shuttleworth_1985","Jarvis_1986","MONTEITH_1995","LEUNING_1995","Thomas_2008","Zahn_2022","Raupach_1994"],"data":{"Kustas_2022":{"label":"Kustas_2022","enumerator":"1","doi":"10.1007/s00271-022-00778-y","html":"Kustas, W. P., Nieto, H., Garcia-Tejera, O., Bambach, N., McElrone, A. J., Gao, F., Alfieri, J. G., Hipps, L. E., Prueger, J. H., Torres-Rua, A., Anderson, M. C., Knipper, K., Alsina, M. M., McKee, L. G., Zahn, E., Bou-Zeid, E., & Dokoozlian, N. (2022). Impact of advection on two-source energy balance (TSEB) canopy transpiration parameterization for vineyards in the California Central Valley. <i>Irrigation Science</i>, <i>40</i>(4–5), 575–591. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/s00271-022-00778-y\">10.1007/s00271-022-00778-y</a>","url":"https://doi.org/10.1007/s00271-022-00778-y"},"Nieto_2022":{"label":"Nieto_2022","enumerator":"2","doi":"10.1007/s00271-022-00790-2","html":"Nieto, H., Alsina, M. M., Kustas, W. P., García-Tejera, O., Chen, F., Bambach, N., Gao, F., Alfieri, J. G., Hipps, L. E., Prueger, J. H., McKee, L. G., Zahn, E., Bou-Zeid, E., McElrone, A. J., Castro, S. J., & Dokoozlian, N. (2022). Evaluating different metrics from the thermal-based two-source energy balance model for monitoring grapevine water stress. <i>Irrigation Science</i>, <i>40</i>(4–5), 697–713. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/s00271-022-00790-2\">10.1007/s00271-022-00790-2</a>","url":"https://doi.org/10.1007/s00271-022-00790-2"},"Shuttleworth_1985":{"label":"Shuttleworth_1985","enumerator":"3","doi":"10.1002/qj.49711146910","html":"Shuttleworth, W. J., & Wallace, J. S. (1985). Evaporation from sparse crops‐an energy combination theory. <i>Quarterly Journal of the Royal Meteorological Society</i>, <i>111</i>(469), 839–855. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1002/qj.49711146910\">10.1002/qj.49711146910</a>","url":"https://doi.org/10.1002/qj.49711146910"},"Jarvis_1986":{"label":"Jarvis_1986","enumerator":"4","doi":"10.1016/s0065-2504(08)60119-1","html":"Jarvis, P. G., & McNaughton, K. G. (1986). Stomatal Control of Transpiration: Scaling Up from Leaf to Region. In <i>Advances in Ecological Research</i> (pp. 1–49). Elsevier. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1016/s0065-2504(08)60119-1\">10.1016/s0065-2504(08)60119-1</a>","url":"https://doi.org/10.1016/s0065-2504(08)60119-1"},"MONTEITH_1995":{"label":"MONTEITH_1995","enumerator":"5","doi":"10.1111/j.1365-3040.1995.tb00371.x","html":"MONTEITH, J. L. (1995). A reinterpretation of stomatal responses to humidity. <i>Plant, Cell &amp; Environment</i>, <i>18</i>(4), 357–364. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1111/j.1365-3040.1995.tb00371.x\">10.1111/j.1365-3040.1995.tb00371.x</a>","url":"https://doi.org/10.1111/j.1365-3040.1995.tb00371.x"},"LEUNING_1995":{"label":"LEUNING_1995","enumerator":"6","doi":"10.1111/j.1365-3040.1995.tb00370.x","html":"LEUNING, R. (1995). A critical appraisal of a combined stomatal‐photosynthesis model for C3 plants. <i>Plant, Cell &amp; Environment</i>, <i>18</i>(4), 339–355. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1111/j.1365-3040.1995.tb00370.x\">10.1111/j.1365-3040.1995.tb00370.x</a>","url":"https://doi.org/10.1111/j.1365-3040.1995.tb00370.x"},"Thomas_2008":{"label":"Thomas_2008","enumerator":"7","doi":"10.1016/j.agrformet.2008.03.002","html":"Thomas, C., Martin, J. G., Goeckede, M., Siqueira, M. B., Foken, T., Law, B. E., Loescher, H. W., & Katul, G. (2008). Estimating daytime subcanopy respiration from conditional sampling methods applied to multi-scalar high frequency turbulence time series. <i>Agricultural and Forest Meteorology</i>, <i>148</i>(8–9), 1210–1229. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1016/j.agrformet.2008.03.002\">10.1016/j.agrformet.2008.03.002</a>","url":"https://doi.org/10.1016/j.agrformet.2008.03.002"},"Zahn_2022":{"label":"Zahn_2022","enumerator":"8","doi":"10.1016/j.agrformet.2021.108790","html":"Zahn, E., Bou-Zeid, E., Good, S. P., Katul, G. G., Thomas, C. K., Ghannam, K., Smith, J. A., Chamecki, M., Dias, N. L., Fuentes, J. D., Alfieri, J. G., Kwon, H., Caylor, K. K., Gao, Z., Soderberg, K., Bambach, N. E., Hipps, L. E., Prueger, J. H., & Kustas, W. P. (2022). Direct partitioning of eddy-covariance water and carbon dioxide fluxes into ground and plant components. <i>Agricultural and Forest Meteorology</i>, <i>315</i>, 108790. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1016/j.agrformet.2021.108790\">10.1016/j.agrformet.2021.108790</a>","url":"https://doi.org/10.1016/j.agrformet.2021.108790"},"Raupach_1994":{"label":"Raupach_1994","enumerator":"9","doi":"10.1007/bf00709229","html":"Raupach, M. R. (1994). Simplified expressions for vegetation roughness length and zero-plane displacement as functions of canopy height and area index. <i>Boundary-Layer Meteorology</i>, <i>71</i>(1–2), 211–216. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/bf00709229\">10.1007/bf00709229</a>","url":"https://doi.org/10.1007/bf00709229"}}}}}