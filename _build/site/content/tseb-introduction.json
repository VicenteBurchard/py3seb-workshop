{"version":2,"kind":"Notebook","sha256":"769c18f58d1c2481b5dedc40296878ca8a2490619253ebe0e0ce60dbc0894011","slug":"tseb-introduction","location":"/103-TSEB_introduction.ipynb","dependencies":[],"frontmatter":{"title":"How TSEB works?","short_title":"TSEB","subtitle":"A quick overview of low-level code","keywords":["TSEB","radiation","Beer-Lambert law","albedo"],"authors":[{"nameParsed":{"literal":"Héctor Nieto","given":"Héctor","family":"Nieto"},"name":"Héctor Nieto","orcid":"0000-0003-4250-6424","email":"hector.nieto@ica.csic.es","affiliations":["Instituto de Ciencias Agrarias, ICA","CSIC"],"id":"contributors-103-TSEB_introduction-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Benjamin Mary","given":"Benjamin","family":"Mary"},"name":"Benjamin Mary","orcid":"0000-0001-7199-2885","affiliations":["Insituto de Ciencias Agrarias","CSIC"],"id":"contributors-103-TSEB_introduction-generated-uid-1"}],"affiliations":[{"id":"Instituto de Ciencias Agrarias, ICA","name":"Instituto de Ciencias Agrarias, ICA"},{"id":"CSIC","name":"CSIC"},{"id":"Insituto de Ciencias Agrarias","name":"Insituto de Ciencias Agrarias"}],"license":{"content":{"id":"CC-BY-SA-4.0","url":"https://creativecommons.org/licenses/by-sa/4.0/","name":"Creative Commons Attribution Share Alike 4.0 International","free":true,"CC":true}},"subject":"Tutorial","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"open_access":false,"github":"https://github.com/VicenteBurchard/py3SEB-workshop","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/VicenteBurchard/py3SEB-workshop/blob/master/103-TSEB_introduction.ipynb","thumbnail":"/tseb-29623b9cdfe76bc4d3f3ca0e364d4c1c.jpg","thumbnailOptimized":"/tseb-29623b9cdfe76bc4d3f3ca0e364d4c1c.webp","exports":[{"format":"ipynb","filename":"103-TSEB_introduction.ipynb","url":"/103-TSEB_introductio-0c22dd9906f6d5dd8cf13eb3f8d5de6d.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sk2fHdfXif"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"BK9gLcgy0G"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This interactive Jupyter Notebook has the objective of showing the implemenation of TSEB-PT model in the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"IDMAcj84OR"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"pyTSEB package","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hTqdRH3ip9"}],"urlSource":"https://github.com/hectornieto/pyTSEB","error":true,"key":"xqOsQlteMm"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Ns20CcOy5b"}],"key":"NMyLyY52dg"}],"key":"hJvb4SknoI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Instructions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RVje57bLyt"}],"identifier":"instructions","label":"Instructions","html_id":"instructions","implicit":true,"key":"d3WEsHcW9p"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Read carefully all the text and follow the instructions.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rTX0eAkPhc"}],"key":"cgy58U4Oy8"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Once each section is read, run the jupyter code cell underneath (marked as ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EtnDfIKJ4Z"},{"type":"inlineCode","value":"In []","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"oTPtjMeeWE"},{"type":"text","value":") by clicking the icon ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uIExU1xYer"},{"type":"inlineCode","value":"Run","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vb4fA0w9Wj"},{"type":"text","value":", or pressing the keys SHIFT+ENTER of your keyboard. A graphical interface will then display, which allows you to interact with and perform the assigned tasks.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"McS2FymzyA"}],"key":"MlFZv2OrTH"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"To start, please run the following cell to import all the packages required for this notebook. Once you run the cell below, an acknowledgement message, stating all libraries were correctly imported, should be printed on screen.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QEd9e9rhYU"}],"key":"Jo2FuHizpu"}],"key":"i9BPygGKlG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline\nfrom pathlib import Path\nfrom ipywidgets import interact, interactive, fixed, widgets\nfrom IPython.display import display\nimport numpy as np\nfrom pyTSEB import TSEB\nprint(\"Libraries imported!\")","key":"h63Jw8oPoY"},{"type":"output","id":"DQ72xMV1XpHYppcgTzUBw","data":[],"key":"hQzzupugeX"}],"key":"atmBHnNgXT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The TSEB model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mFUB5wIjig"}],"identifier":"the-tseb-model","label":"The TSEB model","html_id":"the-tseb-model","implicit":true,"key":"kiaCYSvv5g"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Two-Source Energy Balance (TSEB) model ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yMHpn4QKjp"},{"type":"cite","url":"https://doi.org/10.1016/0168-1923(95)02265-Y","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Norman et al. (1995)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qNgoUtqi6t"}],"kind":"narrative","label":"Norman_1995","identifier":"https://doi.org/10.1016/0168-1923(95)02265-Y","enumerator":"1","key":"HKLGaGEOue"},{"type":"text","value":" was specifically designed to account for directionality of radiometric temperature measurements and to avoid the use of any empirical “excess” resistance terms in the model. TO achieve this, both the heat and water fluxes are separated into a soil and canopy layer, with a set of resistances set in series.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YirARHrLBv"}],"key":"wHQpXsIYWL"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"dW0XnXIWm7"}],"key":"jG7q9eE8Aw"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"DLeaUYwcMA"},{"type":"cite","url":"https://doi.org/10.1016/0168-1923(95)02265-Y","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Norman et al. (1995)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Bc3dDjCqNS"}],"kind":"narrative","label":"Norman_1995","identifier":"https://doi.org/10.1016/0168-1923(95)02265-Y","enumerator":"1","key":"DuTApkDa4H"},{"type":"text","value":" the original resistance scheme was in parallel","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"eghleE1dZp"}],"key":"rYVnypT1cI"}],"key":"RILN7CU0LU"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/tseb-29623b9cdfe76bc4d3f3ca0e364d4c1c.jpg","alt":"Two Source Energy Balance model","key":"DSo7UD7NSi","urlSource":"./input/figures/tseb.jpg","urlOptimized":"/tseb-29623b9cdfe76bc4d3f3ca0e364d4c1c.webp"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"tseb-model","identifier":"tseb-model","html_id":"tseb-model","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"jB18fnTJV2"},{"type":"text","value":"1","key":"BscGRytUvh"},{"type":"text","value":":","key":"aIvv1KB8Ca"}],"template":"Figure %s:","key":"F9fADAmFpO"},{"type":"text","value":"Schematic diagram of the TSEB model resistance network for sensible heat flux and the basic set of equations used to obtain an iterative solution. Source: ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"l409hh51m2"},{"type":"link","url":"https://doi.org/10.1175/BAMS-D-16-0244","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Kustas et al. (2018)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"u5sMnfndo1"}],"urlSource":"https://doi.org/10.1175/BAMS-D-16-0244","data":{"doi":"10.1175/BAMS-D-16-0244"},"internal":false,"protocol":"doi","key":"RvEoWAffqo"},{"type":"text","value":".","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"O8gb6NwQ76"}],"key":"gzyLlEf46I"}],"key":"cDDOX4C3cY"}],"label":"tseb-model","identifier":"tseb-model","enumerator":"1","html_id":"tseb-model","key":"gcaGkaSjwq"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Energy fluxes are therefore split into soil and canopy, considering the conservation of energy:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"M2OyXZZrxb"}],"key":"DHBp0BBIHW"},{"type":"math","value":"R_{n} & \\approx H + \\lambda E + G\\\\\n  R_{n,C} & \\approx H_{C} + \\lambda E_{C}  R_{n,C} & \\approx H_{C} + \\lambda E_{C}","label":"eq-eb","identifier":"eq-eb","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left right\" columnspacing=\"0em 1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>R</mi><mi>n</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>≈</mo><mi>H</mi><mo>+</mo><mi>λ</mi><mi>E</mi><mo>+</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>R</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>C</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>≈</mo><msub><mi>H</mi><mi>C</mi></msub><mo>+</mo><mi>λ</mi><msub><mi>E</mi><mi>C</mi></msub><msub><mi>R</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>C</mi></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo>≈</mo><msub><mi>H</mi><mi>C</mi></msub><mo>+</mo><mi>λ</mi><msub><mi>E</mi><mi>C</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align*}\nR_{n} &amp; \\approx H + \\lambda E + G\\\\\n  R_{n,C} &amp; \\approx H_{C} + \\lambda E_{C}  R_{n,C} &amp; \\approx H_{C} + \\lambda E_{C}\n\\end{align*}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.75em;\"><span style=\"top:-3.91em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.25em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.75em;\"><span style=\"top:-3.91em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">G</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.25em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.25em;\"><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.25em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","html_id":"eq-eb","key":"XTD17oN0D5"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"with ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"Kvgk0hPuKC"},{"type":"inlineMath","value":"R_n","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">R_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"DFwk4cM97y"},{"type":"text","value":" being the net radiation, ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"FDOAmazPae"},{"type":"inlineMath","value":"H","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"IcUzmjPmRz"},{"type":"text","value":" the sensible heat flux, ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"yd407lZYfe"},{"type":"inlineMath","value":"\\lambda E","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span>","key":"nRTNEJGQQm"},{"type":"text","value":" the latent heat flux or evapotranspiration, and ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"jEO0oWAYTq"},{"type":"inlineMath","value":"G","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>","key":"WrOJ65lofe"},{"type":"text","value":" the soil heat flux (all fluxes are expressed in W m","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"mIM44kFXFK"},{"type":"inlineMath","value":"^{-2}","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow></mrow><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">^{-2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>","key":"gUscfouU3S"},{"type":"text","value":". The approximation in Eq. \\ref{eq:Energy_Balance} reflects additional components of the energy balance that are usually neglected, such as heat advection, storage of energy in the canopy layer or energy for the fixation of CO","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"j4BQw3dZqw"},{"type":"inlineMath","value":"_2","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"i3C90JMDQD"},{"type":"text","value":", which are not computed by the model.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"fW00J7wYRp"}],"key":"uTbdUGdDEx"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Remote sensing Energy Balance Models, REBMs, rely on the ability of the radiometric information to estimate, net radiation, soil heat flux and sensible heat flux ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"BEgrHl1XJs"},{"type":"cite","url":"https://doi.org/10.1016/0168-1923(95)02265-Y","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"(Norman et al., 1995)","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"HDaNZuUxK5"}],"kind":"narrative","label":"Norman_1995","identifier":"https://doi.org/10.1016/0168-1923(95)02265-Y","enumerator":"1","key":"R7s1YMVUhI"},{"type":"text","value":". To see how pyTSEB works we will run several pieces of code to estimate each of the components of the energy balance.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"jKEsV7cpmV"}],"key":"gcsLy63LML"}],"key":"y741g0MpPl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Implementation with actual data in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sFrTchZ5Vb"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"pyTSEB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sRwV7bYlp2"}],"urlSource":"https://github.com/hectornieto/pyTSEB","error":true,"key":"WHrBakWjYm"}],"identifier":"implementation-with-actual-data-in-pytseb","label":"Implementation with actual data in pyTSEB","html_id":"implementation-with-actual-data-in-pytseb","implicit":true,"key":"mOVwK24VE9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We have several GRAPEX sites with micrometeorological measurements that we will use in this and in future exercises. By running TSEB at hourly timesteps we could get a better overview of its behaviour, challenges and limitations.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hWmo1pi69h"}],"key":"ZKdUIa2hkV"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"zlCU7DjoW0"}],"key":"FzSjkVlqCT"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Running pyTSEB over an image follows exactly the same procedure as all the pixels, or dates in the case of tabulated timeseries, are converted to a vectorized array for computing efficiency.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"KVs3EgMMnz"}],"key":"PS3xJH8U9n"}],"key":"pvipoCh85N"},{"type":"container","kind":"table","children":[{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"captionNumber","kind":"table","label":"tab-site-description","identifier":"tab-site-description","html_id":"tab-site-description","enumerator":"1","children":[{"type":"text","value":"Table ","key":"elU1PIcbAQ"},{"type":"text","value":"1","key":"GAXDiIAicq"},{"type":"text","value":":","key":"x4LijE2ALd"}],"template":"Table %s:","key":"GcimV77Lwi"},{"type":"text","value":"Description of GRAPEX sites","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"FO8i1wPUT3"}],"key":"JyAheaPf9Y"}],"key":"SUUs2tZGxe"},{"type":"table","position":{"start":{"line":13,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Site","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Y8zEYTbSBa"}],"key":"WV48bSBb2u"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Latitude","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Q7o6cNJlAN"}],"key":"svfsXUyItz"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Longitude","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"unojXhwY5a"}],"key":"YoNw2RdgNe"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Elevation (m)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"oiBF5DUtR1"}],"key":"Z88Zn7PLDp"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Row direction (deg.)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"adHiyvye1F"}],"key":"aqx96HOnj3"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Row spacing (m)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"vV5PJeNMu0"}],"key":"BbFEBV1bog"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Min. height (m)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"fVHR85nio7"}],"key":"eMwtVkbwni"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Max. height (m)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"OpWQTOh7wY"}],"key":"MSrg3NrUpa"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Min. width (m)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"cKhnYwSerj"}],"key":"V9Gq7Nd9zW"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Max. width (m)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"M8lOq87rjb"}],"key":"zUWmAuCBgb"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"TA height (m)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"AeDUFuoylI"}],"key":"ME09LOVd7f"},{"type":"tableCell","header":true,"align":"right","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"WS height (m)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"dEYCzJkpyy"}],"key":"C88m4JllaP"}],"key":"K9y4yJEGbE"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Ripperdan 720-1","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"wgn5cNPErP"}],"key":"YXmLLPQJSt"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"36.849","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"hmSXPVBdWi"}],"key":"XQPeUvgFLk"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"-120.176","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"le2quC8AtR"}],"key":"FarV5gI16C"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"61","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"fNbJwPR8r3"}],"key":"PQfYRduXrT"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"zZq6lMGJE1"}],"key":"A3CRwCYKnw"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"TkXbBB8KQ9"}],"key":"PMTiHljUkG"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"i5wqy2Hh0k"}],"key":"up3ZFkWmt7"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"2.2","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"RYsEKj1rBg"}],"key":"KZCCQESztv"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"l8JLuDp1cd"}],"key":"dB5DMZ0bUv"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"mYvsM2Ly5p"}],"key":"WIX0p7cTSX"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"YqTvE3fv8v"}],"key":"VKDPEfUvSV"},{"type":"tableCell","align":"right","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"fpj872FIQy"}],"key":"wopKHgy0XV"}],"key":"ZNMFSEFzfD"},{"type":"tableRow","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Ripperdan 720-2","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"OLeaERROEP"}],"key":"noQHSuXdJO"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"36.849","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"RQ5AfmdpSW"}],"key":"lsvwBEW6li"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"-120.174","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"bJxHc8BMau"}],"key":"mxo92DKAn4"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"61","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"cMuHY01Km6"}],"key":"r5hiXOEJA4"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"qIe2pl5yjd"}],"key":"rPTw4v1ugd"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"UrlYawJT1J"}],"key":"viMFTRf6ew"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"bJfVNOd0Sq"}],"key":"wzYNzBVnhm"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"2.2","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"hA3LKpYNqB"}],"key":"ddWZdqmqcq"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"FkshIdfBl6"}],"key":"VaGLuiG8lQ"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"DXLLPgOtMZ"}],"key":"rq9FP7GwCs"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"E4zsGcbiOM"}],"key":"rEOrWhvpkw"},{"type":"tableCell","align":"right","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"n7EI96YQjx"}],"key":"nhdeNPLpG7"}],"key":"c4lhEX8dXv"},{"type":"tableRow","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Ripperdan 720-3","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"z18QHQLeV2"}],"key":"Tpmz2cssH4"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"36.848","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"hihcme2uoJ"}],"key":"YJoEa8fQVn"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"-120.176","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"dJlBFLUwrh"}],"key":"uOxfDSy3tE"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"61","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"lC2atpMbAD"}],"key":"D3vGAjn6Np"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"MmRuOcuedG"}],"key":"zE8y8SPjsD"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"lIVt1y23dA"}],"key":"ZatWPaEQkp"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"LsWdK8Y5qG"}],"key":"NDbw1ul1eR"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"2.2","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"sq4vi8kE2j"}],"key":"QA2AUQrU5H"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"SRYNkKvxWe"}],"key":"KZDg7o6dxp"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"nQX6bLbKlz"}],"key":"Pckc8yPz5w"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"AjTMzjA2qA"}],"key":"J4abfhevQ7"},{"type":"tableCell","align":"right","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"nIRlk2zduw"}],"key":"Nd4jsduvyp"}],"key":"DIq9H8bA5D"},{"type":"tableRow","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Ripperdan 720-4","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"STTThsd8YD"}],"key":"BzFjKuzCze"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"36.848","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"AfGR4CPPPC"}],"key":"QQjlphZfI5"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"-120.174","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Mg3e6Hs9KM"}],"key":"hchEaPBMpT"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"61","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"zC5k0CkBar"}],"key":"uaUIOyyb7P"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"CaEkngZgMn"}],"key":"st5N2PbiDE"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"U3iO8pXeyu"}],"key":"wiInt3yTBv"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"CWXaHv8QZj"}],"key":"c0ftfEUUQI"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"2.2","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"SU4OC8gNni"}],"key":"nJp7330k9U"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"NqP15kqU6o"}],"key":"j6s8mvbeFP"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"OfDRRNHHeW"}],"key":"Wqka2xWVGG"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Un3gfJhwc3"}],"key":"KRTOW7RhTa"},{"type":"tableCell","align":"right","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"I6qvI5PONY"}],"key":"d8Cs7UPBy1"}],"key":"NJjVXZpNtm"},{"type":"tableRow","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Barrelli_007","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ru4yshf8S1"}],"key":"ga7n6cP4Qm"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"38.753","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Xv7dUyQ9qO"}],"key":"wGP0stfej2"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"-122.98","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"zVyegTChbZ"}],"key":"Wmvz7TC5Wg"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"113","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"hYh0qziu2P"}],"key":"jkP7xp3K54"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"135","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"I5GPRhSqZK"}],"key":"BwvQa0rtzD"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"EqBtQN4vSm"}],"key":"FkQghNQnMK"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"1.25","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"DS2H7d1yfI"}],"key":"TQaT27JsAK"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"2.3","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"esZ4HgT4MG"}],"key":"KebmXT7QXc"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"sIP4pCsHww"}],"key":"d31Q7sznQ9"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"1.8","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"rr0RZEA7Cl"}],"key":"XZdNXSBZvG"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"I76kHjN8Y9"}],"key":"PqFxPIAdf1"},{"type":"tableCell","align":"right","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"HJOZAsAEXg"}],"key":"jTIBqOoaIF"}],"key":"w5gGQRRzEM"},{"type":"tableRow","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Barrelli_012","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"yrvLwDhIqQ"}],"key":"hVf1LAiUeZ"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"38.751369","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"vjU0ug8vby"}],"key":"DT45Odm8ev"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"-122.974658","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"fV0Z8wMNbW"}],"key":"suIuW1rwWt"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"112","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Rv6pJ5WgpS"}],"key":"h1XOvavClx"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"45","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"lVGXEowiZz"}],"key":"ERGyOuM2UO"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"rnvUovFwYy"}],"key":"ijlFcQI2Nn"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"1.25","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"cHbyWwnSCT"}],"key":"oxz8sdA2jt"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"2.3","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"AFyg273nXm"}],"key":"tAUkDzXjQd"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"BIOkdYPKGi"}],"key":"wIAfsCqkX2"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"1.8","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"nOxiRaUzsy"}],"key":"n2QpN5j88y"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"4.4","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"NPo0nGbYLj"}],"key":"Jv86S3MoXz"},{"type":"tableCell","align":"right","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"4.4","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"CY9m4n8t5Q"}],"key":"GZYvB1Dgme"}],"key":"DGDdXymhgw"},{"type":"tableRow","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Sierra Loma-north","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Y67LTDXRQl"}],"key":"JaEGlLdqVE"},{"type":"tableCell","align":"right","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"38.289338","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"IyJloMITb3"}],"key":"H4oN1yOXZA"},{"type":"tableCell","align":"right","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"-121.117764","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"FFR7gKbRuH"}],"key":"MwLkU5CNvl"},{"type":"tableCell","align":"right","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"38","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"IXuLLWzUxe"}],"key":"JwYDyN1F9N"},{"type":"tableCell","align":"right","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"irRIOF1Rxt"}],"key":"EmePea2GYu"},{"type":"tableCell","align":"right","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"BIKnUpwtWJ"}],"key":"YfSWCWHBN9"},{"type":"tableCell","align":"right","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"1.42","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"F07X0HcgiZ"}],"key":"dc4JzuZNxL"},{"type":"tableCell","align":"right","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Q2Kt7690au"}],"key":"vOOqzQFEn9"},{"type":"tableCell","align":"right","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"WrLrp55dHD"}],"key":"LmsH6ovzHR"},{"type":"tableCell","align":"right","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"2.6","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"OyFuKQJe3c"}],"key":"tVAiS1DVFY"},{"type":"tableCell","align":"right","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"V1e6dxUDhv"}],"key":"QpXE4VbA09"},{"type":"tableCell","align":"right","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"ytfDjHbJSL"}],"key":"n387GzG5cg"}],"key":"cMoOGZvsJO"},{"type":"tableRow","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Sierra Loma-south","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"kViwG3D8A4"}],"key":"yKDry9hIoN"},{"type":"tableCell","align":"right","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"38.280488","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"XpdKfcwSM2"}],"key":"PAShkDCD6x"},{"type":"tableCell","align":"right","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"-121.117597","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Y42FJPVbHO"}],"key":"FVar2VbP0j"},{"type":"tableCell","align":"right","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"37","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"KJ18klmEIw"}],"key":"TaJk3C5OtE"},{"type":"tableCell","align":"right","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"hChfuUgXXu"}],"key":"AXMih0d3IQ"},{"type":"tableCell","align":"right","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"tQf7CmcdZc"}],"key":"Aq0tlBCGfQ"},{"type":"tableCell","align":"right","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"1-42","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"r5RFXzSjxW"}],"key":"ArGlhnHfGl"},{"type":"tableCell","align":"right","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"2.25","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"HnEYW3E6nR"}],"key":"A0iFpboBdk"},{"type":"tableCell","align":"right","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"M8tPXoe4H9"}],"key":"NqgliQvBPz"},{"type":"tableCell","align":"right","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"drLZaKZk8y"}],"key":"jVAgNuhFwX"},{"type":"tableCell","align":"right","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"BQZkHw3iKC"}],"key":"TsUIoW7RPV"},{"type":"tableCell","align":"right","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"rDf1XgcUv4"}],"key":"DTiji4Tzsu"}],"key":"GaIjBT23GY"},{"type":"tableRow","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Ripperdan 760","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"wdO7PXsIaU"}],"key":"Oc654omOhr"},{"type":"tableCell","align":"right","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"36.839025","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"nbUgarnEOD"}],"key":"OUl7PoGe6g"},{"type":"tableCell","align":"right","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"-120.21014","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"lx53uQij8T"}],"key":"s0VqQAwfQW"},{"type":"tableCell","align":"right","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"58","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"uP85eGvD6W"}],"key":"DRmnwgsQGN"},{"type":"tableCell","align":"right","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"90","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"FYx1urWGKY"}],"key":"jueUQ8sZin"},{"type":"tableCell","align":"right","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"2.74","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"VsvpY6NQwB"}],"key":"t856UJu7RP"},{"type":"tableCell","align":"right","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"1.2","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"PMncNqgEDi"}],"key":"wGdxxZ8Udx"},{"type":"tableCell","align":"right","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"2.5","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"LyJQ726AKV"}],"key":"HIN5OD5uCf"},{"type":"tableCell","align":"right","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"iipipNTxPg"}],"key":"gz12KVB3wK"},{"type":"tableCell","align":"right","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"1.8","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"SLuapd0RJ2"}],"key":"GN4sV3MnsF"},{"type":"tableCell","align":"right","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"5.5","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"cLYexRhMbm"}],"key":"APuPQ9UKCD"},{"type":"tableCell","align":"right","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"QlhKxgvL1l"}],"key":"bsYRSKHOfn"}],"key":"oIWEAZfIAy"},{"type":"tableRow","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Barrelli_016","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"tR2gtogPav"}],"key":"lT2gxUAQD2"},{"type":"tableCell","align":"right","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"38.747","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"SaiXpU0kHQ"}],"key":"uxtMMUIrJV"},{"type":"tableCell","align":"right","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"-122.963","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"NMJp3wAmTR"}],"key":"T0W2tbI5Cb"},{"type":"tableCell","align":"right","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"112","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"osjwTjKYI8"}],"key":"pdrKO7g5OS"},{"type":"tableCell","align":"right","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"135","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"s1rthfB4Dk"}],"key":"XU5pOlUKhn"},{"type":"tableCell","align":"right","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"3.35","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"JG7pMNZEGP"}],"key":"lHsyiatz4g"},{"type":"tableCell","align":"right","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"1.25","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"ceAoCec2qu"}],"key":"buc5q5yIS6"},{"type":"tableCell","align":"right","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"2.3","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"FFoNzIjfnt"}],"key":"FsKEeRZvHL"},{"type":"tableCell","align":"right","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"K0Xnazv1at"}],"key":"mwEEmZqrgh"},{"type":"tableCell","align":"right","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"1.8","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Tif19BF14l"}],"key":"KiDhwDc4nt"},{"type":"tableCell","align":"right","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"iSvvoT0Doh"}],"key":"l0cpXKV3Qj"},{"type":"tableCell","align":"right","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"CHc9H0rR2Q"}],"key":"GOQ43ebID3"}],"key":"eeJnhL89ee"}],"key":"nDrZkAAbt2"}],"label":"tab-site-description","identifier":"tab-site-description","enumerator":"1","html_id":"tab-site-description","key":"th5ejyGAlX"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"In future exercises you could have the chance to process all sites, or those of interest for you. However, for this first exercise and to keep things simpler we will stick to Ripperdam 720-4, since some deficit irrigation events happened in some years ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"OVbhZI7kM4"},{"type":"cite","url":"https://doi.org/10.1007/s00271-022-00790-2","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"(see Nieto et al., 2022)","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"Wf4GGHP5dR"}],"kind":"narrative","label":"Nieto_2022","identifier":"https://doi.org/10.1007/s00271-022-00790-2","enumerator":"2","key":"UkrCMMSyLC"}],"key":"kYPC990HnM"}],"key":"HhQF7QRu8j"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"See Also","key":"ugQ1cX9pPW"}],"key":"scMOkmCMAw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This is a full description of the EC column fields:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tE5rk49nZ9"}],"key":"wtRuyMCLc3"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"./fluxnet2015_variables.md","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"urlSource":"./fluxnet2015_variables.md","key":"RrFtQ25A8i"}],"key":"tjHiN7wsMl"}],"class":"dropdown","key":"MbWHYmLUtC"}],"key":"x0pIZWvuPC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Read the LAI and Micrometeorology data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l1sieCR0cB"}],"identifier":"read-the-lai-and-micrometeorology-data","label":"Read the LAI and Micrometeorology data","html_id":"read-the-lai-and-micrometeorology-data","implicit":true,"key":"o6X2W6Ybvu"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We will read and merge the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"YoFKgdaGzJ"},{"type":"link","url":"/FLX_US-rip720_4_FLUX-08171d144626259343f9a1bda21d8c32.csv","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"input micrometeorology","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Y5MERVd8ZK"}],"urlSource":"./input/meteo/FLX_US-rip720_4_FLUXNET2015_SUBSET_HR.csv","static":true,"protocol":"file","key":"QxGN1DGa9p"},{"type":"text","value":" and ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"a91qhYva2b"},{"type":"link","url":"/FLX_US-rip720_4_FLUX-6d261726b65d9a59ef35377ea8f069fc.csv","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"input LAI","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"qG41SVUpoQ"}],"urlSource":"./input/canopy/FLX_US-rip720_4_FLUXNET2015_AUXCANOPY_DD.csv","static":true,"protocol":"file","key":"IpG0gGfiaZ"},{"type":"text","value":" ASCII files.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"KXVu6Uqr8J"}],"key":"YUiEzaeTzC"},{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"See Also","key":"HFbRaULz57"}],"key":"ExthAwevYR"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"A detailed description of the Eddy Covariance measurements and their post-\nprocessing is described by ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"gUL4SnY7s1"},{"type":"cite","url":"https://doi.org/10.1007/s00271-018-0599-3","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Alfieri et al. (2019b)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"HvVVz2Lln0"}],"kind":"narrative","label":"Alfieri_2018","identifier":"https://doi.org/10.1007/s00271-018-0599-3","enumerator":"3","key":"z5c4VzROeO"},{"type":"text","value":".","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"OeZ9idNjjj"}],"key":"hPax0aKJwJ"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Estimates of daily LAI were obtained from training MODIS LAI (MCD15A3H) product and Landsat surface\nreflectance using the reference based approach by ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"VzhHbOZlK0"},{"type":"cite","url":"https://doi.org/10.3390/rs4113287","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Gao et al. (2012)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"B8rKWjGF3T"}],"kind":"narrative","label":"Gao_2012","identifier":"https://doi.org/10.3390/rs4113287","enumerator":"4","key":"mIQeBj9FXo"},{"type":"text","value":" and adapted for vineyards by ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"VI4fhEaoKC"},{"type":"cite","url":"https://doi.org/10.1007/s00271-022-00798-8","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Kang et al. (2022)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"dlAKsFZcCu"}],"kind":"narrative","label":"Kang_2022","identifier":"https://doi.org/10.1007/s00271-022-00798-8","enumerator":"5","key":"pjvtrf4Pv2"}],"key":"QPRHM5lSzK"}],"class":"dropdown","key":"JOi8y9PPUU"}],"key":"ZUhLc2lhpJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set the site shortname to be processed\nsite = \"rip720_4\"\n\n# Import Python libraries\nfrom pathlib import Path\nimport pandas as pd\n\n# Set the LAI and readiation folders\ninput_dir = Path().absolute() / \"input\"\nlai_dir = input_dir / \"canopy\"\nec_dir = input_dir / \"meteo\"\n# Set the input files based on the chosen site\nlai_filename = lai_dir / f\"FLX_US-{site}_FLUXNET2015_AUXCANOPY_DD.csv\"\nec_filename = ec_dir / f\"FLX_US-{site}_FLUXNET2015_SUBSET_HR.csv\"\nprint(f\"LAI file path is {lai_filename}\")\nprint(f\"EC file path is {ec_filename}\")\n\n# Read the LAI and radiation tables\nlai = pd.read_csv(lai_filename, sep=\";\", na_values=-9999)\nec = pd.read_csv(ec_filename, sep=\";\", na_values=-9999)\n\n# Merge both tables by date\nec[\"TIMESTAMP\"] = pd.to_datetime(ec[\"TIMESTAMP\"], format=\"%Y%m%d%H%M\")\nlai[\"DATE\"] = pd.to_datetime(lai[\"TIMESTAMP\"], format=\"%Y%m%d\").dt.date\nlai = lai.drop(labels=[\"TIMESTAMP\"], axis=1)\nec[\"DATE\"] = ec[\"TIMESTAMP\"].dt.date\nec = ec.merge(lai, on=\"DATE\")\n\n# We discard all cases at night (SW_IN <=0)\nec = ec[ec[\"SW_IN\"] > 0]\n\n# Convert Celsius to Kelvin\nec[\"TA\"] = ec[\"TA\"] + 273.15\n# Convert kPa to hPa\nec[\"PA\"] = 10 * ec[\"PA\"]\n\n# Evaluate different energy balance closure corrections\nec[\"H_RES\"] = ec[\"NETRAD\"] - ec[\"G\"] - ec[\"LE\"]\nec['LE_RES'] = ec['NETRAD'] - ec['G'] - ec['H']\nec[\"LE_BR\"], ec[\"H_BR\"] = TSEB.met.bowen_ratio_closure(ec[\"NETRAD\"], ec[\"G\"],\n                                                       ec[\"H\"], ec[\"LE\"])\n# Mean of uncorrected, ressidual and Bowen Ratio\nec[\"H_ENS\"] = np.nanmean([ec[\"H_RES\"], ec[\"H_BR\"], ec['H']], axis=0)\nec[\"LE_ENS\"] = np.nanmean([ec[\"LE_RES\"], ec[\"LE_BR\"], ec['LE']], axis=0)","key":"AG9n5Y6KAj"},{"type":"output","id":"eLVKI0RcWVqoedxEHPf8m","data":[],"key":"kAbeFH9aNT"}],"key":"I19R1aMLff"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Net shortwave radiation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bu0TvSh8fz"}],"identifier":"net-shortwave-radiation","label":"Net shortwave radiation","html_id":"net-shortwave-radiation","implicit":true,"key":"fISW0rcDYy"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"To compute the net shortwave radiation and its partitioning between the canopy and the soil we are using the model of ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BcxBbdI261"},{"type":"cite","url":"https://doi.org/10.1007/978-1-4612-1626-1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Campbell and Norman, 1998, Chapter 15","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"uC5XXBr2Gs"}],"kind":"narrative","label":"Campbell_1998","identifier":"https://doi.org/10.1007/978-1-4612-1626-1","enumerator":"6","key":"lK2LqB5f1p"},{"type":"text","value":". The key aspect of this model is the calculation of the trasmitted shortwave radiation throught the canopy (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dKeunT3wci"},{"type":"inlineMath","value":"\\Tau_C","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">T</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\Tau_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GojcSsXrp1"},{"type":"text","value":")","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"M9fVKV1zGT"}],"key":"DzxK2r7qSa"},{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"See Also","key":"yxqwYoGVpY"}],"key":"zPgKktB7Fn"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The full description of the radiation model can be found in ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jqbA28JbPE"},{"type":"cite","url":"https://doi.org/10.1007/978-1-4612-1626-1_15","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Campbell and Norman, 1998, Chapter 15","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"KrycuejZSM"}],"kind":"narrative","label":"Campbell_1998","identifier":"https://doi.org/10.1007/978-1-4612-1626-1_15","enumerator":"6","key":"DW5rB3zLog"}],"key":"XIhSKybTwy"}],"class":"dropdown","key":"JRcQShND0w"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The transmittance of shortwave radiation through the canopy depends on the wavelength due to vegetation absorbing a greater portion of the photosynthetically active radiation (PAR, 400–700 nm spectrum) than near-infrared radiation (NIR, 700–2500 nm spectrum) wavelengths. (","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"S5XvwzUPtL"},{"type":"inlineMath","value":"\\Tau_C","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">T</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\Tau_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Fkjxz3GjcZ"},{"type":"text","value":" is partitioned into two components (direct/diffse) and in two spectral band (PAR/NIR)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"zmjuEgKRAL"}],"key":"J3SHSo7GIo"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"HtpI3L8kUu"}],"key":"clXSLK9c2j"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"We could include more spectral bands, such as (PAR/NIR/SWIR), with a slight increase of computational cost.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Dti2bbKzkc"}],"key":"zm8XoRH030"}],"class":"dropdown","key":"vbNYkAWbi6"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"The direct-beam spectral (transmittance (","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"vq4OypwQBa"},{"type":"inlineMath","value":"\\tau_{C,DIR,\\lambda}","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>τ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>D</mi><mi>I</mi><mi>R</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\tau_{C,DIR,\\lambda}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"zBDUElYDYs"},{"type":"text","value":") at a given solar zenith angle (","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"IvS4Dzemw5"},{"type":"inlineMath","value":"\\theta_S","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\theta_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"JRctOTevPa"},{"type":"text","value":") is calculated following the equations of Campbell and Norman (1998) for a single layer crop:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"KiCIeiHBLG"}],"key":"Pxj4jtC9gI"},{"type":"math","value":"\\tau_{C,DIR,\\lambda}\\left(\\theta_S\\right)=\\frac{\\left(\\rho_{C,\\lambda}^*\\left(\\theta_S\\right)^2 - 1\\right)\\exp \\left( -\\sqrt{\\zeta_\\lambda} \\kappa_{b}\\left(theta_S\\right)LAI\\right)}{\\left(\\rho_{C,\\lambda}^*\\rho_{S,\\lambda} - 1\\right) + \\rho_{C,\\lambda}^*\\left(\\psi\\right)\\left(\\rho_{C\\lambda}^*\\left(\\theta_S\\right) - \\rho_{S,\\lambda}\\right)\\exp \\left( -2\\sqrt {\\zeta_\\lambda \\kappa_{b}\\left(\\theta_S\\right)LAI} \\right)}","label":"eq-tau-dir","identifier":"eq-tau-dir","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>τ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>D</mi><mi>I</mi><mi>R</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow></msub><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mo>=</mo><mfrac><mrow><mrow><mo fence=\"true\">(</mo><msubsup><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow><mo>∗</mo></msubsup><msup><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mn>2</mn></msup><mo>−</mo><mn>1</mn><mo fence=\"true\">)</mo></mrow><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mo>−</mo><msqrt><msub><mi>ζ</mi><mi>λ</mi></msub></msqrt><msub><mi>κ</mi><mi>b</mi></msub><mrow><mo fence=\"true\">(</mo><mi>t</mi><mi>h</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mi>L</mi><mi>A</mi><mi>I</mi><mo fence=\"true\">)</mo></mrow></mrow><mrow><mrow><mo fence=\"true\">(</mo><msubsup><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow><mo>∗</mo></msubsup><msub><mi>ρ</mi><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow></msub><mo>−</mo><mn>1</mn><mo fence=\"true\">)</mo></mrow><mo>+</mo><msubsup><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow><mo>∗</mo></msubsup><mrow><mo fence=\"true\">(</mo><mi>ψ</mi><mo fence=\"true\">)</mo></mrow><mrow><mo fence=\"true\">(</mo><msubsup><mi>ρ</mi><mrow><mi>C</mi><mi>λ</mi></mrow><mo>∗</mo></msubsup><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mo>−</mo><msub><mi>ρ</mi><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow></msub><mo fence=\"true\">)</mo></mrow><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mo>−</mo><mn>2</mn><msqrt><mrow><msub><mi>ζ</mi><mi>λ</mi></msub><msub><mi>κ</mi><mi>b</mi></msub><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mi>L</mi><mi>A</mi><mi>I</mi></mrow></msqrt><mo fence=\"true\">)</mo></mrow></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\tau_{C,DIR,\\lambda}\\left(\\theta_S\\right)=\\frac{\\left(\\rho_{C,\\lambda}^*\\left(\\theta_S\\right)^2 - 1\\right)\\exp \\left( -\\sqrt{\\zeta_\\lambda} \\kappa_{b}\\left(theta_S\\right)LAI\\right)}{\\left(\\rho_{C,\\lambda}^*\\rho_{S,\\lambda} - 1\\right) + \\rho_{C,\\lambda}^*\\left(\\psi\\right)\\left(\\rho_{C\\lambda}^*\\left(\\theta_S\\right) - \\rho_{S,\\lambda}\\right)\\exp \\left( -2\\sqrt {\\zeta_\\lambda \\kappa_{b}\\left(\\theta_S\\right)LAI} \\right)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.88em;vertical-align:-1.69em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.19em;\"><span style=\"top:-2.11em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"mord\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6705em;\"><span style=\"top:-2.3987em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4374em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6705em;\"><span style=\"top:-2.3987em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4374em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ψ</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6705em;\"><span style=\"top:-2.3987em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3013em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.935em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0738em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span><span style=\"top:-2.895em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.305em;\"><span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span></span></span><span style=\"top:-3.38em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-4.19em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"mord\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-2.4169em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4192em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.954em;\"><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\">−</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.835em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0738em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.795em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.205em;\"><span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">t</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"2","html_id":"eq-tau-dir","key":"Yd6iTsWcbk"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"with (","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"RHIGgfzKI3"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"xLESrjQ3Qi"},{"type":"text","value":") being either the PAR or NIR. ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"pZi1o000fg"},{"type":"inlineMath","value":"\\rho_{C,\\lambda}^*\\left(\\psi\\right)","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow><mo>∗</mo></msubsup><mrow><mo fence=\"true\">(</mo><mi>ψ</mi><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\rho_{C,\\lambda}^*\\left(\\psi\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1692em;vertical-align:-0.4192em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-2.4169em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4192em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ψ</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span></span></span></span>","key":"s6hs7HtPR9"},{"type":"text","value":" is the beam spectral reflection coefficient for a deep canopy with non-horizontal leaves (see Eq. ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"nm8E7znBd0"},{"type":"crossReference","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"(","key":"XT4GQmtPbC"},{"type":"text","value":"3","key":"GXyszNUl1L"},{"type":"text","value":")","key":"dywnRda9Fr"}],"identifier":"eq-rho-star","label":"eq-rho-star","kind":"equation","template":"(%s)","enumerator":"3","resolved":true,"html_id":"eq-rho-star","key":"qhAj1eE28a"},{"type":"text","value":"), ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"SRrK92jrFs"},{"type":"inlineMath","value":"\\zeta_\\lambda","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ζ</mi><mi>λ</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\zeta_\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0738em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"didGvBaBAk"},{"type":"text","value":" is the leaf absortivity, ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"HOMc7U0uYv"},{"type":"inlineMath","value":"\\kappa_{b}","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>κ</mi><mi>b</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\kappa_{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lgRAIFpjSB"},{"type":"text","value":" is the extinction coefficient for direct-beam radiation (per LAI unit), and ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"pOSGK0RPtM"},{"type":"inlineMath","value":"\\rho_{S,\\lambda}","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\rho_{S,\\lambda}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"pAYdAY7wXp"},{"type":"text","value":" is the soil spectral reflectance. The multiple scattering between the soil and the canopy is accounted for in the ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"jKxJixvvql"},{"type":"inlineMath","value":"\\rho _{C,\\lambda}^*","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow><mo>∗</mo></msubsup></mrow><annotation encoding=\"application/x-tex\">\\rho _{C,\\lambda}^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1079em;vertical-align:-0.4192em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-2.4169em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4192em;\"><span></span></span></span></span></span></span></span></span></span>","key":"wQHyScO3n0"},{"type":"text","value":" and ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"SiV19bu0qw"},{"type":"inlineMath","value":"\\rho_{S,\\lambda}","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\rho_{S,\\lambda}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"e9FkqFXCWu"},{"type":"text","value":" terms.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"ZXXiwGwRPy"}],"key":"MQJGfuhNIW"},{"type":"math","value":"\\rho_{C,\\lambda}^*\\left(\\theta_S\\right)=\\frac{2\\kappa_b\\left(\\theta_S\\right) \\rho_\\lambda^H}{\\kappa_b\\left(\\theta_S\\right)+1}","label":"eq-rho-star","identifier":"eq-rho-star","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow><mo>∗</mo></msubsup><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mo>=</mo><mfrac><mrow><mn>2</mn><msub><mi>κ</mi><mi>b</mi></msub><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><msubsup><mi>ρ</mi><mi>λ</mi><mi>H</mi></msubsup></mrow><mrow><msub><mi>κ</mi><mi>b</mi></msub><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\rho_{C,\\lambda}^*\\left(\\theta_S\\right)=\\frac{2\\kappa_b\\left(\\theta_S\\right) \\rho_\\lambda^H}{\\kappa_b\\left(\\theta_S\\right)+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1331em;vertical-align:-0.3831em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3831em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4543em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5183em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4169em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.08125em;\">H</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"3","html_id":"eq-rho-star","key":"j9HD1ogPzq"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"inlineMath","value":"\\rho_\\lambda^H=\\frac{1 - \\sqrt{\\zeta_\\lambda}}{1+\\sqrt{\\zeta_\\lambda}}","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>ρ</mi><mi>λ</mi><mi>H</mi></msubsup><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msqrt><msub><mi>ζ</mi><mi>λ</mi></msub></msqrt></mrow><mrow><mn>1</mn><mo>+</mo><msqrt><msub><mi>ζ</mi><mi>λ</mi></msub></msqrt></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\rho_\\lambda^H=\\frac{1 - \\sqrt{\\zeta_\\lambda}}{1+\\sqrt{\\zeta_\\lambda}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1244em;vertical-align:-0.2831em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4169em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.08125em;\">H</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.576em;vertical-align:-0.538em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.038em;\"><span style=\"top:-2.6016em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">+</span><span class=\"mord sqrt mtight\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8406em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mtight\" style=\"padding-left:0.833em;\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:-0.0738em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.8006em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail mtight\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1994em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4496em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">−</span><span class=\"mord sqrt mtight\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8406em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mtight\" style=\"padding-left:0.833em;\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:-0.0738em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.8006em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail mtight\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1994em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.538em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"ffmriBlSDw"},{"type":"text","value":" is the reflectance factor for a canopy with horizontal leaves.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"hzAd6K9x7C"}],"key":"RID5fUMUoT"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Finally, the canopy beam extinction ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"eeZgFTJhtm"},{"type":"inlineMath","value":"\\kappa_b\\left(\\psi\\right)","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>κ</mi><mi>b</mi></msub><mrow><mo fence=\"true\">(</mo><mi>ψ</mi><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\kappa_b\\left(\\psi\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ψ</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span></span></span></span>","key":"YDN8E0eiYC"},{"type":"text","value":" is calculated based on the ellipsoidal LADF of ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"sjbZviImPo"},{"type":"cite","url":"https://doi.org/10.1016/0168-1923(90)90030-A","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Campbell (1990)","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"b9FcKF9nvS"}],"kind":"narrative","label":"Campbell_1990","identifier":"https://doi.org/10.1016/0168-1923(90)90030-A","enumerator":"7","key":"w0HDHzqCjn"}],"key":"zluUQqk1v4"},{"type":"math","value":"\\kappa_b\\left(\\theta_S\\right)=\\frac{\\sqrt{\\chi^2+ \\tan^2\\theta_S}}{\\chi+1.774\\left(\\chi+1.182\\right)^{-0.733}}","label":"eq-kbe","identifier":"eq-kbe","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>κ</mi><mi>b</mi></msub><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mo>=</mo><mfrac><msqrt><mrow><msup><mi>χ</mi><mn>2</mn></msup><mo>+</mo><msup><mrow><mi>tan</mi><mo>⁡</mo></mrow><mn>2</mn></msup><msub><mi>θ</mi><mi>S</mi></msub></mrow></msqrt><mrow><mi>χ</mi><mo>+</mo><mn>1.774</mn><msup><mrow><mo fence=\"true\">(</mo><mi>χ</mi><mo>+</mo><mn>1.182</mn><mo fence=\"true\">)</mo></mrow><mrow><mo>−</mo><mn>0.733</mn></mrow></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\kappa_b\\left(\\theta_S\\right)=\\frac{\\sqrt{\\chi^2+ \\tan^2\\theta_S}}{\\chi+1.774\\left(\\chi+1.182\\right)^{-0.733}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.7683em;vertical-align:-1.094em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6743em;\"><span style=\"top:-2.156em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">χ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1.774</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\">χ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1.182</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.954em;\"><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">0.733</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9973em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mord mathnormal\">χ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mop\"><span class=\"mop\">tan</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8191em;\"><span style=\"top:-3.068em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.9573em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2427em;\"><span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.094em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"4","html_id":"eq-kbe","key":"SySEAzdrLb"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Diffuse spectral transmittance (","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"QUEZDr9vc2"},{"type":"inlineMath","value":"\\tau_{C,DIF,\\lambda}","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>τ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>D</mi><mi>I</mi><mi>F</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\tau_{C,DIF,\\lambda}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">F</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"iX75tH1Gos"},{"type":"text","value":") is calculated by numerically integrating ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"p49q4PjW5C"},{"type":"inlineMath","value":"\\kappa_b","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>κ</mi><mi>b</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\kappa_b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yaSdspOYaL"},{"type":"text","value":" over the hemisphere","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"LzP5kEFvbI"}],"key":"JdeNcoo4lA"},{"type":"math","value":"\\kappa_d =2 \\int_0^\\pi\\kappa_b\\left(\\psi\\right) \\sin\\psi \\cos\\psi d\\psi","label":"eq-kd","identifier":"eq-kd","tight":"after","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>κ</mi><mi>d</mi></msub><mo>=</mo><mn>2</mn><msubsup><mo>∫</mo><mn>0</mn><mi>π</mi></msubsup><msub><mi>κ</mi><mi>b</mi></msub><mrow><mo fence=\"true\">(</mo><mi>ψ</mi><mo fence=\"true\">)</mo></mrow><mi>sin</mi><mo>⁡</mo><mi>ψ</mi><mi>cos</mi><mo>⁡</mo><mi>ψ</mi><mi>d</mi><mi>ψ</mi></mrow><annotation encoding=\"application/x-tex\">\\kappa_d =2 \\int_0^\\pi\\kappa_b\\left(\\psi\\right) \\sin\\psi \\cos\\psi d\\psi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3262em;vertical-align:-0.9119em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4143em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ψ</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ψ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ψ</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ψ</span></span></span></span></span>","enumerator":"5","html_id":"eq-kd","key":"xxm5GEwtfA"},{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"and replacing ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"KCDeauRp8b"},{"type":"inlineMath","value":"\\kappa_b","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>κ</mi><mi>b</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\kappa_b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"OWjvDjQ8vx"},{"type":"text","value":" by ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"j5MudexrSZ"},{"type":"inlineMath","value":"\\kappa_d","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>κ</mi><mi>d</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\kappa_d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jGZONtGIaY"},{"type":"text","value":" in Eq. ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"ONdA3VKwSC"},{"type":"crossReference","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"(","key":"jZa6W5rWul"},{"type":"text","value":"2","key":"UbtKLht633"},{"type":"text","value":")","key":"g6axEAItqI"}],"identifier":"eq-tau-dir","label":"eq-tau-dir","kind":"equation","template":"(%s)","enumerator":"2","resolved":true,"html_id":"eq-tau-dir","key":"ErmQNt9bz4"}],"key":"oDAdcnfeXC"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Similarly the canopy direct spectral albedo is computed as:","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"CxyePtvh7S"}],"key":"qBEJJCX6Nr"},{"type":"math","value":"\\rho_{C,DIR,\\lambda}\\left(\\theta_S\\right)=\\frac{\\rho_{C,\\lambda}^*\\left(\\theta_S\\right) + \\left[\\frac{\\rho_{C,\\lambda}^*\\left(\\theta_S\\right) - \\rho_{S,\\lambda}}{\\rho_{C,\\lambda}^*\\left(\\theta_S\\right)\\rho_{s,\\lambda} -1}\\right] \\exp\\left(-2\\sqrt{\\zeta_\\lambda}\\kappa_b\\left(\\theta_S\\right)LAI\\right)}{1 + \\rho_{C,\\lambda}^*\\left(\\theta_S\\right) + \\left[\\frac{\\rho_{C,\\lambda}^*\\left(\\theta_S\\right) - \\rho_{s,\\lambda}}{\\rho_{C,\\lambda}^*\\left(\\theta_S\\right)\\rho_{S,\\lambda} -1}\\right] \\exp\\left(-2\\sqrt{\\zeta_\\lambda}\\kappa_b\\left(\\theta_S\\right)LAI\\right)}","label":"eq-rho-dir","identifier":"eq-rho-dir","tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>D</mi><mi>I</mi><mi>R</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow></msub><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mo>=</mo><mfrac><mrow><msubsup><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow><mo>∗</mo></msubsup><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mo>+</mo><mrow><mo fence=\"true\">[</mo><mfrac><mrow><msubsup><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow><mo>∗</mo></msubsup><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mo>−</mo><msub><mi>ρ</mi><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow></msub></mrow><mrow><msubsup><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow><mo>∗</mo></msubsup><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><msub><mi>ρ</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow></msub><mo>−</mo><mn>1</mn></mrow></mfrac><mo fence=\"true\">]</mo></mrow><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mo>−</mo><mn>2</mn><msqrt><msub><mi>ζ</mi><mi>λ</mi></msub></msqrt><msub><mi>κ</mi><mi>b</mi></msub><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mi>L</mi><mi>A</mi><mi>I</mi><mo fence=\"true\">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><msubsup><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow><mo>∗</mo></msubsup><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mo>+</mo><mrow><mo fence=\"true\">[</mo><mfrac><mrow><msubsup><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow><mo>∗</mo></msubsup><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mo>−</mo><msub><mi>ρ</mi><mrow><mi>s</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow></msub></mrow><mrow><msubsup><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow><mo>∗</mo></msubsup><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><msub><mi>ρ</mi><mrow><mi>S</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow></msub><mo>−</mo><mn>1</mn></mrow></mfrac><mo fence=\"true\">]</mo></mrow><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mo>−</mo><mn>2</mn><msqrt><msub><mi>ζ</mi><mi>λ</mi></msub></msqrt><msub><mi>κ</mi><mi>b</mi></msub><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mi>L</mi><mi>A</mi><mi>I</mi><mo fence=\"true\">)</mo></mrow></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\rho_{C,DIR,\\lambda}\\left(\\theta_S\\right)=\\frac{\\rho_{C,\\lambda}^*\\left(\\theta_S\\right) + \\left[\\frac{\\rho_{C,\\lambda}^*\\left(\\theta_S\\right) - \\rho_{S,\\lambda}}{\\rho_{C,\\lambda}^*\\left(\\theta_S\\right)\\rho_{s,\\lambda} -1}\\right] \\exp\\left(-2\\sqrt{\\zeta_\\lambda}\\kappa_b\\left(\\theta_S\\right)LAI\\right)}{1 + \\rho_{C,\\lambda}^*\\left(\\theta_S\\right) + \\left[\\frac{\\rho_{C,\\lambda}^*\\left(\\theta_S\\right) - \\rho_{s,\\lambda}}{\\rho_{C,\\lambda}^*\\left(\\theta_S\\right)\\rho_{S,\\lambda} -1}\\right] \\exp\\left(-2\\sqrt{\\zeta_\\lambda}\\kappa_b\\left(\\theta_S\\right)LAI\\right)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.9758em;vertical-align:-1.7506em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.2253em;\"><span style=\"top:-2.11em;\"><span class=\"pstrut\" style=\"height:3.1753em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6705em;\"><span style=\"top:-2.3987em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4374em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">[</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1753em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6771em;\"><span style=\"top:-2.1528em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-2.8448em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4861em;\"><span></span></span></span></span></span></span><span class=\"minner mtight\"><span class=\"mopen mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">(</span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3567em;margin-left:-0.0278em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1433em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">)</span></span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2901em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6503em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6771em;\"><span style=\"top:-2.1528em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-2.8448em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4861em;\"><span></span></span></span></span></span></span><span class=\"minner mtight\"><span class=\"mopen mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">(</span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3567em;margin-left:-0.0278em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1433em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">)</span></span></span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2901em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6853em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.835em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0738em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.795em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.205em;\"><span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span></span></span><span style=\"top:-3.4053em;\"><span class=\"pstrut\" style=\"height:3.1753em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-4.2506em;\"><span class=\"pstrut\" style=\"height:3.1753em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-2.4169em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4192em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">[</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1418em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6771em;\"><span style=\"top:-2.1528em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-2.8448em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4861em;\"><span></span></span></span></span></span></span><span class=\"minner mtight\"><span class=\"mopen mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">(</span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3567em;margin-left:-0.0278em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1433em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">)</span></span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2901em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6074em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7633em;\"><span style=\"top:-2.214em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4249em;\"><span></span></span></span></span></span></span><span class=\"minner mtight\"><span class=\"mopen mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">(</span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3567em;margin-left:-0.0278em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1433em;\"><span></span></span></span></span></span></span><span class=\"mclose mtight delimcenter\" style=\"top:0em;\"><span class=\"mtight\">)</span></span></span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2901em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6853em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.835em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0738em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.795em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.205em;\"><span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7506em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"6","html_id":"eq-rho-dir","key":"EinU5Y89I4"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"and the diffuse canopy albedo (","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"IijzhbPFeq"},{"type":"inlineMath","value":"\\rho_{C,DIF,\\lambda}","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>D</mi><mi>I</mi><mi>F</mi><mo separator=\"true\">,</mo><mi>λ</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\rho_{C,DIF,\\lambda}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">F</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yEkrI2v0UM"},{"type":"text","value":") by replacing ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"n6zVnB98dk"},{"type":"inlineMath","value":"\\kappa_b\\left(\\theta_S\\right)","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>κ</mi><mi>b</mi></msub><mrow><mo fence=\"true\">(</mo><msub><mi>θ</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\kappa_b\\left(\\theta_S\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span></span></span></span>","key":"wncjj3QgQs"},{"type":"text","value":" by ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"XZALNFwkQ3"},{"type":"inlineMath","value":"\\kappa_d","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>κ</mi><mi>d</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\kappa_d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"bAfEYZAAxk"}],"key":"HbfXXECJNs"},{"type":"paragraph","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Therefore as inputs for computin net shortwave radiation we need to provide as input forcing the solar irradiance, direct and diffuse in the PAR and NIR, and then as main input the ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"dpknbm3Qp4"},{"type":"inlineMath","value":"LAI","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>A</mi><mi>I</mi></mrow><annotation encoding=\"application/x-tex\">LAI</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span></span>","key":"gDxRrTGy2Y"},{"type":"text","value":", followed by soil and leaf spectra and ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"SGbe5KvRAd"},{"type":"cite","url":"https://doi.org/10.1016/0168-1923(90)90030-A","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Campbell (1990)","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"hVZLVjobSM"}],"kind":"narrative","label":"Campbell_1990","identifier":"https://doi.org/10.1016/0168-1923(90)90030-A","enumerator":"7","key":"SxWwpMHeqw"},{"type":"text","value":" LIDF parameter (","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"ILuKMxpmne"},{"type":"inlineMath","value":"\\chi","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>χ</mi></mrow><annotation encoding=\"application/x-tex\">\\chi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">χ</span></span></span></span>","key":"cMFdH59sTz"},{"type":"text","value":").","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"t0QQ1sBtJi"}],"key":"FXC1cb177B"},{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"In this example we will simplify things and assume that the canopy is horizontally homogeneous and thus no clumping index will be compute","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"yfCT0esB0v"}],"key":"RhulC37LCU"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"KMLwYDC5qd"}],"key":"y41EszexFy"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"we will get into more details on this topic in the ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"BNFmb24pga"},{"type":"link","url":"./401-Row_crops.ipynb","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"TSEB in row crops notebook","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"yOUlIwFTHI"}],"urlSource":"./401-Row_crops.ipynb","key":"Dva9jnASHL"}],"key":"CjPuX7UTwD"}],"key":"K1VpuG2kmi"}],"key":"PXwYCLd2ev"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"See Also","key":"aVDk1GKGgr"}],"key":"sorBc2zPOW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The code for estimating the diffuse and bean radiation is based on {Weiss and Norman (1985}(","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ihwRlfb5z6"},{"type":"cite","url":"http://dx.doi.org/10.1016/0168-1923(85)90020-6","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Weiss & Norman (1985)","key":"BKJKJ4XIwP"}],"kind":"narrative","label":"Weiss_1985","identifier":"http://dx.doi.org/10.1016/0168-1923(85)90020-6","enumerator":"8","key":"rhaQYUZQGs"},{"type":"text","value":") and can be found at the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WFmzr8aMFr"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/net_radiation.py#L62","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"pyTSEB GitHub repository","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ULrl8nQcQO"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/net_radiation.py#L62","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/net_radiation.py","from":62,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/net_radiation.py"},"internal":false,"protocol":"github","key":"FDJIYJhuBG"}],"key":"F3O56y8YpG"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The code for running the Cambpell and Norman (1998)[] model can be found at the pyTSEB GitHub repository: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HXSQEA1ZV9"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/net_radiation.py#L439","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"canopy spectral properties","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"z7wlGyPuc9"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/net_radiation.py#L439","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/net_radiation.py","from":439,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/net_radiation.py"},"internal":false,"protocol":"github","key":"hVyFDcVc3L"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VKppxQ83os"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/net_radiation.py#L546C5-L546C21","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"estimation of net shortwave radiation","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rP183lQANQ"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/net_radiation.py#L546C5-L546C21","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/net_radiation.py","from":546,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/net_radiation.py"},"internal":false,"protocol":"github","key":"Pm0Ky4u3H1"}],"key":"VW5efxov1U"}],"class":"dropdown","key":"Qmic9SvwJU"}],"key":"qqVXmCN4E4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Site location\nlat = 36.848\nlon = -120.174\n\n# The time zone is PST, which corresponds to -120 deg, time longitude\nstdlon = -120\n\n# Set the leaf and soil spectra\nrho_leaf_vis = 0.054\nrho_leaf_nir = 0.262\ntau_leaf_vis = 0.038\ntau_leaf_nir = 0.333\nrho_soil_vis = 0.07\nrho_soil_nir = 0.32\n\n# Set the Cambpell chi LIDF parameter [default=1, spherical LIDF]\nx_lad = 1\n\n# The ASCII table is missing the solar angles, so we will use the calc_sun_angles function of TSEB to compute the angles based on site location and timestamp\ntheta, saa = TSEB.met.calc_sun_angles(\n    np.full_like(ec['LAI'].values, lat),\n    np.full_like(ec[\"LAI\"].values, lon),\n    np.full_like(ec[\"LAI\"].values, stdlon),\n    ec['TIMESTAMP'].dt.dayofyear.values,\n    ec['TIMESTAMP'].dt.hour.values + ec['TIMESTAMP'].dt.minute.values / 60.)\n\n\n# In order to esimate Estimates the direct and diffuse solar radiation based on the Weiss and Norman model\ndifvis, difnir, fvis, fnir = TSEB.rad.calc_difuse_ratio(ec[\"SW_IN\"].values,\n                                                        theta,\n                                                        press=np.full_like(theta, 1013.15))\npar_dir = fvis * (1. - difvis) * ec[\"SW_IN\"].values\nnir_dir = fnir * (1. - difnir) * ec[\"SW_IN\"].values\npar_dif = fvis * difvis * ec[\"SW_IN\"].values\nnir_dif = fnir * difnir * ec[\"SW_IN\"].values\n\n# Vectorize the input scalar variables\nx_lad = np.full_like(ec[\"LAI\"].values, x_lad)\nrho_leaf_vis = np.full_like(ec[\"LAI\"].values, rho_leaf_vis)\nrho_leaf_nir = np.full_like(ec[\"LAI\"].values, rho_leaf_nir)\ntau_leaf_vis = np.full_like(ec[\"LAI\"].values, tau_leaf_vis)\ntau_leaf_nir = np.full_like(ec[\"LAI\"].values, tau_leaf_nir)\nrho_soil_vis = np.full_like(ec[\"LAI\"].values, rho_soil_vis)\nrho_soil_nir = np.full_like(ec[\"LAI\"].values, rho_soil_nir)\n\n# We append the VIS and PAR spectrum to be computationally more efficient in Numpy\nrho_leaf = np.array((rho_leaf_vis, rho_leaf_nir))\ntau_leaf = np.array((tau_leaf_vis, tau_leaf_nir))\nrho_soil = np.array((rho_soil_vis, rho_soil_nir))\n\n# calculate aborprtivity\namean = 1.0 - rho_leaf - tau_leaf\namean_sqrt = np.sqrt(amean)\n\n# Calculate canopy beam extinction coefficient\nlai_eff = np.asarray(ec[\"LAI\"].values)  # So far we are assuming a homogenous canopy so the effective LAI of a clumped canopy does not vary\n\n# D I F F U S E   C O M P O N E N T S\n# Integrate to get the diffuse transmitance\n\ntaud = 0\nfor angle in range(0, 90, 5):\n    angle = np.radians(angle)\n    akd = (np.sqrt(x_lad**2 + np.tan(theta)**2) / (x_lad + 1.774 * (x_lad + 1.182)**-0.733))  # Eq. 15.4\n    taub = np.exp(-akd * ec[\"LAI\"].values)\n    taud += taub * np.cos(angle) * np.sin(angle) * np.radians(5)\n\ntaud = 2.0 * taud\n\n# Diffuse light canopy reflection coefficients  for a deep canopy\nakd = -np.log(taud) / ec[\"LAI\"].values\nrcpy= (1.0 - amean_sqrt) / (1.0 + amean_sqrt)  # Eq 15.7\nrdcpy = 2.0 * akd * rcpy / (akd + 1.0)  # Eq 15.8\n\n# Diffuse canopy transmission and albedo coeff for a generic canopy (visible)\nexpfac = amean_sqrt * akd * ec[\"LAI\"].values\nneg_exp, d_neg_exp = np.exp(-expfac), np.exp(-2.0 * expfac)\nxnum = (rdcpy * rdcpy - 1.0) * neg_exp\nxden = (rdcpy * rho_soil - 1.0) + rdcpy * (rdcpy - rho_soil) * d_neg_exp\ntaudt = xnum / xden  # Eq 15.11\nfact = ((rdcpy - rho_soil) / (rdcpy * rho_soil - 1.0)) * d_neg_exp\nalbd = (rdcpy + fact) / (1.0 + rdcpy * fact)  # Eq 15.9\n\n# B E A M   C O M P O N E N T S\n# Direct beam extinction coeff (spher. LAD)\nakb = (np.sqrt(x_lad**2 + np.tan(theta)**2) / (x_lad + 1.774 * (x_lad + 1.182)**-0.733))  # Eq. 15.4\n\n# Direct beam canopy reflection coefficients for a deep canopy\nrbcpy = 2.0 * akb * rcpy / (akb + 1.0)  # Eq 15.8\n# Beam canopy transmission and albedo coeff for a generic canopy (visible)\nexpfac = amean_sqrt * akb * lai_eff\nneg_exp, d_neg_exp = np.exp(-expfac), np.exp(-2.0 * expfac)\nxnum = (rbcpy * rbcpy - 1.0) * neg_exp\nxden = (rbcpy * rho_soil - 1.0) + rbcpy * (rbcpy - rho_soil) * d_neg_exp\ntaubt = xnum / xden  # Eq 15.11\nfact = ((rbcpy - rho_soil) / (rbcpy * rho_soil - 1.0)) * d_neg_exp\nalbb = (rbcpy + fact) / (1.0 + rbcpy * fact)  # Eq 15.9\n\ntaubt, taudt, albb, albd, rho_soil = map(np.array,\n                                         [taubt, taudt, albb, albd, rho_soil])\n\ntaubt[np.isnan(taubt)] = 1\ntaudt[np.isnan(taudt)] = 1\nalbb[np.isnan(albb)] = rho_soil[np.isnan(albb)]\nalbd[np.isnan(albd)] = rho_soil[np.isnan(albd)]\n\n# Compute the canopy and soil net radiation using Cambpell RTM\nsn_c = ((1.0 - taubt[0]) * (1.0- albb[0]) * par_dir\n            + (1.0 - taubt[1]) * (1.0- albb[1]) * nir_dir\n            + (1.0 - taudt[0]) * (1.0- albd[0]) * par_dif\n            + (1.0 - taudt[1]) * (1.0- albd[1]) * nir_dif)\n\nsn_s = (taubt[0] * (1.0 - rho_soil_vis) * par_dir\n            + taubt[1] * (1.0 - rho_soil_nir) * nir_dir\n            + taudt[0] * (1.0 - rho_soil_vis) * par_dif\n            + taudt[1] * (1.0 - rho_soil_nir) * nir_dif)\n\nprint(\"Finished the computation of net shortwave radiation\")","key":"w4Iu6tyP20"},{"type":"output","id":"HLz_otE73UQvJRrxQ9h1g","data":[],"key":"H6RYTZLeEp"}],"key":"IpETYKzHsq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evaluate net shortwave radiation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jNOZkOS19i"}],"identifier":"evaluate-net-shortwave-radiation","label":"Evaluate net shortwave radiation","html_id":"evaluate-net-shortwave-radiation","implicit":true,"key":"bg2YADDxNV"}],"key":"Dj9oXtBi82"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from plotly.subplots import make_subplots\nimport plotly.graph_objects as go\ndaytime = ec[\"SW_IN\"] > 100\n\nsn_model = sn_c + sn_s\nsn_obs = ec[\"SW_IN\"].values - ec[\"SW_OUT\"].values\n\nfig = go.Figure()\nfig.add_trace(go.Scatter(x=sn_model[daytime], y=sn_obs[daytime], \n                         name=\"Sn\", mode=\"markers\"))\nfig.add_trace(go.Scatter(x=[0, 1000], y=[0, 1000], mode=\"lines\", name=\"1:1 line\", line={\"color\": \"black\", \"dash\": \"dash\"}))\nfig.update_layout(title_text=f\"Observed vs. Estimated net shortwave radiation at {site}\",\n                  yaxis_range=[0, 1000], xaxis_range=[0, 1000],\n                  xaxis_title=\"Estimated (W m-2)\", yaxis_title=\"Observed (W m-2)\")","key":"itVtrGr4bp"},{"type":"output","id":"uiPKP8wpf36uEzdqRJWS-","data":[],"key":"oTzJYMiSgw"}],"key":"cRd9yydqoy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Net longwave radiation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AEBw02RLAD"}],"identifier":"net-longwave-radiation","label":"Net longwave radiation","html_id":"net-longwave-radiation","implicit":true,"key":"Ni9PCpzgKS"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The net longwave radiation a priori is much simpler as we assume that all emitted and indident longwave radiation is diffuse. In pyTSEB we follow a similar approach as the one described in ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yppqjiqkRH"},{"type":"cite","url":"https://doi.org/10.1016/S0168-1923(99)00005-2","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Kustas and Norman (1999)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jcS5iSoc5C"}],"kind":"narrative","label":"Kustas_1999","identifier":"https://doi.org/10.1016/S0168-1923(99)00005-2","enumerator":"9","key":"ZcgbW6wuX3"},{"type":"text","value":" for partially vegetated surfaces, which also partitions net longwave radiation into the soil (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"oyJiQCZJLi"},{"type":"inlineMath","value":"L_{n,S}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>S</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">L_{n,S}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lKq8xIWCVT"},{"type":"text","value":") and the canopy components (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ro2VrVSMOe"},{"type":"inlineMath","value":"L_{n,C}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>C</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">L_{n,C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KxLfG0wASS"},{"type":"text","value":"). The only difference between pyTSEB and the formulation of ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"nYfvFPxNON"},{"type":"cite","url":"https://doi.org/10.1016/S0168-1923(99)00005-2","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Kustas and Norman (1999)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"trHbkfvlYB"}],"kind":"narrative","label":"Kustas_1999","identifier":"https://doi.org/10.1016/S0168-1923(99)00005-2","enumerator":"9","key":"UjvH6OQg0v"},{"type":"text","value":" is that we incorporate longwave scattering between the soil and the canopy:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"va6wttpG9G"}],"key":"bPiDEqglDu"},{"type":"math","value":"L_{n,S} &= \\epsilon_S \\kappa_l LAI L_{sky} + \\epsilon_S \\left(1.0 - \\kappa_l LAI * L_{sky} \\right) L_C - L_S\\\\\nL_{n,C} &= \\epsilon_C \\left(1.0 - \\kappa_l LAI * L_{sky}\\right) \\left(L_{sky} + L_S\\right) - 2.0 \\left(1.0 - \\kappa_l LAI\\right) L_C","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>L</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>S</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mi>ϵ</mi><mi>S</mi></msub><msub><mi>κ</mi><mi>l</mi></msub><mi>L</mi><mi>A</mi><mi>I</mi><msub><mi>L</mi><mrow><mi>s</mi><mi>k</mi><mi>y</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mi>S</mi></msub><mrow><mo fence=\"true\">(</mo><mn>1.0</mn><mo>−</mo><msub><mi>κ</mi><mi>l</mi></msub><mi>L</mi><mi>A</mi><mi>I</mi><mo>∗</mo><msub><mi>L</mi><mrow><mi>s</mi><mi>k</mi><mi>y</mi></mrow></msub><mo fence=\"true\">)</mo></mrow><msub><mi>L</mi><mi>C</mi></msub><mo>−</mo><msub><mi>L</mi><mi>S</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>L</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>C</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mi>ϵ</mi><mi>C</mi></msub><mrow><mo fence=\"true\">(</mo><mn>1.0</mn><mo>−</mo><msub><mi>κ</mi><mi>l</mi></msub><mi>L</mi><mi>A</mi><mi>I</mi><mo>∗</mo><msub><mi>L</mi><mrow><mi>s</mi><mi>k</mi><mi>y</mi></mrow></msub><mo fence=\"true\">)</mo></mrow><mrow><mo fence=\"true\">(</mo><msub><mi>L</mi><mrow><mi>s</mi><mi>k</mi><mi>y</mi></mrow></msub><mo>+</mo><msub><mi>L</mi><mi>S</mi></msub><mo fence=\"true\">)</mo></mrow><mo>−</mo><mn>2.0</mn><mrow><mo fence=\"true\">(</mo><mn>1.0</mn><mo>−</mo><msub><mi>κ</mi><mi>l</mi></msub><mi>L</mi><mi>A</mi><mi>I</mi><mo fence=\"true\">)</mo></mrow><msub><mi>L</mi><mi>C</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align*}\nL_{n,S} &amp;= \\epsilon_S \\kappa_l LAI L_{sky} + \\epsilon_S \\left(1.0 - \\kappa_l LAI * L_{sky} \\right) L_C - L_S\\\\\nL_{n,C} &amp;= \\epsilon_C \\left(1.0 - \\kappa_l LAI * L_{sky}\\right) \\left(L_{sky} + L_S\\right) - 2.0 \\left(1.0 - \\kappa_l LAI\\right) L_C\n\\end{align*}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.75em;\"><span style=\"top:-3.91em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.25em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.75em;\"><span style=\"top:-3.91em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\">1.0</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\">1.0</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">2.0</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\">1.0</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.25em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"7","key":"ig3GVSz1vw"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"WTOOT7dJKF"},{"type":"inlineMath","value":"L_{sky}","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mrow><mi>s</mi><mi>k</mi><mi>y</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">L_{sky}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YAJt2hSYKA"},{"type":"text","value":" is the downwelling atmospheric longwave irradiance, ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"WtLhR6O0Fa"},{"type":"inlineMath","value":"L_S","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">L_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"btKBI8e6UJ"},{"type":"text","value":" and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"lgz5yZYUa2"},{"type":"inlineMath","value":"L_C","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">L_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"x3vrXXWywj"},{"type":"text","value":" are the longwave emission of respectively soil and canopy layers, ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"zOrYa1mrSM"},{"type":"inlineMath","value":"\\kappa_l","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>κ</mi><mi>l</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\kappa_l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rVYsRPrOMw"},{"type":"text","value":" is analogous to the shortwave diffuse transmittance (","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"qjgDIVGrl0"},{"type":"inlineMath","value":"\\kappa_d","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>κ</mi><mi>d</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\kappa_d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"OK1EE5N90C"},{"type":"text","value":") and thus it can be calculated from Eq. ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"zgxwFdAXvI"},{"type":"crossReference","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"(","key":"hOkGWJyEJN"},{"type":"text","value":"5","key":"LxAVsK1LJp"},{"type":"text","value":")","key":"GnhOs5nrpD"}],"identifier":"eq-kd","label":"eq-kd","kind":"equation","template":"(%s)","enumerator":"5","resolved":true,"html_id":"eq-kd","key":"LJJfyjkZCe"},{"type":"text","value":", ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"YfvYbPBR1P"},{"type":"inlineMath","value":"\\epsilon_S","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\epsilon_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"NkRatm0h37"},{"type":"text","value":" is soil emisivity and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ng2S4pDafK"},{"type":"inlineMath","value":"\\epsilon_C","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\epsilon_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"mhhiHLrhEI"},{"type":"text","value":" can be derived from Eq. ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"dYAPnBW9gg"},{"type":"crossReference","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"(","key":"QVFHUM8XZV"},{"type":"text","value":"6","key":"HO47PKA6jz"},{"type":"text","value":")","key":"YvvJ3xIlHD"}],"identifier":"eq-rho-dir","label":"eq-rho-dir","kind":"equation","template":"(%s)","enumerator":"6","resolved":true,"html_id":"eq-rho-dir","key":"VTVn4JjM5S"},{"type":"text","value":" (","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"mtrCX9dG2W"},{"type":"inlineMath","value":"\\epsilon_C = 1 - \\rho_{C,DIF,l}","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>C</mi></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>ρ</mi><mrow><mi>C</mi><mo separator=\"true\">,</mo><mi>D</mi><mi>I</mi><mi>F</mi><mo separator=\"true\">,</mo><mi>l</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\epsilon_C = 1 - \\rho_{C,DIF,l}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ρ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">F</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"g489HZo5TS"},{"type":"text","value":") and leaf emissivity.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HAS4DC5Myg"}],"key":"OUCMbxIK2O"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"k0ybuMW3Cn"}],"key":"THxYT4EROA"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Even we use a modified version of ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"IUgmRU3HfM"},{"type":"cite","url":"https://doi.org/10.1016/S0168-1923(99)00005-2","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Kustas and Norman (1999)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"AKDNYzqPFf"}],"kind":"narrative","label":"Kustas_1999","identifier":"https://doi.org/10.1016/S0168-1923(99)00005-2","enumerator":"9","key":"Z0oppukVR0"},{"type":"text","value":", the pyTSEB package also includes the original formulation ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"JOCeZBU45T"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/net_radiation.py#L244","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"nXKOPvfQYH"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/net_radiation.py#L244","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/net_radiation.py","from":244,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/net_radiation.py"},"internal":false,"protocol":"github","key":"eH64mfBQeB"}],"key":"ah98zYyEd3"}],"key":"Rct9mobFTg"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"However, ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"mTH9Fy0Ax3"},{"type":"inlineMath","value":"L_S","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">L_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"iVzvOIfxr4"},{"type":"text","value":" and ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"dMbGc612tJ"},{"type":"inlineMath","value":"L_C","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>L</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">L_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KKRCqE1OyK"},{"type":"text","value":" depend respectively on soil and canopy temperature, which at this stage is an unknown. For that reason the application of this equation is done internaly when deriving the component temperature and sensible heat fluxes (see the upcoming Section ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"U7bGsjqXqg"},{"type":"crossReference","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Sensible heat flux","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"A6NfWMcGoY"}],"identifier":"sec-h","label":"sec-h","kind":"heading","template":"{name}","resolved":true,"html_id":"sec-h","key":"oo90mbKBRH"},{"type":"text","value":")","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"zqUsZFtX9v"}],"key":"iezFQZfHou"}],"key":"N4I0jWRRqZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def calc_L_n_Campbell(T_C, T_S, L_dn, lai, emisVeg, emisGrd, x_LAD=1):\n    ''' Net longwave radiation for soil and canopy layers\n\n    Estimates the net longwave radiation for soil and canopy layers unisg based on equation 2a\n    from [Kustas1999]_ and incorporated the effect of the Leaf Angle Distribution based on [Campbell1998]_\n\n    Parameters\n    ----------\n    T_C : float\n        Canopy temperature (K).\n    T_S : float\n        Soil temperature (K).\n    L_dn : float\n        Downwelling atmospheric longwave radiation (w m-2).\n    lai : float\n        Effective Leaf (Plant) Area Index.\n    emisVeg : float\n        Broadband emissivity of vegetation cover.\n    emisGrd : float\n        Broadband emissivity of soil.\n    x_LAD: float, optional\n        x parameter for the ellipsoidal Leaf Angle Distribution function,\n        use x_LAD=1 for a spherical LAD.\n\n    Returns\n    -------\n    L_nC : float\n        Net longwave radiation of canopy (W m-2).\n    L_nS : float\n        Net longwave radiation of soil (W m-2).\n\n    References\n    ----------\n    .. [Kustas1999] Kustas and Norman (1999) Evaluation of soil and vegetation heat\n        flux predictions using a simple two-source model with radiometric temperatures for\n        partial canopy cover, Agricultural and Forest Meteorology, Volume 94, Issue 1,\n        Pages 13-29, http://dx.doi.org/10.1016/S0168-1923(99)00005-2.\n    '''\n\n    # calculate long wave emissions from canopy, soil and sky\n    L_C = emisVeg * met.calc_stephan_boltzmann(T_C)\n    L_C[np.isnan(L_C)] = 0\n    L_S = emisGrd * met.calc_stephan_boltzmann(T_S)\n    L_S[np.isnan(L_S)] = 0\n    # Calculate the canopy spectral properties\n    _, albl, _, taudl = calc_spectra_Cambpell(lai,\n                                              np.zeros(emisVeg.shape),\n                                              1.0 - emisVeg,\n                                              np.zeros(emisVeg.shape),\n                                              1.0 - emisGrd,\n                                              x_lad=x_LAD,\n                                              lai_eff=None)\n\n    # calculate net longwave radiation divergence of the soil\n    L_nS = emisGrd * taudl * L_dn + emisGrd * (1.0 - taudl) * L_C - L_S\n    L_nC = (1 - albl) * (1.0 - taudl) * (L_dn + L_S) - 2.0 * (1.0 - taudl) * L_C\n    L_nC[np.isnan(L_nC)] = 0\n    L_nS[np.isnan(L_nS)] = 0\n    return np.asarray(L_nC), np.asarray(L_nS)","key":"yrGK068pcH"},{"type":"output","id":"KddhlczaJ8Zcj2GawV-Hy","data":[],"key":"AmtkRX6kla"}],"key":"EyH9pMOWA2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Soil heat flux","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D1xE1z3o4Z"}],"identifier":"soil-heat-flux","label":"Soil heat flux","html_id":"soil-heat-flux","implicit":true,"key":"anphjXPuYo"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Soil heat flux is usually estimated as a fraction of the soil net radiation ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"CHfP3m8Xjo"},{"type":"inlineMath","value":"R_{n,S}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>S</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{n,S}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"nVsvRyRRMA"},{"type":"text","value":". Such fraction can be assumed constant along the day (e.g. ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ufNFShr3FI"},{"type":"inlineMath","value":"G=0.35 R_{n,S}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mo>=</mo><mn>0.35</mn><msub><mi>R</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>S</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">G=0.35 R_{n,S}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\">0.35</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rRV5PqHbDg"},{"type":"text","value":") or can change along the day, such as the sinusoidal function proposed by ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"f0PbkbDBlY"},{"type":"cite","url":"https://doi.org/10.1175/1520-0450(2003)042%3C0851:DCISHF%3E2.0.CO;2","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Santanello and Friedl, 2003","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AKYO6flDZ1"}],"kind":"narrative","label":"Santanello_2003","identifier":"https://doi.org/10.1175/1520-0450(2003)042%3C0851:DCISHF%3E2.0.CO;2","enumerator":"10","key":"rgmSvaAND6"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MbUPP2LkGs"}],"key":"AhzShUP7w9"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Since the computation of net longwave radiation is dependant of getting estimates of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"hOdyZG1hFi"},{"type":"inlineMath","value":"T_C","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"MnRNPUyyph"},{"type":"text","value":" and ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jZWiIoSznw"},{"type":"inlineMath","value":"T_S","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"QR3fhWrxSG"},{"type":"text","value":" and thus is computed internally in the TSEB modules during the iteration that will be discussed in the next section, ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"L6kygYw466"},{"type":"inlineMath","value":"G","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>","key":"MGkfi0oTi4"},{"type":"text","value":" is also computed within the TSEB function, being iteratevely recomputed every time a new ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rOhMtTGdqO"},{"type":"inlineMath","value":"T_C","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"LDsHjI7hbt"},{"type":"text","value":" and ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zko6JQFMMb"},{"type":"inlineMath","value":"T_S","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KQpmBzwDBu"},{"type":"text","value":" is obtained. The different TSEB versions in pyTSEB accept computing ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HLjZo7y2Fq"},{"type":"inlineMath","value":"G","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>","key":"Ku02hTyrQy"},{"type":"text","value":" in four different ways:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CXJgC2qRBZ"}],"key":"p7Ua65BtZA"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"As a constant ratio of ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"n438VHnSh3"},{"type":"inlineMath","value":"R_{n,S}","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>S</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{n,S}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tzIiVj1gPK"},{"type":"text","value":" ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"l2wnaD1YLD"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L2809","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"function ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"HivZZOBXv7"},{"type":"inlineCode","value":"calc_G_ratio","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qAb38E1zQx"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L2809","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/TSEB.py","from":2809,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py"},"internal":false,"protocol":"github","key":"cEtRPmCkP2"}],"key":"C8Ka0SjvD9"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"As time dependent ratio of ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JpgxCTNgEK"},{"type":"inlineMath","value":"R_{n,S}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>S</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{n,S}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lrYeXpfZRw"},{"type":"text","value":" according to a sinusoidal function ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CLe79dmBVw"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L2729","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"function ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"LiIpzQiqN2"},{"type":"inlineCode","value":"calc_G_time_diff","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"q7ro1OYNnr"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L2729","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/TSEB.py","from":2729,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py"},"internal":false,"protocol":"github","key":"KaVP3R6UV8"}],"key":"mKqpYHBk3B"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"As time dependent ratio of ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ZFn1gRwFGE"},{"type":"inlineMath","value":"R_{n,S}","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>S</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{n,S}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"RQBFMjdcHl"},{"type":"text","value":" according to a double assymetric sigmoid function ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"r6LGkTSCVB"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L2769","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"pyTSEB/TSEB.py","key":"ckNQFrVMTP"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L2769","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/TSEB.py","from":2769,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py"},"internal":false,"protocol":"github","key":"fnZTBjYldD"}],"key":"gMLvrv7vbl"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"As precomputed/prescribed values","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fTWxfseDIn"}],"key":"U3sZ3W98nj"}],"key":"V3WJBKW0OC"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"KNLWPweRNc"}],"key":"X5GjIBvl3v"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"This last option can be chosen to force the use of measured ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"aduW7XOtPw"},{"type":"inlineMath","value":"G","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>","key":"Gol7MzXmDh"},{"type":"text","value":" when running TSEB, which sometimes can be useful when testing and evaluating new (sub)modules into TSEB.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"dJe0qxlJ0w"}],"key":"eWtU813ZbR"}],"key":"TgDh1jJ2pI"}],"key":"rvMG02RQOo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Surface roughness","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PfD6U5ts2F"}],"identifier":"surface-roughness","label":"Surface roughness","html_id":"surface-roughness","implicit":true,"key":"VCGilfCM6V"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In addition, REBMs need additional ancillary inputs, such as air temperature, wind speed and canopy height or roughness. The latter accounts for the efficiency in the turbulent transport of heat and water between the land surface and the overlying air ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BtPTDPz7Bl"},{"type":"cite","url":"https://doi.org/10.1007/BF00709229","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Raupach (1994)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fs5C0PxX0u"}],"kind":"narrative","label":"Raupach_1994","identifier":"https://doi.org/10.1007/BF00709229","enumerator":"11","key":"KFZxiLYgtx"},{"type":"cite","url":"https://doi.org/10.1007/s00271-018-0610-z","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Alfieri et al. 2019","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"mIdsMKit3r"}],"kind":"narrative","label":"Alfieri_2018","identifier":"https://doi.org/10.1007/s00271-018-0610-z","enumerator":"3","key":"smXoPZvwCq"},{"type":"text","value":" (you can revisity the  ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"NBmO5GJqrd"},{"type":"link","url":"/turbulence-and-sensible-heat-flux","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"102​-Turbulence​_and​_sensible​_heat​_flux","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"w7gE5yFbTw"}],"urlSource":"./102-Turbulence_and_sensible_heat_flux.ipynb","dataUrl":"/turbulence-and-sensible-heat-flux.json","internal":true,"protocol":"file","key":"HnWQaW2qPz"},{"type":"text","value":" notebook). Specifically for pyTSEB, vegetation structure and density are also important for estimating wind and radiation extinction through the canopy layer affecting the radiation partitioning ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BN9BIEOD9B"},{"type":"cite","url":"https://doi.org/10.1007/s00271-019-00621-x","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Parry et al. (2019)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rfElGeIVLR"}],"kind":"narrative","label":"Parry_2019","identifier":"https://doi.org/10.1007/s00271-019-00621-x","enumerator":"12","key":"xteJKCHJRp"},{"type":"text","value":" and turbulent transport of  momentum, heat  and water vapour in the canopy air space ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"KtxQaAmyxU"},{"type":"cite","url":"https://doi.org/10.1007/s00271-018-0611-y","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Nieto et al. (2019)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dHHbcI7h96"}],"kind":"narrative","label":"Nieto_2018","identifier":"https://doi.org/10.1007/s00271-018-0611-y","enumerator":"13","key":"cJii24LqkL"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"pnOWBBKtBq"}],"key":"LPy3tyc4ez"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In pyTSEB, depending on the plant functional trait, roughness can be estimated using different methods. For short and herbaceous crops, the typical ratio of canopy height (","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"DAj5y4vtt4"},{"type":"inlineMath","value":"h_c","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">h_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IKiYtmnWWL"},{"type":"text","value":") is applied:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"KMfy9SQd2h"}],"key":"bNxZJwiboM"},{"type":"math","value":"d_0 &= 2/3 h_c\nz_{0m} & = 1/8 h_c","label":"eq-roughness-short","identifier":"eq-roughness-short","tight":"after","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left right\" columnspacing=\"0em 1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>d</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>2</mn><mi mathvariant=\"normal\">/</mi><mn>3</mn><msub><mi>h</mi><mi>c</mi></msub><msub><mi>z</mi><mrow><mn>0</mn><mi>m</mi></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>8</mn><msub><mi>h</mi><mi>c</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align*}\nd_0 &amp;= 2/3 h_c\nz_{0m} &amp; = 1/8 h_c\n\\end{align*}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.5em;vertical-align:-0.5em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1em;\"><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1em;\"><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">2/3</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">0</span><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1em;\"><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1/8</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"8","html_id":"eq-roughness-short","key":"enVHX9Ao8D"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"TrdAIaUIRI"},{"type":"inlineMath","value":"d_0","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">d_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"AJVaquTUEK"},{"type":"text","value":" is the zero-plane displacement height and ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"TtEMMIWikP"},{"type":"inlineMath","value":"z_{0m}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mrow><mn>0</mn><mi>m</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">z_{0m}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">0</span><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"WhrgZxIMe6"},{"type":"text","value":" is the roughness length for momentum.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"AbZhKA33d3"}],"key":"bGMIOFCwnc"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"For tall and woody canopies, in which leaf density and coverage can play a more importan role, pyTSEB can adopt the formulation of ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"pdU698hMN4"},{"type":"link","url":"https://doi.org/10.1016/S0168-1923(00)00153-2.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Schaudt and Dickinson (2000)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"mVMy3OEqxD"}],"urlSource":"http://dx.doi.org/10.1016/S0168-1923(00)00153-2.","data":{"doi":"10.1016/S0168-1923(00)00153-2."},"internal":false,"protocol":"doi","key":"Hytb5HDLDr"},{"type":"text","value":", which at the same time it relies on the model by [Raupach (1994))(","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"VahJg8HMPa"},{"type":"cite","url":"https://doi.org/10.1007/BF00709229","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Raupach (1994)","key":"OiEdqPsi28"}],"kind":"narrative","label":"Raupach_1994","identifier":"https://doi.org/10.1007/BF00709229","enumerator":"11","key":"kUcB25fO4V"},{"type":"text","value":")","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"XCcT24JUJB"}],"key":"nfnaKHOBba"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Since vineyards can be considered as open shrublands or short decidous broadleaved canopies, we will compute roughness based on ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"rGusVHTWUA"},{"type":"link","url":"https://doi.org/10.1016/S0168-1923(00)00153-2.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Schaudt and Dickinson (2000)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"R4AWCPWQSb"}],"urlSource":"http://dx.doi.org/10.1016/S0168-1923(00)00153-2.","data":{"doi":"10.1016/S0168-1923(00)00153-2."},"internal":false,"protocol":"doi","key":"kJrIRoJffD"},{"type":"text","value":". As inputs we need not only the canopy height (","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"MHUOaGq0lT"},{"type":"inlineMath","value":"h_c","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">h_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"CaKK38T58a"},{"type":"text","value":"), but alos the ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"SwN9VGdwCj"},{"type":"inlineMath","value":"LAI","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>A</mi><mi>I</mi></mrow><annotation encoding=\"application/x-tex\">LAI</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span></span>","key":"JclIsQSpkh"},{"type":"text","value":", the fractional cover and the width-to-height canopy ratio (","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"wbTpOxOHWo"},{"type":"inlineMath","value":"w_c","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"BBmnRUFjLL"},{"type":"text","value":")","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"zgGuXSB7qU"}],"key":"DZCgKr5E50"},{"type":"heading","depth":4,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Estimate the structural variables based on Earth Observation LAI timeseries","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"t9ZqGaBUBl"}],"identifier":"estimate-the-structural-variables-based-on-earth-observation-lai-timeseries","label":"Estimate the structural variables based on Earth Observation LAI timeseries","html_id":"estimate-the-structural-variables-based-on-earth-observation-lai-timeseries","implicit":true,"key":"wAWH4fyPJq"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"These canopy structural variables could be retrieved using empirical equations derived in ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"JbBmNcs0If"},{"type":"link","url":"","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Nieto et al. (2019","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"m4ahSrMeZm"}],"urlSource":"","key":"AAmJOedhUU"},{"type":"text","value":". These were estimated from the daily LAI using empirical curves (","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"IBYdEyPOfo"},{"type":"crossReference","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Figure ","key":"qsekUrKLAV"},{"type":"text","value":"2","key":"RrK3en77jn"}],"identifier":"structural-functions","label":"structural-functions","kind":"figure","template":"Figure %s","enumerator":"2","resolved":true,"html_id":"structural-functions","key":"yWLViLcbNz"},{"type":"text","value":" fit with measured in situ values during four Intensive Observation Periods in 2015 in Sierra Loma. The empirical fits were constrained by the following boundary conditions:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"dyvexR7HIe"}],"key":"Zv1bUliYuP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":20,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"inlineMath","value":"h_c","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">h_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"FMA8UEmTF7"},{"type":"text","value":" should tend to the height of the vine trellis when LAI tends to zero, as this is where the branches with sprouts are located:","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"SV8gelXNZ4"}],"key":"kkjzXQTnLm"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"canopy width (","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"z1Mz8WUCqU"},{"type":"inlineMath","value":"w_c","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KLh4Hz8Tao"},{"type":"text","value":") should tend to the width of the vine trellis when LAI tends to zero, as the branches with sprouts follows a “T” pattern:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"G2SwxHbXjD"}],"key":"AID74nBwiB"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"the height of the bottom of the canopy tends to ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"URagJhY3kO"},{"type":"inlineMath","value":"h_c","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">h_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Pb889oZt9F"},{"type":"text","value":" when LAI tends to zero. In other words, the ratio of bottom-to-top of the canopy (","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"rx2cP3EHkk"},{"type":"inlineMath","value":"h_b/h_c","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mi>b</mi></msub><mi mathvariant=\"normal\">/</mi><msub><mi>h</mi><mi>c</mi></msub></mrow><annotation encoding=\"application/x-tex\">h_b/h_c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ZT41c0SW1G"},{"type":"text","value":") tends to 1 when LAI tends to zero.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"jwuwsHts9j"}],"key":"odiBnKfbJo"}],"key":"A0GK0afQXQ"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/vineyard_structural_-59f51fdb831e95cbac9c5249ce0cd27d.png","alt":"Empirical structural functions","key":"HftMrHVp7W","urlSource":"./input/figures/vineyard_structural_functions.png","urlOptimized":"/vineyard_structural_-59f51fdb831e95cbac9c5249ce0cd27d.webp"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"structural-functions","identifier":"structural-functions","html_id":"structural-functions","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"VJktk2OPnh"},{"type":"text","value":"2","key":"DkUgUs6ul2"},{"type":"text","value":":","key":"kqPS7ncSuX"}],"template":"Figure %s:","key":"Q3J2VBOo7d"},{"type":"text","value":"Empirical models relating canopy height , canopy width and the bottom of the canopy with the fused STARFM LAI. Solid dots represent in situ measured values","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"jdwWJZOUQl"}],"key":"IpdtA1V4cM"}],"key":"ZL6MW1z2Dx"}],"label":"structural-functions","identifier":"structural-functions","enumerator":"2","html_id":"structural-functions","key":"vgKSGv81gC"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"These empirical equations are coded in Python as:","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"mSZhFTBHZi"}],"key":"BnaknGz6uj"}],"key":"dTyWt2o1bc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\n\n################################################################################\n# Empirical equations to generate canopy structural parameters from LAI\n################################################################################\ndef lai_2_hc(lai, hc_min):\n    slope = 0.42\n    hc = hc_min + slope * lai\n    return hc\n\n\ndef lai_2_hbratio(lai, hc_min):\n    hb_ratio_mean = 0.4848388065\n    hb_ratio = np.zeros(lai.shape)\n\n    hb_ratio[lai < hc_min] = 1. + ((hb_ratio_mean - 1.) / hc_min) * lai[\n        lai < hc_min]\n    hb_ratio[lai >= hc_min] = hb_ratio_mean\n\n    return hb_ratio\n\n\ndef lai_2_width(lai, wc_min, wc_max):\n    beta = 6.96560056\n    offset = 1.70825736\n\n    width = wc_min + (wc_max - wc_min) / (1.0 + np.exp(-beta * (lai - offset)))\n\n    return width\n\n\ndef lai_2_fcover(lai, fc_min, fc_max):\n    beta = 7.0\n    offset = 1.70\n\n    fcover = fc_min + (fc_max - fc_min) / (1.0 + np.exp(-beta * (lai - offset)))\n\n    return fcover\n\n\ndef lai_2_canopy(lai, hc_min, fc_min, fc_max):\n    hc = lai_2_hc(lai, hc_min)\n    hb_ratio = lai_2_hbratio(lai, hc_min)\n    fcover = lai_2_fcover(lai, fc_min, fc_max)\n\n    return hc, hb_ratio, fcover","key":"vuSARhPICA"},{"type":"output","id":"8iNGdqv70FG4ibQZM3vsl","data":[],"key":"QWFiTDqqK7"}],"key":"ygtXL0nQh7"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And when applied to the vine characteristics of Ripperdam 720-4 we can run this","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fkbd4Nlsps"}],"key":"vxKUVPVyXu"}],"key":"CphL6WGRaM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Structural characterisctos of the site\nhc_min = 1.2\nhc_max = 2.2\nwc_min = 0.5\nwc_max = 2.25\ninterrow = 3.35  # Interrow width (used to compute the fractional cover as w_c / interrow\n\n# Compute the expected minimum and maximum canopy cover based on mininum and maximum canopy width\nfc_min = wc_min / interrow\nfc_max = wc_max / interrow\nh_c, hb_ratio, f_c = lai_2_canopy(ec[\"LAI\"].values,\n                                  hc_min,\n                                  fc_min,\n                                  fc_max)\n\n# Ensure that both canopy height and cover are within the limits\nh_c = np.clip(h_c, hc_min, hc_max)\nf_c = np.clip(f_c, 0, 1)\n\n# canopy width\nw_c = f_c * interrow\n# Canopy width to height ratio\nw_c_ratio = w_c / (h_c - hb_ratio * h_c)","key":"Z5QFVCzzdZ"},{"type":"output","id":"OKz0459CiU7EHehgWRt3e","data":[],"key":"JhcdiQkRiq"}],"key":"VagBbovlN4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, with the structural parameters define we can now compute the zero-plane displacement height and roughness length for momentum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dqDLsYicwb"}],"key":"CW1qcjHDDY"}],"key":"SMaID18mXM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set the site landcover type\nlandcover = TSEB.res.BROADLEAVED_D  # We coded different functional types based on the IGBP nomenclature\n\n# Convert input scalars to numpy arrays\nlai, h_c, w_c, landcover = map(np.asarray, (ec[\"LAI\"].values, h_c, w_c, landcover))\n\n# Initialize fractional cover and horizontal area index\nlambda_ = np.zeros(ec[\"LAI\"].values.shape)\n\n# Needleleaf canopies\nmask = np.logical_or(landcover == TSEB.res.CONIFER_E, landcover == TSEB.res.CONIFER_D)\nlambda_[mask] = (2. / np.pi) * f_c[mask] * w_c[mask]\n\n# Broadleaved canopies\nmask = np.logical_or.reduce((landcover == TSEB.res.BROADLEAVED_E, landcover == TSEB.res.BROADLEAVED_D,\n                             landcover == TSEB.res.FOREST_MIXED, landcover == TSEB.res.SAVANNA_WOODY))\n\nlambda_[mask] = f_c[mask] * w_c[mask]\n\n# Shrublands\nmask = np.logical_or(landcover == TSEB.res.SHRUB_O, landcover == TSEB.res.SHRUB_C)\nlambda_[mask] = f_c[mask] * w_c[mask]\n\n############################################\n# Calculation of the Raupach (1994) formulae\n############################################\n# Convert input scalar to numpy array\nlambda_ = np.asarray(lambda_)\nz_0m_factor = np.zeros(lambda_.shape)\nd_factor = np.asarray(np.zeros(lambda_.shape) + 0.65)\n\n# Calculation of the Raupach (1994) formulae\n# if lambda_ > 0.152:\ni = lambda_ > 0.152\nz_0m_factor[i] = ((0.0537 / (lambda_[i]**0.510))\n                 * (1. - np.exp(-10.9 * lambda_[i]**0.874)) + 0.00368)\n# else:\nz_0m_factor[~i] = 5.86 * np.exp(-10.9 * lambda_[~i]**1.12) * lambda_[~i]**1.33 + 0.000860\n# if lambda_ > 0:\ni = lambda_ > 0\nd_factor[i] = 1. - (1. - np.exp(-np.sqrt(15.0 * lambda_[i]))) / np.sqrt(15.0 * lambda_[i])\n\n##########################################\n# Calculation of correction factors from  Lindroth\nfz = np.asarray(0.3299 * ec[\"LAI\"].values**1.5 + 2.1713)\nfd = np.asarray(1. - 0.3991 * np.exp(-0.1779 * ec[\"LAI\"].values))\n\n# LAI <= 0\nfz[ec[\"LAI\"].values <= 0] = 1.0\nfd[ec[\"LAI\"].values <= 0] = 1.0\n\n# LAI >= 0.8775:\nfz[ec[\"LAI\"].values >= 0.8775] = 1.6771 * np.exp(-0.1717 * ec[\"LAI\"].values[ec[\"LAI\"].values >= 0.8775]) + 1.\nfd[ec[\"LAI\"].values >= 0.8775] = 1. - 0.3991 * np.exp(-0.1779 * ec[\"LAI\"].values[ec[\"LAI\"].values >= 0.8775])\n\n# Application of the correction factors to roughness and displacement\n# height\nz_0m_factor = np.asarray(z_0m_factor * fz)\nd_factor = np.asarray(d_factor * fd)\n\n# For crops and grass we use a fixed ratio of canopy height\nmask = np.logical_or.reduce((landcover == TSEB.res.CROP, landcover == TSEB.res.GRASS,\n                             landcover == TSEB.res.SAVANNA, landcover == TSEB.res.CROP_MOSAIC))\nz_0m_factor[mask] = 1. / 8.\nd_factor[mask] = 0.65\n\n# Calculation of rouhgness length\nz_0m = np.asarray(z_0m_factor * h_c)\n\n# Calculation of zero plane displacement height\nd_0 = np.asarray(d_factor * h_c)\n\n# For barren surfaces (bare soil, water, etc.)\nmask = np.logical_or.reduce((landcover == TSEB.res.WATER, landcover == TSEB.res.URBAN,\n                             landcover == TSEB.res.SNOW, landcover == TSEB.res.BARREN))\nz_0m[mask] = 0.01\nd_0[mask] = 0","key":"B3Kv0tUo4H"},{"type":"output","id":"7E_67ng5mZZTR9lYDDa9F","data":[],"key":"zHnoKBrUkA"}],"key":"Of1XUwOmz8"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"See Also","key":"WuWHqtlELy"}],"key":"a7I1OJ9r2G"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"You can check the code implementation in pyTSEB ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RAb79OQc3j"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/resistances.py#L124","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jd1OIcWjqo"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/resistances.py#L124","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/resistances.py","from":124,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/resistances.py"},"internal":false,"protocol":"github","key":"skbIrT45UW"}],"key":"Bs9PafvJmU"}],"key":"g2iIhPVYOb"}],"key":"wBJ5J1brWm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Sensible heat flux","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"eBcaQl2RYd"}],"label":"sec-h","identifier":"sec-h","html_id":"sec-h","key":"XsqEbvKTdr"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The key in TSEB models is the partition of sensible heat flux into the soil and canopy layers, which depends on the soil and canopy temperatures (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HbddRKefZM"},{"type":"inlineMath","value":"T_S","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"TYSbvyNtAi"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"I2voKNszXh"},{"type":"inlineMath","value":"T_C","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"fkLCZQP2SF"},{"type":"text","value":" respectively, left side of Fig. ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Sf3VeQ3max"},{"type":"link","url":"#tseb","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[],"urlSource":"#tseb","key":"KG4zuI1oNo"},{"type":"text","value":"). Given the difficulty of obtaining the pure component temperatures, even with very high resolution data due to canopy gaps,","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dl8jOh9zpx"},{"type":"cite","url":"https://doi.org/10.1016/0168-1923(95)02265-Y","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Norman et al (1995)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qwOfJHarhN"}],"kind":"narrative","label":"Norman_1995","identifier":"https://doi.org/10.1016/0168-1923(95)02265-Y","enumerator":"1","key":"QiCxwaKID4"},{"type":"text","value":" found a solution to retrieve ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sml81WkMg2"},{"type":"inlineMath","value":"T_S","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Ux4eZoWrbQ"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cOKKfSK4ut"},{"type":"inlineMath","value":"T_C","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"T5Ibhv0R7X"},{"type":"text","value":" using a single observation of the directional radiometric temperature ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cC00IStOOR"},{"type":"inlineMath","value":"T_{rad}\\left(\\theta\\right)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mrow><mi>r</mi><mi>a</mi><mi>d</mi></mrow></msub><mrow><mo fence=\"true\">(</mo><mi>θ</mi><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">T_{rad}\\left(\\theta\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span></span></span></span>","key":"KevkbIVKbn"},{"type":"text","value":" as this is the case for most of the remote sensing systems. Eq. ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"laoSJ76XlE"},{"type":"crossReference","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"(","key":"Bfud3Aa0Ff"},{"type":"text","value":"9","key":"ZxO6IJx853"},{"type":"text","value":")","key":"ZP2zRU7Yl9"}],"identifier":"eq-tseb_trad","label":"eq-TSEB_Trad","kind":"equation","template":"(%s)","enumerator":"9","resolved":true,"html_id":"eq-tseb-trad","key":"KJ4vwwrYkO"},{"type":"text","value":" decomposes the composite ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KtASa9CUSx"},{"type":"inlineMath","value":"T_{rad}\\left(\\theta\\right)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mrow><mi>r</mi><mi>a</mi><mi>d</mi></mrow></msub><mrow><mo fence=\"true\">(</mo><mi>θ</mi><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">T_{rad}\\left(\\theta\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span></span></span></span>","key":"zMPi8SpLzA"},{"type":"text","value":" temperature between its components ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"D1pVzGEdsE"},{"type":"inlineMath","value":"T_S","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"cSo8PyQzzE"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FD80Fav75H"},{"type":"inlineMath","value":"T_C","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"uKE04EWKmi"},{"type":"text","value":", assuming blackbody emission of thermal radiance:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sOZbXFUmRt"}],"key":"CgkI1djzFW"},{"type":"math","value":"\\sigma T_{rad}^4\\left(\\theta\\right)=f_c\\left(\\theta\\right)\\sigma\\,T_{C}^4+\\left[1-f_{c}\\left(\\theta\\right)\\right]\\sigma\\,T_{S}^4","label":"eq-TSEB_Trad","identifier":"eq-tseb_trad","tight":"after","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>σ</mi><msubsup><mi>T</mi><mrow><mi>r</mi><mi>a</mi><mi>d</mi></mrow><mn>4</mn></msubsup><mrow><mo fence=\"true\">(</mo><mi>θ</mi><mo fence=\"true\">)</mo></mrow><mo>=</mo><msub><mi>f</mi><mi>c</mi></msub><mrow><mo fence=\"true\">(</mo><mi>θ</mi><mo fence=\"true\">)</mo></mrow><mi>σ</mi><mtext> </mtext><msubsup><mi>T</mi><mi>C</mi><mn>4</mn></msubsup><mo>+</mo><mrow><mo fence=\"true\">[</mo><mn>1</mn><mo>−</mo><msub><mi>f</mi><mi>c</mi></msub><mrow><mo fence=\"true\">(</mo><mi>θ</mi><mo fence=\"true\">)</mo></mrow><mo fence=\"true\">]</mo></mrow><mi>σ</mi><mtext> </mtext><msubsup><mi>T</mi><mi>S</mi><mn>4</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">\\sigma T_{rad}^4\\left(\\theta\\right)=f_c\\left(\\theta\\right)\\sigma\\,T_{C}^4+\\left[1-f_{c}\\left(\\theta\\right)\\right]\\sigma\\,T_{S}^4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">d</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">[</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">]</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"9","html_id":"eq-tseb-trad","key":"hbJmHBmnIh"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ggUZIyb2KA"},{"type":"inlineMath","value":"f_c\\left(\\phi\\right)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>c</mi></msub><mrow><mo fence=\"true\">(</mo><mi>ϕ</mi><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">f_c\\left(\\phi\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span></span></span></span>","key":"xZZzXYCqrE"},{"type":"text","value":" is the fraction of vegetation observed by the sensor. Since ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"G4DnayD1RW"},{"type":"crossReference","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"(","key":"ggooNzDDY2"},{"type":"text","value":"9","key":"lgctRCdC4j"},{"type":"text","value":")","key":"Qwd9PUXQKA"}],"identifier":"eq-tseb_trad","label":"eq-TSEB_Trad","kind":"equation","template":"(%s)","enumerator":"9","resolved":true,"html_id":"eq-tseb-trad","key":"Y3aaiRpzNJ"},{"type":"text","value":" consists of two unknowns and only one equation, an iterative process to find ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"kGIfUhnGk3"},{"type":"inlineMath","value":"H_S","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">H_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"uz10isadwG"},{"type":"text","value":", ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"dboPwLf2dx"},{"type":"inlineMath","value":"T_S","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Mcb8UuWIZt"},{"type":"text","value":", ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HABOAnmJYU"},{"type":"inlineMath","value":"H_C","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>H</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">H_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"SFF7mvoTjL"},{"type":"text","value":" and ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"xgjyiqOVpZ"},{"type":"inlineMath","value":"T_C","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lbCwpEvwsB"},{"type":"text","value":" is defined based upon an initial guess of potential canopy transpiration, and under the assumption that during daytime hours condensation for the soil/substrate should not occur. The initial canopy latent and sensible heat fluxes are estimated based on the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BpJ8tNg3RA"},{"type":"cite","url":"https://doi.org/10.1175/1520-0493(1972)100%3C0081:OTAOSH%3E2.3.CO;2","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Priestley and Taylor (1972)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"zF3aDpnR6A"}],"kind":"narrative","label":"PRIESTLEY_1972","identifier":"https://doi.org/10.1175/1520-0493(1972)100%3C0081:OTAOSH%3E2.3.CO;2","enumerator":"14","key":"mWMjZxy5Ju"},{"type":"text","value":" formulation for potential transpiration (Eq. ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"JsP7xMxHZZ"},{"type":"crossReference","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"(","key":"n5usSR1VSg"},{"type":"text","value":"10","key":"hAvRmet0Ex"},{"type":"text","value":")","key":"ymRuXWdsTY"}],"identifier":"eq-tseb_pt","label":"eq-TSEB_PT","kind":"equation","template":"(%s)","enumerator":"10","resolved":true,"html_id":"eq-tseb-pt","key":"ufc1JgsbFO"},{"type":"text","value":") and Eq. ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fU6WunFtrL"},{"type":"crossReference","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"(","key":"si5NVrzyNk"},{"type":"text","value":"1","key":"GDWQVNJEZz"},{"type":"text","value":")","key":"Zpq8hJyskJ"}],"identifier":"eq-eb","label":"eq-eb","kind":"equation","template":"(%s)","enumerator":"1","resolved":true,"html_id":"eq-eb","key":"Q9hxOMdiMf"},{"type":"text","value":".","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"o82ixAoI5P"}],"key":"s42Um2elCp"},{"type":"math","value":"\\lambda E_C &= \\alpha_{PT} \\, f_g \\frac{\\Delta}{\\Delta + \\gamma}R_{n,C}\\\\\nH_C &= R_{n,C} - \\lambda E_C","label":"eq-TSEB_PT","identifier":"eq-tseb_pt","tight":"after","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>λ</mi><msub><mi>E</mi><mi>C</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mi>α</mi><mrow><mi>P</mi><mi>T</mi></mrow></msub><mtext> </mtext><msub><mi>f</mi><mi>g</mi></msub><mfrac><mi mathvariant=\"normal\">Δ</mi><mrow><mi mathvariant=\"normal\">Δ</mi><mo>+</mo><mi>γ</mi></mrow></mfrac><msub><mi>R</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>C</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>H</mi><mi>C</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mi>R</mi><mrow><mi>n</mi><mo separator=\"true\">,</mo><mi>C</mi></mrow></msub><mo>−</mo><mi>λ</mi><msub><mi>E</mi><mi>C</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align*}\n\\lambda E_C &amp;= \\alpha_{PT} \\, f_g \\frac{\\Delta}{\\Delta + \\gamma}R_{n,C}\\\\\nH_C &amp;= R_{n,C} - \\lambda E_C\n\\end{align*}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.0408em;vertical-align:-1.7704em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.2704em;\"><span style=\"top:-4.2704em;\"><span class=\"pstrut\" style=\"height:3.3603em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.2499em;\"><span class=\"pstrut\" style=\"height:3.3603em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7704em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.2704em;\"><span style=\"top:-4.2704em;\"><span class=\"pstrut\" style=\"height:3.3603em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">PT</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">Δ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">Δ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.2499em;\"><span class=\"pstrut\" style=\"height:3.3603em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7704em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"10","html_id":"eq-tseb-pt","key":"L37VvOHZyE"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"blc514iG82"},{"type":"inlineMath","value":"\\alpha_{PT}","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>α</mi><mrow><mi>P</mi><mi>T</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\alpha_{PT}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">PT</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"xM63PaGItd"},{"type":"text","value":" is the Priestley-Taylor coefficient, initially set to 1.26, ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"wyLeFR2yP3"},{"type":"inlineMath","value":"f_g","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>g</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"D08Uno511v"},{"type":"text","value":" is the fraction of vegetation that is green and hence capable of transpiring, ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"H9sLD4sX1Y"},{"type":"inlineMath","value":"\\Delta","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span></span></span></span>","key":"KowcxpxJ9w"},{"type":"text","value":" is the slope of the saturation vapour pressure versus temperature, ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"QkZ5A6YE1z"},{"type":"inlineMath","value":"\\gamma","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>γ</mi></mrow><annotation encoding=\"application/x-tex\">\\gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span>","key":"TFBnYqJvhP"},{"type":"text","value":" is the psychrometric constant. ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"znmF0gPxuN"},{"type":"inlineMath","value":"T_{C}","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_{C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"C90oSsftW3"},{"type":"text","value":" is then computed by inverting the equation for turbulent transport of heat between the surface and the reference height above the surface)","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"fz2HguD6n5"}],"key":"cm7IJkhkEP"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"With a first estimate of ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Uf2NZBvRfi"},{"type":"inlineMath","value":"T_{C}","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_{C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ZU3Rv0bieK"},{"type":"text","value":", soil temperature is computed from Eq. ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"H9IREwFSTT"},{"type":"crossReference","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"(","key":"MUW5Rvl3xq"},{"type":"text","value":"9","key":"vpbjkYNQuP"},{"type":"text","value":")","key":"oJsad2UUaw"}],"identifier":"eq-tseb_trad","label":"eq-TSEB_Trad","kind":"equation","template":"(%s)","enumerator":"9","resolved":true,"html_id":"eq-tseb-trad","key":"EAm4vktas1"},{"type":"text","value":" and then soil sensible and latent heat fluxes. At this stage, if soil latent heat flux results to be non-negative, a solution is found, otherwise the Priestley-Taylor coefficient is reduced incrementally , reducing hence the canopy transpiration, in order to avoid negative soil latent heat flux, until a realistic solution is found (no condensation occurring neither in the soil nor in the canopy in daytime).","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"XTuEg5OJWo"}],"key":"apShg1Xzkq"},{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"See Also","key":"Vkm4T5gVz0"}],"key":"XxornIHgWl"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"For more details the reader is addressed to the works of ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"bHn6MpbeUb"},{"type":"cite","url":"https://doi.org/10.1016/0168-1923(95)02265-Y","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Norman et al (1995)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Y1EJ4sO4eb"}],"kind":"narrative","label":"Norman_1995","identifier":"https://doi.org/10.1016/0168-1923(95)02265-Y","enumerator":"1","key":"o4n2IkojuS"},{"type":"text","value":" or ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"JJsbt76uL3"},{"type":"cite","url":"https://doi.org/10.1016/S0168-1923(99)00005-2","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Kustas and Norman (1999)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"GVi69hr0wb"}],"kind":"narrative","label":"Kustas_1999","identifier":"https://doi.org/10.1016/S0168-1923(99)00005-2","enumerator":"9","key":"AvdH5u9TlE"}],"key":"GJIOOQXw2g"}],"class":"dropdown","key":"PuP7R9TW9t"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"The full code of TSEB-PT is displayed below. Note that there are two main steps:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"FCJweO8pT2"}],"key":"o0EfletwUN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":26,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"A first step that prepares all ancillary variables, such as air density, heat capacity of air..., and initializes a priori values of ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Ey33zXhc7Q"},{"type":"inlineMath","value":"T_C","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>C</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Z5mfjuwbLG"},{"type":"text","value":", ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"MWh459n4Ys"},{"type":"inlineMath","value":"T_S","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"AlDBGjqnM4"},{"type":"text","value":", ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Y3Jz7rhejP"},{"type":"inlineMath","value":"Ln","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">Ln</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"MuzNIklwMv"},{"type":"text","value":", and ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"kwPHaZQOjv"},{"type":"inlineMath","value":"G","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>","key":"B8Cr3Fj4Ka"},{"type":"text","value":": Until line 83 in the code below.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"YZ8zcszz05"}],"key":"Dno8AaWhOT"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"A second iterative step that consists on two nested loops:","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"HWAKInjuc9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":28,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"an outer loop that searches for convergence in the friction velocity and Monin-Obukhov lenght and serves to recalculate the aerodynamic resistances: From line 84 to line 234","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"vEPOSgV7Ay"}],"key":"p9TnBGS0Du"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"an inner loop that starts with the potential Priestley-Taylor coefficient and interatively starts being reduced for each case individually until non-negative turbulent fluxes are obtained for both canopy and soil: From line 108 to line 225","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"Txb9gNDQst"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"GmhNceiWmk"}],"key":"p76Vv0kLCN"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"The outer loop regarding the recalculation of atmospheric stability factors tends to converge pretty fast under daytime/unstable conditions, but on the other hand it has difficulties in converging under stable/nighttime conditions. Therefore in pyTSEB it is set a number of maximum iterations for this loop reflectein the ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"GUqorpGeAM"},{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L103C1-L103C11","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"inlineCode","value":"ITERATIONS","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"Y2fsXirXtO"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L103C1-L103C11","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/TSEB.py","from":103,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py"},"internal":false,"protocol":"github","key":"IsHQ55f4fI"},{"type":"text","value":" constant","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"cwtS1gKoqE"}],"key":"ZmXoP6cTRl"}],"class":"dropdown","key":"tRpb2DtdxW"}],"key":"ImdYbePT0i"}],"key":"jZpMtEqh1X"}],"key":"iouMhL3Ekr"}],"key":"MDxJEpWPlC"},{"type":"code","lang":"python","showLineNumbers":true,"value":"def TSEB_PT(Tr_K,\n            vza,\n            T_A_K,\n            u,\n            ea,\n            p,\n            Sn_C,\n            Sn_S,\n            L_dn,\n            LAI,\n            h_C,\n            emis_C,\n            emis_S,\n            z_0M,\n            d_0,\n            z_u,\n            z_T,\n            leaf_width=0.1,\n            z0_soil=0.01,\n            alpha_PT=1.26,\n            x_LAD=1,\n            f_c=1.0,\n            f_g=1.0,\n            w_C=1.0,\n            resistance_form=None,\n            calcG_params=None,\n            const_L=None,\n            kB=KB_1_DEFAULT,\n            massman_profile=None,\n            verbose=True):\n\n    # Convert input float scalars to arrays and parameters size\n    if calcG_params is None:\n        calcG_params = [[1], 0.35]\n    if resistance_form is None:\n        resistance_form = [0, {}]\n    if massman_profile is None:\n        massman_profile = [0, []]\n\n    res_params = resistance_form[1]\n    resistance_form = resistance_form[0]\n    # calcG_params[1] = None\n    # Create the output variables\n    [Ln_S, Ln_C, H, LE, LE_C, H_C, LE_S, H_S, G, R_S, R_x, R_A, delta_Rn,\n     Rn_S, iterations] = [np.zeros(Tr_K.shape, np.float32)+np.NaN for i in range(15)]\n\n    # iteration of the Monin-Obukhov length\n    if const_L is None:\n        # Initially assume stable atmospheric conditions and set variables for\n        L = np.zeros(Tr_K.shape) + np.inf\n        max_iterations = ITERATIONS\n    else:  # We force Monin-Obukhov lenght to the provided array/value\n        L = np.ones(Tr_K.shape) * const_L\n        max_iterations = 1  # No iteration\n    # Calculate the general parameters\n    rho = met.calc_rho(p, ea, T_A_K)  # Air density\n    c_p = met.calc_c_p(p, ea)  # Heat capacity of air\n    z_0H = res.calc_z_0H(z_0M, kB=kB)  # Roughness length for heat transport\n\n    # Calculate LAI dependent parameters for dataset where LAI > 0\n    omega0 = CI.calc_omega0_Kustas(LAI, f_c, x_LAD=x_LAD, isLAIeff=True)\n    F = np.asarray(LAI / f_c, dtype=np.float32)  # Real LAI\n    # Fraction of vegetation observed by the sensor\n    f_theta = calc_F_theta_campbell(vza, F, w_C=w_C, Omega0=omega0, x_LAD=x_LAD)\n    del vza, ea\n    # Initially assume stable atmospheric conditions and set variables for\n    # iteration of the Monin-Obukhov length\n    u_friction = MO.calc_u_star(u, z_u, L, d_0, z_0M)\n    u_friction = np.asarray(np.maximum(U_FRICTION_MIN, u_friction), dtype=np.float32)\n    L_queue = deque([np.array(L, np.float32)], 6)\n    L_converged = np.zeros(Tr_K.shape, bool)\n    L_diff_max = np.inf\n\n    # First assume that canopy temperature equals the minumum of Air or\n    # radiometric T\n    T_C = np.asarray(np.minimum(Tr_K, T_A_K), dtype=np.float32)\n    flag, T_S = calc_T_S(Tr_K, T_C, f_theta)\n    T_AC = T_A_K.copy()\n\n    # Outer loop for estimating stability.\n    # Stops when difference in consecutives L is below a given threshold\n    start_time = time.time()\n    loop_time = time.time()\n    for n_iterations in range(max_iterations):\n        i = flag != F_INVALID\n        if np.all(L_converged[i]):\n            if verbose:\n                if L_converged[i].size == 0:\n                    print(\"Finished iterations with no valid solution\")\n                else:\n                    print(f\"Finished interations with a max. L diff: {L_diff_max}\")\n            break\n        current_time = time.time()\n        loop_duration = current_time - loop_time\n        loop_time = current_time\n        total_duration = loop_time - start_time\n        if verbose:\n            print(\"Iteration: %d, non-converged pixels: %d, max L diff: %f, total time: %f, loop time: %f\" %\n                  (n_iterations, np.sum(~L_converged[i]), L_diff_max, total_duration, loop_duration))\n        iterations[np.logical_and(~L_converged, flag != F_INVALID)] = n_iterations\n\n        # Inner loop to iterativelly reduce alpha_PT in case latent heat flux\n        # from the soil is negative. The initial assumption is of potential\n        # canopy transpiration.\n        flag[np.logical_and(~L_converged, flag != F_INVALID)] = F_ALL_FLUXES\n        LE_S[np.logical_and(~L_converged, flag != F_INVALID)] = -1\n        alpha_PT_rec = np.asarray(alpha_PT + 0.1, dtype=np.float32)\n        while np.any(LE_S[i] < 0):\n            i = np.logical_and.reduce((LE_S < 0, ~L_converged, flag != F_INVALID))\n\n            alpha_PT_rec[i] -= 0.1\n\n            # There cannot be negative transpiration from the vegetation\n            alpha_PT_rec[alpha_PT_rec <= 0.0] = 0.0\n            flag[np.logical_and(i, alpha_PT_rec == 0.0)] = F_ZERO_LE\n\n            flag[np.logical_and.reduce((i, alpha_PT_rec < alpha_PT, alpha_PT_rec > 0.0))] =\\\n                F_ZERO_LE_S\n\n            # Calculate aerodynamic resistances\n            R_A[i], R_x[i], R_S[i] = calc_resistances(\n                      resistance_form,\n                      {\"R_A\": {\"z_T\": z_T[i], \"u_friction\": u_friction[i], \"L\": L[i],\n                               \"d_0\": d_0[i], \"z_0H\": z_0H[i]},\n                       \"R_x\": {\"u_friction\": u_friction[i], \"h_C\": h_C[i],\n                               \"d_0\": d_0[i],\n                               \"z_0M\": z_0M[i], \"L\": L[i], \"F\": F[i], \"LAI\": LAI[i],\n                               \"leaf_width\": leaf_width[i],\n                               \"z0_soil\": z0_soil[i],\n                               \"massman_profile\": massman_profile,\n                               \"res_params\": {k: res_params[k][i] for k in res_params.keys()}},\n                       \"R_S\": {\"u_friction\": u_friction[i], \"h_C\": h_C[i],\n                               \"d_0\": d_0[i],\n                               \"z_0M\": z_0M[i], \"L\": L[i], \"F\": F[i], \"omega0\": omega0[i],\n                               \"LAI\": LAI[i], \"leaf_width\": leaf_width[i],\n                               \"z0_soil\": z0_soil[i], \"z_u\": z_u[i],\n                               \"deltaT\": T_S[i] - T_AC[i], 'u': u[i], 'rho': rho[i],\n                               \"c_p\": c_p[i], \"f_cover\": f_c[i], \"w_C\": w_C[i],\n                               \"massman_profile\": massman_profile,\n                               \"res_params\": {k: res_params[k][i] for k in res_params.keys()}}\n                       }\n            )\n\n            # Calculate net longwave radiation with current values of T_C and T_S\n            Ln_C[i], Ln_S[i] = rad.calc_L_n_Campbell(\n                T_C[i], T_S[i], L_dn[i], LAI[i], emis_C[i], emis_S[i], x_LAD=x_LAD[i])\n            delta_Rn[i] = Sn_C[i] + Ln_C[i]\n            Rn_S[i] = Sn_S[i] + Ln_S[i]\n\n            # Calculate the canopy and soil temperatures using the Priestley\n            # Taylor appoach\n            H_C[i] = calc_H_C_PT(\n                delta_Rn[i],\n                f_g[i],\n                T_A_K[i],\n                p[i],\n                c_p[i],\n                alpha_PT_rec[i])\n            T_C[i] = calc_T_C_series(Tr_K[i], T_A_K[i], R_A[i], R_x[i], R_S[i],\n                                     f_theta[i], H_C[i], rho[i], c_p[i])\n\n            # Calculate soil temperature\n            flag_t = np.zeros(flag.shape) + F_ALL_FLUXES\n            flag_t[i], T_S[i] = calc_T_S(Tr_K[i], T_C[i], f_theta[i])\n            flag[flag_t == F_INVALID] = F_INVALID\n            LE_S[flag_t == F_INVALID] = 0\n\n            # Recalculate soil resistance using new soil temperature\n            _, _, R_S[i] = calc_resistances(\n                    resistance_form,\n                    {\"R_S\": {\"u_friction\": u_friction[i], \"h_C\": h_C[i], \"d_0\": d_0[i],\n                             \"z_0M\": z_0M[i], \"L\": L[i], \"F\": F[i], \"omega0\": omega0[i],\n                             \"LAI\": LAI[i], \"leaf_width\": leaf_width[i],\n                             \"z0_soil\": z0_soil[i],  \"z_u\": z_u[i],\n                             \"deltaT\": T_S[i] - T_AC[i], \"u\": u[i], \"rho\": rho[i],\n                             \"c_p\": c_p[i], \"f_cover\": f_c[i], \"w_C\": w_C[i],\n                             \"massman_profile\": massman_profile,\n                             \"res_params\": {k: res_params[k][i] for k in res_params.keys()}}\n                     }\n            )\n\n            i = np.logical_and.reduce((LE_S < 0, ~L_converged, flag != F_INVALID))\n\n            # Get air temperature at canopy interface\n            T_AC[i] = ((T_A_K[i] / R_A[i] + T_S[i] / R_S[i] + T_C[i] / R_x[i])\n                       / (1.0 / R_A[i] + 1.0 / R_S[i] + 1.0 / R_x[i]))\n\n            # Calculate soil fluxes\n            H_S[i] = rho[i] * c_p[i] * (T_S[i] - T_AC[i]) / R_S[i]\n\n            # Compute Soil Heat Flux Ratio\n            G[i] = calc_G([calcG_params[0], calcG_array], Rn_S, i)\n\n            # Estimate latent heat fluxes as residual of energy balance at the\n            # soil and the canopy\n            LE_S[i] = Rn_S[i] - G[i] - H_S[i]\n            LE_C[i] = delta_Rn[i] - H_C[i]\n\n            # Special case if there is no transpiration from vegetation.\n            # In that case, there should also be no evaporation from the soil\n            # and the energy at the soil should be conserved.\n            # See end of appendix A1 in Guzinski et al. (2015).\n            noT = np.logical_and(i, LE_C == 0)\n            H_S[noT] = np.minimum(H_S[noT], Rn_S[noT] - G[noT])\n            G[noT] = np.maximum(G[noT], Rn_S[noT] - H_S[noT])\n            LE_S[noT] = 0\n\n            # Calculate total fluxes\n            H[i] = np.asarray(H_C[i] + H_S[i], dtype=np.float32)\n            LE[i] = np.asarray(LE_C[i] + LE_S[i], dtype=np.float32)\n            # Now L can be recalculated and the difference between iterations\n            # derived\n            if const_L is None:\n                L[i] = MO.calc_L(\n                    u_friction[i],\n                    T_A_K[i],\n                    rho[i],\n                    c_p[i],\n                    H[i],\n                    LE[i])\n                # Calculate again the friction velocity with the new stability\n                # correctios\n                u_friction[i] = MO.calc_u_star(\n                    u[i], z_u[i], L[i], d_0[i], z_0M[i])\n                u_friction[i] = np.asarray(np.maximum(U_FRICTION_MIN, u_friction[i]), dtype=np.float32)\n\n        if const_L is None:\n            # We check convergence against the value of L from previous iteration but as well\n            # against values from 2 or 3 iterations back. This is to catch situations (not\n            # infrequent) where L oscillates between 2 or 3 steady state values.\n            i, L_queue, L_converged, L_diff_max = monin_obukhov_convergence(L,\n                                                                            L_queue,\n                                                                            L_converged,\n                                                                            flag)\n\n    (flag,\n     T_S,\n     T_C,\n     T_AC,\n     L_nS,\n     L_nC,\n     LE_C,\n     H_C,\n     LE_S,\n     H_S,\n     G,\n     R_S,\n     R_x,\n     R_A,\n     u_friction,\n     L,\n     n_iterations) = map(np.asarray,\n                         (flag,\n                          T_S,\n                          T_C,\n                          T_AC,\n                          Ln_S,\n                          Ln_C,\n                          LE_C,\n                          H_C,\n                          LE_S,\n                          H_S,\n                          G,\n                          R_S,\n                          R_x,\n                          R_A,\n                          u_friction,\n                          L,\n                          iterations))\n\n    return (flag, T_S, T_C, T_AC, L_nS, L_nC, LE_C, H_C, LE_S, H_S, G, R_S, R_x, R_A, u_friction,\n            L, n_iterations)","key":"gvRPn0fPXL"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"IQLN7YRyxx"}],"key":"oVmHUGbG2g"},{"type":"paragraph","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"text","value":"Also look that the net longwave radiation is iteratively recalculated everytime in line 145, and the soil heat flux in line 192, everytime that new soil and canopy temperature are recalculated within the inner loop","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"Uxiu5i89kd"}],"key":"qXlxYPsvrO"}],"class":"dropdown","key":"EKD7A8kFEf"}],"key":"s5CPiwkpJ9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Additional (optional parameters) can be set up in TSEB-PT, which are mostly related to the calulation of the different aerodynamic resistances (see lines 18, 19, and 25)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nfQmFfz4F4"}],"key":"RL9tsIoXPT"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We can specify these values since we have some knowledge of the vineyard characteristics:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qViBPv0SKM"}],"key":"ai21jLzU4G"}],"key":"QYAdUIrRwU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Initial Priestley-Taylor coefficient\nalpha_PT_0 = 1.26\n\n# Grapevine leaf width\nleaf_width = 0.10\n\n# Roughness for bare soil\nz0_soil = 0.15\n\n# Kustas and Norman boundary layer resistance parameters\nroil_resistance_c_param = 0.0038\nroil_resistance_b_param = 0.012\nroil_resistance_cprime_param = 90.\n\n# Thermal spectra\ne_v = 0.99  # Leaf emissivity\ne_s = 0.94  # Soil emissivity","key":"S23Jw75gLC"},{"type":"output","id":"DrZhDmKytvSCHtn8ayhuM","data":[],"key":"PcDk9ZnrD9"}],"key":"pnggFibVpF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"run TSEB-PT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WAXC1O88n8"}],"identifier":"run-tseb-pt","label":"run TSEB-PT","html_id":"run-tseb-pt","implicit":true,"key":"hFDUm867Qc"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Now we are almost ready to run TSEB-PT, but before we need to retrieve the most important input variable in the model, the radiometric surface temperature. We will derive a radiometric temperture at hourly timesteps using the radiance recorded by the pyrgeometer:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"a0lDp8cVNA"}],"key":"f2Aup8gm9e"}],"key":"CdmeI7aGzZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Surface emissivity\ne_surf = f_c * e_v + (1. - f_c) * e_s\n\n# LST from longwave radiometers\nlst = ((ec['LW_OUT'].values - (1. - e_surf) * ec['LW_IN'].values) / (\n        TSEB.rad.SB * e_surf)) ** 0.25\n\n# And it is assuming that the radiometer is looking at nadir\nvza = np.zeros_like(lst)","key":"ifqexnoLor"},{"type":"output","id":"8KppZ3Gopqfk7D-cFGUjg","data":[],"key":"RpFXTbOW7f"}],"key":"MVNssUPd95"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"...and we also need to especify the height of measurements of both the wind speed (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"POdjJel5ve"},{"type":"inlineMath","value":"z_u","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mi>u</mi></msub></mrow><annotation encoding=\"application/x-tex\">z_u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"sqN8lgWmAE"},{"type":"text","value":") and air temperature (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C0w1NbrxVt"},{"type":"inlineMath","value":"z_t","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">z_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"NzKnLHu0zO"},{"type":"text","value":"), since these to parameters are key to correctly estimate the aerodynamic roughness. These values can be obtained from the site characteristics in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VojU0rtAZs"},{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Site Description","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jjYcAbrtN6"}],"identifier":"site-description","label":"site-description","kind":"heading","template":"{name}","resolved":true,"html_id":"site-description","remote":true,"url":"/seb-introduction","dataUrl":"/seb-introduction.json","key":"gWjPafCVPB"}],"key":"IbHaYgvkdh"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"NbBcXHethJ"}],"key":"GFfUQM6SSl"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"If you recall from the Eq. 3 of the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vR1757nce8"},{"type":"link","url":"/turbulence-and-sensible-heat-flux","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"102​-Turbulence​_and​_sensible​_heat​_flux","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"lgleoMnE5t"}],"urlSource":"./102-Turbulence_and_sensible_heat_flux.ipynb","dataUrl":"/turbulence-and-sensible-heat-flux.json","internal":true,"protocol":"file","key":"CeMd3N8ZID"},{"type":"text","value":" notebook,","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"FGLPWrAYGH"},{"type":"inlineMath","value":"z_u","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mi>u</mi></msub></mrow><annotation encoding=\"application/x-tex\">z_u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"QUj0nidZnS"},{"type":"text","value":" and  ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wQIPja4gNF"},{"type":"inlineMath","value":"z_t","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">z_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"b8NVUi1Fu2"},{"type":"text","value":" are within a logarithmic function and thus these values should never be lower than the canopy height, with the risk otherwise to generate arithmetic errors and produce no valid data. In case of tall canopies combined with data from agrometeorological stations (usually with sensors at 2m) it is recommended to drive these values to be above the canopy.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"YQ6gnKwTKE"}],"key":"kMLvdPlJhJ"}],"key":"fUT40bSKWZ"}],"key":"CSBZman5j7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Measurement height of wind speed\nz_u = 4  # Ripperdam 720-4\n\n# Measurement height of air temperature\nz_t = 4  # Ripperdam 720-4","key":"SuyUJbVE9C"},{"type":"output","id":"XVl3RChki0JuLTYaONOJ5","data":[],"key":"ruBJIPLT5A"}],"key":"xW6QsNOlKz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we are ready to run TSEB-PT!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Qx3CP27TZM"}],"key":"S0GQ0bEGAH"}],"key":"xhneOOBXKi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"resistance_flag = [0, {\"KN_c\": np.full_like(lst, roil_resistance_c_param),\n                       \"KN_b\": np.full_like(lst, roil_resistance_b_param),\n                       \"KN_C_dash\": np.full_like(lst, roil_resistance_cprime_param)}]\n\n# Run TSEB-PT\n[flag_pt, ts_pt, tc_pt, t_ac_pt, ln_s_pt, ln_c_pt, le_c_pt, h_c_pt, le_s_pt, h_s_pt, g_pt,\n r_s_pt, r_x_pt, r_a_pt, u_friction_pt, lmo_pt, n_iterations_pt] = TSEB.TSEB_PT(                                                     \n     lst,\n     vza,\n     ec[\"TA\"].values,\n     ec[\"WS\"].values,\n     ec[\"EA\"].values,\n     ec[\"PA\"].values,\n     sn_c,\n     sn_s,\n     ec[\"LW_IN\"].values,\n     ec[\"LAI\"].values,\n     h_c,\n     e_v,\n     e_s,\n     z_0m,\n     d_0,\n     z_u,\n     z_t,\n     x_LAD=np.ones_like(lst),\n     f_c=f_c,\n     f_g=np.ones_like(lst),\n     w_C=w_c_ratio,\n     leaf_width=leaf_width,\n     z0_soil=z0_soil,\n     alpha_PT=alpha_PT_0,\n     resistance_form=resistance_flag,\n     calcG_params=[[1], 0.35])\n\n# ... and we compute the bulk fluxes\nle_pt = le_c_pt + le_s_pt\nh_pt = h_c_pt + h_s_pt\nnetrad_pt = sn_c + sn_s + ln_c_pt + ln_s_pt","key":"L0cOtYOB9Q"},{"type":"output","id":"RlVQyCMjdBYySaJPLjzhE","data":[],"key":"tNEtUK3n9S"}],"key":"zBGRA48ftk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":":class:dropdown\nThe codes for the different versions of TSEB are stored in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wqDxYK7G3H"},{"type":"inlineCode","value":"TSEB.py","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wqYm8yXWRT"},{"type":"text","value":" module of the pyTSEB GitHub repository:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eph6q7A3up"}],"key":"TepdqPY4ew"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L499","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"TSEB-PT","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vRGiK6QSel"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L499","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/TSEB.py","from":499,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py"},"internal":false,"protocol":"github","key":"RnY9wlt8b0"}],"key":"AMSHbUzusT"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L1980","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"DTD","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"IM9VKt6Cse"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L1980","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/TSEB.py","from":1980,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py"},"internal":false,"protocol":"github","key":"Hp76BI6B4H"}],"key":"Fm2ntpOdgW"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L144","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"TSEB-2T","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HYfy0bPmuC"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L144","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/TSEB.py","from":144,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py"},"internal":false,"protocol":"github","key":"zz9ZLmiDSg"}],"key":"dQyi5539RN"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L1484","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"TSEB-PM","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"h3u70rbB9V"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L1484","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/TSEB.py","from":1484,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py"},"internal":false,"protocol":"github","key":"EdPxukb68h"}],"key":"C2TBkCsAHP"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L946C5-L946C12","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"TSEB-SW","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"riNYXEmYF6"}],"urlSource":"https://github.com/hectornieto/pyTSEB/blob/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py#L946C5-L946C12","data":{"kind":"file","org":"hectornieto","repo":"pyTSEB","reference":"382e4fc01e965143ebafdaefe5be9b45c737455a","file":"pyTSEB/TSEB.py","from":946,"raw":"https://raw.githubusercontent.com/hectornieto/pyTSEB/382e4fc01e965143ebafdaefe5be9b45c737455a/pyTSEB/TSEB.py"},"internal":false,"protocol":"github","key":"HNyiIGuHmE"}],"key":"ZuggMRgZ0U"}],"key":"OQlKUee1iJ"}],"key":"mF2A02wvrF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To finalize we compare the different retrievals","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pUXEk1OEfo"}],"identifier":"to-finalize-we-compare-the-different-retrievals","label":"To finalize we compare the different retrievals","html_id":"to-finalize-we-compare-the-different-retrievals","implicit":true,"key":"OBffbPtNHS"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Select which method of EB correction you want to apply during the validation:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"xzwQxhDIXV"}],"key":"xbaQxccS5x"}],"key":"VwbJCQlrXM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"w_ebc = widgets.Dropdown(\n    options=[('No EB correction', (\"LE\", \"H\")), \n             ('Residual to LE', (\"LE_RES\", \"H\")), \n             ('Residual to H', (\"LE_RES\", \"H\")), \n             ('Bowen Ratio', (\"LE_BR\", \"H_BR\")),\n             ('Ensemble correction', (\"LE_ENS\", \"H_ENS\"))],\n    value=(\"LE_ENS\", \"H_ENS\"),\n    description='EBC method:',\n)\ndisplay(w_ebc)","key":"kMYnTSsiXX"},{"type":"output","id":"meAYhmSFGDMmI6T-mqV_D","data":[],"key":"bS4CoRmFaf"}],"key":"AbJE2IzU0q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from model_evaluation import double_collocation as dc\nfrom tabulate import tabulate\nLE_OBS, H_OBS = w_ebc.value\nprint(f\"Using {LE_OBS} and {H_OBS} fields for validating respectively  LE and H\")\n\nle_marker = {\"color\": \"blue\", \"size\": 3}\nh_marker = {\"color\": \"red\", \"size\": 3}\ng_marker = {\"color\": \"green\", \"size\": 3}\nrn_marker = {\"color\": \"black\", \"size\": 3}\n\nfig = go.Figure()\n\nvalid_pt = np.logical_and(flag_pt < 5, daytime)\n\n\nfig.add_trace(go.Scattergl(x=netrad_pt[valid_pt], y=ec.loc[valid_pt, \"NETRAD\"], \n                         name=\"Rn TSEB-PT\", mode=\"markers\", marker=rn_marker),)\n\n\nfig.add_trace(go.Scattergl(x=g_pt[valid_pt], y=ec.loc[valid_pt, \"G\"], \n                         name=\"G TSEB-PT\", mode=\"markers\", marker=g_marker))\n\nfig.add_trace(go.Scattergl(x=le_pt[valid_pt], y=ec.loc[valid_pt, LE_OBS], \n                         name=\"LE TSEB-PT\", mode=\"markers\", marker=le_marker))\n\n\nfig.add_trace(go.Scattergl(x=h_pt[valid_pt], y=ec.loc[valid_pt, H_OBS], \n                         name=\"H TSEB-PT\", mode=\"markers\", marker=h_marker))\n\nfig.add_trace(go.Scatter(x=[-200, 800], y=[-200, 800], mode=\"lines\", name=\"1:1 line\", line={\"color\": \"black\", \"dash\": \"dash\"}))\n\nfig.update_layout(title_text=f\"Observed vs. Estimated fluxes at {site}\",\n                  yaxis_range=[-200, 800], xaxis_range=[-200, 800], \n                  xaxis_title=\"Estimated (W m-2)\", yaxis_title=\"Observed (W m-2)\")\n","key":"XtjBhCvP6K"},{"type":"output","id":"lAaIXoLpLgeT7Y3oNVHiO","data":[],"key":"Gsrm17w8ZT"}],"key":"CX3kK5lYG6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evaluate the errors in H and LE","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lsWqai4Oqo"}],"identifier":"evaluate-the-errors-in-h-and-le","label":"Evaluate the errors in H and LE","html_id":"evaluate-the-errors-in-h-and-le","implicit":true,"key":"p14FOzS8YN"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In this last step you can evaluate the error metric for the run we just made","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"JTUQpR6j1g"}],"key":"geU8E6IYuF"}],"key":"pUlV6uqhpq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"h_pt_bias, h_pt_mae, h_pt_rmse = dc.error_metrics(ec.loc[valid_pt, H_OBS].values, h_pt[valid_pt])\nle_pt_bias, le_pt_mae, le_pt_rmse = dc.error_metrics(ec.loc[valid_pt, LE_OBS].values,le_pt[valid_pt])\n\nh_pt_cor, h_pt_p_value, h_pt_slope, h_pt_intercept, h_pt_d = dc.agreement_metrics(ec.loc[valid_pt, H_OBS].values, \n                                                                                  h_pt[valid_pt])\nle_pt_cor, le_pt_p_value, le_pt_slope, le_pt_intercept, le_pt_d = dc.agreement_metrics(ec.loc[valid_pt, LE_OBS].values, \n                                                                                       le_pt[valid_pt])\n\ntable_h = [[\"bias\", h_pt_bias, le_pt_bias],\n         [\"RMSE\", h_pt_rmse, le_pt_rmse],\n         [\"MAE\", h_pt_mae, le_pt_mae],\n         [\"Pearson\", h_pt_cor, le_pt_cor],\n         [\"Willmot's d\", h_pt_d, le_pt_d]]\nprint(\"Error metrics for TSEB-PT\")\nprint(tabulate(table_h, headers=[\"Metric\", \"H\", \"LE\"]))\n\n","key":"eM3rn6MJEY"},{"type":"output","id":"4PUVL0pZNNtKYUn5ftae-","data":[],"key":"iOBmxsI4Vy"}],"key":"X1eGt293YI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Save the results to an ASCII table","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AHiBXU1duz"}],"identifier":"save-the-results-to-an-ascii-table","label":"Save the results to an ASCII table","html_id":"save-the-results-to-an-ascii-table","implicit":true,"key":"wsKOxGS95u"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We use again pandas as tool to easily save our outputs to a csv table","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"HdVhK10wc8"}],"key":"OjKKVKuHNi"}],"key":"ppidMMzlPr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Define the output filename\nout_dir = Path().absolute() / \"output\"\noutfile = out_dir / f\"FLX_US-{site}_FLUXNET2015_TSEB-PT_HR.csv\"\n\n# Create the output folder in case it does not exist\nif not out_dir.exists():\n    out_dir.mkdir(parents=True)\n\n# Convert the outputs to a Python dictionary\noutdict = {\"TIMESTAMP\": ec[\"TIMESTAMP\"].dt.strftime(\"%Y%m%d%H%M\"),\n           \"FLAG_TSEBPT\": flag_pt, \"LE_TSEBPT\": le_pt, \"H_TSEBPT\": h_pt, \"NETRAD_TSEBPT\": netrad_pt, \"G_TSEBPT\": g_pt, \n           \"T_S_TSEBPT\": ts_pt, \"T_C_TSEBPT\": tc_pt, \"T_AC_TSEBPT\": t_ac_pt, \"LN_S_TSEBPT\": ln_s_pt, \"LN_C_TSEBPT\": ln_c_pt, \n           \"LE_C_TSEBPT\": le_c_pt, \"H_C_TSEBPT\": h_c_pt, \"LE_S_TSEBPT\": le_s_pt, \"H_S_TSEBPT\": h_s_pt, \"R_S_TSEBPT\": r_s_pt, \n           \"R_X_TSEBPT\": r_x_pt, \"R_A_TSEBPT\": r_a_pt, \"USTAR_TSEBPT\": u_friction_pt, \"L_MO_TSEBPT\":lmo_pt, \n           \"ITERATIONS_TSEBPT\": n_iterations_pt}\n\n# Crete the output dataframe and save it to csv\npd.DataFrame(outdict).to_csv(outfile, sep=\";\", na_rep=-9999, index=False)\nprint(f\"Saved to {outfile}\")","key":"B8csCaEgte"},{"type":"output","id":"3Uya1CVziwvlZ0Cegweav","data":[],"key":"O0nf6hQcZC"}],"key":"yjxapNHYSf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Conclusions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KJRt6Pe609"}],"identifier":"conclusions","label":"Conclusions","html_id":"conclusions","implicit":true,"key":"yxPYDq8u2r"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this notebook we learn the basics of the low level code of pyTSEB to run TSEB-PT using as input an ASCII tabulated table","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rNorVLMvjo"}],"key":"R8j8XLWAw6"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"A very similar approach would be done for runnint TSEB-PT with an image, instead of using pandas to read a table we could use GDAL or rasterio to read the image(s) into a numpy array and parse it directly to the low level code of TSEB.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"X62WtexsuO"}],"key":"VSTRGlmrDv"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"[...]","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"s44pIwFR2v"}],"key":"xIrTA8K7vs"}],"key":"QBSKwiHbeu"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"kRCePsAYaV"}],"key":"WJRo1U5xVB"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Please feel free comment any thoughts. This is work in progress!!!","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"VmBKDxLHki"}],"key":"cePBZWbLb0"}],"key":"McMZ8nApxP"}],"key":"pveRz1OnoT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\n","key":"K3uKL9VHD7"},{"type":"output","id":"M9_2-H1hOJbSlNZh2Wpya","data":[],"key":"OPQHLmWMDB"}],"key":"ytZSy1tVnM"}],"key":"Cin5Iht8tP"},"references":{"cite":{"order":["Norman_1995","Nieto_2022","Alfieri_2018","Gao_2012","Kang_2022","Campbell_1998","Campbell_1990","Weiss_1985","Kustas_1999","Santanello_2003","Raupach_1994","Parry_2019","Nieto_2018","PRIESTLEY_1972"],"data":{"Norman_1995":{"label":"Norman_1995","enumerator":"1","doi":"10.1016/0168-1923(95)02265-y","html":"Norman, J. M., Kustas, W. P., & Humes, K. S. (1995). Source approach for estimating soil and vegetation energy fluxes in observations of directional radiometric surface temperature. <i>Agricultural and Forest Meteorology</i>, <i>77</i>(3–4), 263–293. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1016/0168-1923(95)02265-y\">10.1016/0168-1923(95)02265-y</a>","url":"https://doi.org/10.1016/0168-1923(95)02265-y"},"Nieto_2022":{"label":"Nieto_2022","enumerator":"2","doi":"10.1007/s00271-022-00790-2","html":"Nieto, H., Alsina, M. M., Kustas, W. P., García-Tejera, O., Chen, F., Bambach, N., Gao, F., Alfieri, J. G., Hipps, L. E., Prueger, J. H., McKee, L. G., Zahn, E., Bou-Zeid, E., McElrone, A. J., Castro, S. J., & Dokoozlian, N. (2022). Evaluating different metrics from the thermal-based two-source energy balance model for monitoring grapevine water stress. <i>Irrigation Science</i>, <i>40</i>(4–5), 697–713. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/s00271-022-00790-2\">10.1007/s00271-022-00790-2</a>","url":"https://doi.org/10.1007/s00271-022-00790-2"},"Alfieri_2018":{"label":"Alfieri_2018","enumerator":"3","doi":"10.1007/s00271-018-0610-z","html":"Alfieri, J. G., Kustas, W. P., Nieto, H., Prueger, J. H., Hipps, L. E., McKee, L. G., Gao, F., & Los, S. (2018). Influence of wind direction on the surface roughness of vineyards. <i>Irrigation Science</i>, <i>37</i>(3), 359–373. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/s00271-018-0610-z\">10.1007/s00271-018-0610-z</a>","url":"https://doi.org/10.1007/s00271-018-0610-z"},"Gao_2012":{"label":"Gao_2012","enumerator":"4","doi":"10.3390/rs4113287","html":"Gao, F., Kustas, W. P., & Anderson, M. C. (2012). A Data Mining Approach for Sharpening Thermal Satellite Imagery over Land. <i>Remote Sensing</i>, <i>4</i>(11), 3287–3319. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.3390/rs4113287\">10.3390/rs4113287</a>","url":"https://doi.org/10.3390/rs4113287"},"Kang_2022":{"label":"Kang_2022","enumerator":"5","doi":"10.1007/s00271-022-00798-8","html":"Kang, Y., Gao, F., Anderson, M., Kustas, W., Nieto, H., Knipper, K., Yang, Y., White, W., Alfieri, J., Torres-Rua, A., Alsina, M. M., & Karnieli, A. (2022). Evaluation of satellite Leaf Area Index in California vineyards for improving water use estimation. <i>Irrigation Science</i>, <i>40</i>(4–5), 531–551. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/s00271-022-00798-8\">10.1007/s00271-022-00798-8</a>","url":"https://doi.org/10.1007/s00271-022-00798-8"},"Campbell_1998":{"label":"Campbell_1998","enumerator":"6","doi":"10.1007/978-1-4612-1626-1_15","html":"Campbell, G. S., & Norman, J. M. (1998). The Light Environment of Plant Canopies. In <i>An Introduction to Environmental Biophysics</i> (pp. 247–278). Springer New York. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/978-1-4612-1626-1_15\">10.1007/978-1-4612-1626-1_15</a>","url":"https://doi.org/10.1007/978-1-4612-1626-1_15"},"Campbell_1990":{"label":"Campbell_1990","enumerator":"7","doi":"10.1016/0168-1923(90)90030-a","html":"Campbell, G. S. (1990). Derivation of an angle density function for canopies with ellipsoidal leaf angle distributions. <i>Agricultural and Forest Meteorology</i>, <i>49</i>(3), 173–176. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1016/0168-1923(90)90030-a\">10.1016/0168-1923(90)90030-a</a>","url":"https://doi.org/10.1016/0168-1923(90)90030-a"},"Weiss_1985":{"label":"Weiss_1985","enumerator":"8","doi":"10.1016/0168-1923(85)90020-6","html":"Weiss, A., & Norman, J. M. (1985). Partitioning solar radiation into direct and diffuse, visible and near-infrared components. <i>Agricultural and Forest Meteorology</i>, <i>34</i>(2–3), 205–213. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1016/0168-1923(85)90020-6\">10.1016/0168-1923(85)90020-6</a>","url":"https://doi.org/10.1016/0168-1923(85)90020-6"},"Kustas_1999":{"label":"Kustas_1999","enumerator":"9","doi":"10.1016/s0168-1923(99)00005-2","html":"Kustas, W. P., & Norman, J. M. (1999). Evaluation of soil and vegetation heat flux predictions using a simple two-source model with radiometric temperatures for partial canopy cover. <i>Agricultural and Forest Meteorology</i>, <i>94</i>(1), 13–29. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1016/s0168-1923(99)00005-2\">10.1016/s0168-1923(99)00005-2</a>","url":"https://doi.org/10.1016/s0168-1923(99)00005-2"},"Santanello_2003":{"label":"Santanello_2003","enumerator":"10","doi":"10.1175/1520-0450(2003)042<0851:dcishf>2.0.co;2","html":"Santanello, J. A., & Friedl, M. A. (2003). Diurnal Covariation in Soil Heat Flux and Net Radiation. <i>Journal of Applied Meteorology</i>, <i>42</i>(6), 851–862. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1175/1520-0450(2003)042&lt\">https://doi.org/10.1175/1520-0450(2003)042&lt</a>;0851:dcishf&gt;2.0.co;2","url":"https://doi.org/10.1175/1520-0450(2003)042&lt"},"Raupach_1994":{"label":"Raupach_1994","enumerator":"11","doi":"10.1007/bf00709229","html":"Raupach, M. R. (1994). Simplified expressions for vegetation roughness length and zero-plane displacement as functions of canopy height and area index. <i>Boundary-Layer Meteorology</i>, <i>71</i>(1–2), 211–216. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/bf00709229\">10.1007/bf00709229</a>","url":"https://doi.org/10.1007/bf00709229"},"Parry_2019":{"label":"Parry_2019","enumerator":"12","doi":"10.1007/s00271-019-00621-x","html":"Parry, C. K., Nieto, H., Guillevic, P., Agam, N., Kustas, W. P., Alfieri, J., McKee, L., & McElrone, A. J. (2019). An intercomparison of radiation partitioning models in vineyard canopies. <i>Irrigation Science</i>, <i>37</i>(3), 239–252. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/s00271-019-00621-x\">10.1007/s00271-019-00621-x</a>","url":"https://doi.org/10.1007/s00271-019-00621-x"},"Nieto_2018":{"label":"Nieto_2018","enumerator":"13","doi":"10.1007/s00271-018-0611-y","html":"Nieto, H., Kustas, W. P., Alfieri, J. G., Gao, F., Hipps, L. E., Los, S., Prueger, J. H., McKee, L. G., & Anderson, M. C. (2018). Impact of different within-canopy wind attenuation formulations on modelling sensible heat flux using TSEB. <i>Irrigation Science</i>, <i>37</i>(3), 315–331. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/s00271-018-0611-y\">10.1007/s00271-018-0611-y</a>","url":"https://doi.org/10.1007/s00271-018-0611-y"},"PRIESTLEY_1972":{"label":"PRIESTLEY_1972","enumerator":"14","doi":"10.1175/1520-0493(1972)100<0081:otaosh>2.3.co;2","html":"PRIESTLEY, C. H. B., & TAYLOR, R. J. (1972). On the Assessment of Surface Heat Flux and Evaporation Using Large-Scale Parameters. <i>Monthly Weather Review</i>, <i>100</i>(2), 81–92. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1175/1520-0493(1972)100&lt\">https://doi.org/10.1175/1520-0493(1972)100&lt</a>;0081:otaosh&gt;2.3.co;2","url":"https://doi.org/10.1175/1520-0493(1972)100&lt"}}}}}